const xl=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}};xl();function Q(){return function(){throw new Error("Unimplemented abstract method.")}()}var Rl=0;function At(r){return r.ol_uid||(r.ol_uid=String(++Rl))}var wl="6.15.1",Cl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Al=function(r){Cl(e,r);function e(t){var n=this,i="v"+wl.split("-")[0],a="Assertion failed. See https://openlayers.org/en/"+i+"/doc/errors/#"+t+" for details.";return n=r.call(this,a)||this,n.code=t,n.name="AssertionError",n.message=a,n}return e}(Error);const ts=Al;var Ol=function(){function r(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return r.prototype.preventDefault=function(){this.defaultPrevented=!0},r.prototype.stopPropagation=function(){this.propagationStopped=!0},r}();const Me=Ol,Pr={PROPERTYCHANGE:"propertychange"};var Sl=function(){function r(){this.disposed=!1}return r.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},r.prototype.disposeInternal=function(){},r}();const Fn=Sl;function zi(r,e){return r>e?1:r<e?-1:0}function ki(r,e,t){var n=r.length;if(r[0]<=e)return 0;if(e<=r[n-1])return n-1;var i=void 0;if(t>0){for(i=1;i<n;++i)if(r[i]<e)return i-1}else if(t<0){for(i=1;i<n;++i)if(r[i]<=e)return i}else for(i=1;i<n;++i){if(r[i]==e)return i;if(r[i]<e)return typeof t=="function"?t(e,r[i-1],r[i])>0?i-1:i:r[i-1]-e<e-r[i]?i-1:i}return n-1}function Pl(r,e){for(var t=Array.isArray(e)?e:[e],n=t.length,i=0;i<n;i++)r[r.length]=t[i]}function es(r,e){var t=r.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}function Il(r,e,t){var n=e||zi;return r.every(function(i,a){if(a===0)return!0;var o=n(r[a-1],i);return!(o>0||t&&o===0)})}function wr(){return!0}function Un(){return!1}function Ir(){}function bl(r){var e=!1,t,n,i;return function(){var a=Array.prototype.slice.call(arguments);return(!e||this!==i||!es(a,n))&&(e=!0,i=this,n=a,t=r.apply(this,arguments)),t}}function Ll(r){function e(){var t;try{t=r()}catch(n){return Promise.reject(n)}return t instanceof Promise?t:Promise.resolve(t)}return e()}var ut=typeof Object.assign=="function"?Object.assign:function(r,e){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(r),n=1,i=arguments.length;n<i;++n){var a=arguments[n];if(a!=null)for(var o in a)a.hasOwnProperty(o)&&(t[o]=a[o])}return t};function Br(r){for(var e in r)delete r[e]}var Nl=typeof Object.values=="function"?Object.values:function(r){var e=[];for(var t in r)e.push(r[t]);return e};function Dl(r){var e;for(e in r)return!1;return!e}var Gl=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fl=function(r){Gl(e,r);function e(t){var n=r.call(this)||this;return n.eventTarget_=t,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return e.prototype.addEventListener=function(t,n){if(!(!t||!n)){var i=this.listeners_||(this.listeners_={}),a=i[t]||(i[t]=[]);a.indexOf(n)===-1&&a.push(n)}},e.prototype.dispatchEvent=function(t){var n=typeof t=="string",i=n?t:t.type,a=this.listeners_&&this.listeners_[i];if(!!a){var o=n?new Me(t):t;o.target||(o.target=this.eventTarget_||this);var s=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});i in s||(s[i]=0,h[i]=0),++s[i];for(var l,u=0,c=a.length;u<c;++u)if("handleEvent"in a[u]?l=a[u].handleEvent(o):l=a[u].call(this,o),l===!1||o.propagationStopped){l=!1;break}if(--s[i]===0){var f=h[i];for(delete h[i];f--;)this.removeEventListener(i,Ir);delete s[i]}return l}},e.prototype.disposeInternal=function(){this.listeners_&&Br(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,n){var i=this.listeners_&&this.listeners_[t];if(i){var a=i.indexOf(n);a!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[a]=Ir,++this.pendingRemovals_[t]):(i.splice(a,1),i.length===0&&delete this.listeners_[t]))}},e}(Fn);const ur=Fl,G={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function K(r,e,t,n,i){if(n&&n!==r&&(t=t.bind(n)),i){var a=t;t=function(){r.removeEventListener(e,t),a.apply(this,arguments)}}var o={target:r,type:e,listener:t};return r.addEventListener(e,t),o}function Mn(r,e,t,n){return K(r,e,t,n,!0)}function at(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),Br(r))}var Ul=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bn=function(r){Ul(e,r);function e(){var t=r.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(G.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,n){if(Array.isArray(t)){for(var i=t.length,a=new Array(i),o=0;o<i;++o)a[o]=K(this,t[o],n);return a}else return K(this,t,n)},e.prototype.onceInternal=function(t,n){var i;if(Array.isArray(t)){var a=t.length;i=new Array(a);for(var o=0;o<a;++o)i[o]=Mn(this,t[o],n)}else i=Mn(this,t,n);return n.ol_key=i,i},e.prototype.unInternal=function(t,n){var i=n.ol_key;if(i)Bl(i);else if(Array.isArray(t))for(var a=0,o=t.length;a<o;++a)this.removeEventListener(t[a],n);else this.removeEventListener(t,n)},e}(ur);Bn.prototype.on;Bn.prototype.once;Bn.prototype.un;function Bl(r){if(Array.isArray(r))for(var e=0,t=r.length;e<t;++e)at(r[e]);else at(r)}const rs=Bn;var ns=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ba=function(r){ns(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.key=n,a.oldValue=i,a}return e}(Me),jl=function(r){ns(e,r);function e(t){var n=r.call(this)||this;return n.on,n.once,n.un,At(n),n.values_=null,t!==void 0&&n.setProperties(t),n}return e.prototype.get=function(t){var n;return this.values_&&this.values_.hasOwnProperty(t)&&(n=this.values_[t]),n},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&ut({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,n){var i;i="change:".concat(t),this.hasListener(i)&&this.dispatchEvent(new Ba(i,t,n)),i=Pr.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Ba(i,t,n))},e.prototype.addChangeListener=function(t,n){this.addEventListener("change:".concat(t),n)},e.prototype.removeChangeListener=function(t,n){this.removeEventListener("change:".concat(t),n)},e.prototype.set=function(t,n,i){var a=this.values_||(this.values_={});if(i)a[t]=n;else{var o=a[t];a[t]=n,o!==n&&this.notify(t,o)}},e.prototype.setProperties=function(t,n){for(var i in t)this.set(i,t[i],n)},e.prototype.applyProperties=function(t){!t.values_||ut(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,n){if(this.values_&&t in this.values_){var i=this.values_[t];delete this.values_[t],Dl(this.values_)&&(this.values_=null),n||this.notify(t,i)}},e}(rs);const ue=jl,Ut={ADD:"add",REMOVE:"remove"};var is=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ja={LENGTH:"length"},Jr=function(r){is(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.element=n,a.index=i,a}return e}(Me),Xl=function(r){is(e,r);function e(t,n){var i=r.call(this)||this;i.on,i.once,i.un;var a=n||{};if(i.unique_=!!a.unique,i.array_=t||[],i.unique_)for(var o=0,s=i.array_.length;o<s;++o)i.assertUnique_(i.array_[o],o);return i.updateLength_(),i}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var n=0,i=t.length;n<i;++n)this.push(t[n]);return this},e.prototype.forEach=function(t){for(var n=this.array_,i=0,a=n.length;i<a;++i)t(n[i],i,n)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(ja.LENGTH)},e.prototype.insertAt=function(t,n){this.unique_&&this.assertUnique_(n),this.array_.splice(t,0,n),this.updateLength_(),this.dispatchEvent(new Jr(Ut.ADD,n,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var n=this.getLength();return this.insertAt(n,t),this.getLength()},e.prototype.remove=function(t){for(var n=this.array_,i=0,a=n.length;i<a;++i)if(n[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var n=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Jr(Ut.REMOVE,n,t)),n},e.prototype.setAt=function(t,n){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(n,t);var a=this.array_[t];this.array_[t]=n,this.dispatchEvent(new Jr(Ut.REMOVE,a,t)),this.dispatchEvent(new Jr(Ut.ADD,n,t))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,n)}},e.prototype.updateLength_=function(){this.set(ja.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,n){for(var i=0,a=this.array_.length;i<a;++i)if(this.array_[i]===t&&i!==n)throw new ts(58)},e}(ue);const $t=Xl;function H(r,e){if(!r)throw new ts(e)}const Lt={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var zt={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},zl={9001:zt.METERS,9002:zt.FEET,9003:zt.USFEET,9101:zt.RADIANS,9102:zt.DEGREES};function Xa(r){return zl[r]}var Jt={};Jt[zt.RADIANS]=6370997/(2*Math.PI);Jt[zt.DEGREES]=2*Math.PI*6370997/360;Jt[zt.FEET]=.3048;Jt[zt.METERS]=1;Jt[zt.USFEET]=1200/3937;const le=zt;var me=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",kl=me.indexOf("firefox")!==-1,$l=me.indexOf("safari")!==-1&&me.indexOf("chrom")==-1,Kl=$l&&!!(me.indexOf("version/15.4")>=0||me.match(/cpu (os|iphone os) 15_4 like mac os x/)),ql=me.indexOf("webkit")!==-1&&me.indexOf("edge")==-1,Vl=me.indexOf("macintosh")!==-1,as=typeof devicePixelRatio<"u"?devicePixelRatio:1,Hl=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Zl=typeof Image<"u"&&Image.prototype.decode,os=function(){var r=!1;try{var e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return r}(),$i=new Array(6);function Ie(){return[1,0,0,1,0,0]}function fn(r){return jn(r,1,0,0,1,0,0)}function Ki(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],h=e[0],l=e[1],u=e[2],c=e[3],f=e[4],v=e[5];return r[0]=t*h+i*l,r[1]=n*h+a*l,r[2]=t*u+i*c,r[3]=n*u+a*c,r[4]=t*f+i*v+o,r[5]=n*f+a*v+s,r}function jn(r,e,t,n,i,a,o){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=o,r}function br(r,e){var t=e[0],n=e[1];return e[0]=r[0]*t+r[2]*n+r[4],e[1]=r[1]*t+r[3]*n+r[5],e}function ss(r,e){var t=Math.cos(e),n=Math.sin(e);return Ki(r,jn($i,t,n,-n,t,0,0))}function Ti(r,e,t){return Ki(r,jn($i,e,0,0,t,0,0))}function Yl(r,e,t){return Ki(r,jn($i,1,0,0,1,e,t))}function Xn(r,e,t,n,i,a,o,s){var h=Math.sin(a),l=Math.cos(a);return r[0]=n*l,r[1]=i*h,r[2]=-n*h,r[3]=i*l,r[4]=o*n*l-s*n*h+e,r[5]=o*i*h+s*i*l+t,r}function Wl(r,e){var t=Ql(e);H(t!==0,32);var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],h=e[5];return r[0]=o/t,r[1]=-i/t,r[2]=-a/t,r[3]=n/t,r[4]=(a*h-o*s)/t,r[5]=-(n*h-i*s)/t,r}function Ql(r){return r[0]*r[3]-r[1]*r[2]}const gt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Mi(r){for(var e=cr(),t=0,n=r.length;t<n;++t)vn(e,r[t]);return e}function Jl(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r.slice()}function hs(r,e,t){var n,i;return e<r[0]?n=r[0]-e:r[2]<e?n=e-r[2]:n=0,t<r[1]?i=r[1]-t:r[3]<t?i=t-r[3]:i=0,n*n+i*i}function Lr(r,e){return ls(r,e[0],e[1])}function tu(r,e){return r[0]<=e[0]&&e[2]<=r[2]&&r[1]<=e[1]&&e[3]<=r[3]}function ls(r,e,t){return r[0]<=e&&e<=r[2]&&r[1]<=t&&t<=r[3]}function za(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],o=e[0],s=e[1],h=gt.UNKNOWN;return o<t?h=h|gt.LEFT:o>i&&(h=h|gt.RIGHT),s<n?h=h|gt.BELOW:s>a&&(h=h|gt.ABOVE),h===gt.UNKNOWN&&(h=gt.INTERSECTING),h}function cr(){return[1/0,1/0,-1/0,-1/0]}function nr(r,e,t,n,i){return i?(i[0]=r,i[1]=e,i[2]=t,i[3]=n,i):[r,e,t,n]}function zn(r){return nr(1/0,1/0,-1/0,-1/0,r)}function eu(r,e){var t=r[0],n=r[1];return nr(t,n,t,n,e)}function ru(r,e,t,n,i){var a=zn(i);return us(a,r,e,t,n)}function ka(r,e){return r[0]==e[0]&&r[2]==e[2]&&r[1]==e[1]&&r[3]==e[3]}function nu(r,e){return e[0]<r[0]&&(r[0]=e[0]),e[2]>r[2]&&(r[2]=e[2]),e[1]<r[1]&&(r[1]=e[1]),e[3]>r[3]&&(r[3]=e[3]),r}function vn(r,e){e[0]<r[0]&&(r[0]=e[0]),e[0]>r[2]&&(r[2]=e[0]),e[1]<r[1]&&(r[1]=e[1]),e[1]>r[3]&&(r[3]=e[1])}function us(r,e,t,n,i){for(;t<n;t+=i)iu(r,e[t],e[t+1]);return r}function iu(r,e,t){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}function cs(r,e){var t;return t=e(qi(r)),t||(t=e(Vi(r)),t)||(t=e(Hi(r)),t)||(t=e(jr(r)),t)?t:!1}function xi(r){var e=0;return kn(r)||(e=lt(r)*qt(r)),e}function qi(r){return[r[0],r[1]]}function Vi(r){return[r[2],r[1]]}function ir(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function au(r,e){var t;return e==="bottom-left"?t=qi(r):e==="bottom-right"?t=Vi(r):e==="top-left"?t=jr(r):e==="top-right"?t=Hi(r):H(!1,13),t}function Ri(r,e,t,n,i){var a=ou(r,e,t,n),o=a[0],s=a[1],h=a[2],l=a[3],u=a[4],c=a[5],f=a[6],v=a[7];return nr(Math.min(o,h,u,f),Math.min(s,l,c,v),Math.max(o,h,u,f),Math.max(s,l,c,v),i)}function ou(r,e,t,n){var i=e*n[0]/2,a=e*n[1]/2,o=Math.cos(t),s=Math.sin(t),h=i*o,l=i*s,u=a*o,c=a*s,f=r[0],v=r[1];return[f-h+c,v-l-u,f-h-c,v-l+u,f+h-c,v+l+u,f+h+c,v+l-u,f-h+c,v-l-u]}function qt(r){return r[3]-r[1]}function _e(r,e,t){var n=t||cr();return Zi(r,e)?(r[0]>e[0]?n[0]=r[0]:n[0]=e[0],r[1]>e[1]?n[1]=r[1]:n[1]=e[1],r[2]<e[2]?n[2]=r[2]:n[2]=e[2],r[3]<e[3]?n[3]=r[3]:n[3]=e[3]):zn(n),n}function jr(r){return[r[0],r[3]]}function Hi(r){return[r[2],r[3]]}function lt(r){return r[2]-r[0]}function Zi(r,e){return r[0]<=e[2]&&r[2]>=e[0]&&r[1]<=e[3]&&r[3]>=e[1]}function kn(r){return r[2]<r[0]||r[3]<r[1]}function su(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r}function hu(r,e,t){var n=!1,i=za(r,e),a=za(r,t);if(i===gt.INTERSECTING||a===gt.INTERSECTING)n=!0;else{var o=r[0],s=r[1],h=r[2],l=r[3],u=e[0],c=e[1],f=t[0],v=t[1],d=(v-c)/(f-u),p=void 0,g=void 0;!!(a&gt.ABOVE)&&!(i&gt.ABOVE)&&(p=f-(v-l)/d,n=p>=o&&p<=h),!n&&!!(a&gt.RIGHT)&&!(i&gt.RIGHT)&&(g=v-(f-h)*d,n=g>=s&&g<=l),!n&&!!(a&gt.BELOW)&&!(i&gt.BELOW)&&(p=f-(v-s)/d,n=p>=o&&p<=h),!n&&!!(a&gt.LEFT)&&!(i&gt.LEFT)&&(g=v-(f-o)*d,n=g>=s&&g<=l)}return n}var lu=function(){function r(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return r.prototype.canWrapX=function(){return this.canWrapX_},r.prototype.getCode=function(){return this.code_},r.prototype.getExtent=function(){return this.extent_},r.prototype.getUnits=function(){return this.units_},r.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Jt[this.units_]},r.prototype.getWorldExtent=function(){return this.worldExtent_},r.prototype.getAxisOrientation=function(){return this.axisOrientation_},r.prototype.isGlobal=function(){return this.global_},r.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},r.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},r.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},r.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},r.prototype.setWorldExtent=function(e){this.worldExtent_=e},r.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},r.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},r}();const Nr=lu;function ot(r,e,t){return Math.min(Math.max(r,e),t)}var uu=function(){var r;return"cosh"in Math?r=Math.cosh:r=function(e){var t=Math.exp(e);return(t+1/t)/2},r}(),fs=function(){var r;return"log2"in Math?r=Math.log2:r=function(e){return Math.log(e)*Math.LOG2E},r}();function cu(r,e,t,n,i,a){var o=i-t,s=a-n;if(o!==0||s!==0){var h=((r-t)*o+(e-n)*s)/(o*o+s*s);h>1?(t=i,n=a):h>0&&(t+=o*h,n+=s*h)}return Ye(r,e,t,n)}function Ye(r,e,t,n){var i=t-r,a=n-e;return i*i+a*a}function fu(r){for(var e=r.length,t=0;t<e;t++){for(var n=t,i=Math.abs(r[t][t]),a=t+1;a<e;a++){var o=Math.abs(r[a][t]);o>i&&(i=o,n=a)}if(i===0)return null;var s=r[n];r[n]=r[t],r[t]=s;for(var h=t+1;h<e;h++)for(var l=-r[h][t]/r[t][t],u=t;u<e+1;u++)t==u?r[h][u]=0:r[h][u]+=l*r[t][u]}for(var c=new Array(e),f=e-1;f>=0;f--){c[f]=r[f][e]/r[f][f];for(var v=f-1;v>=0;v--)r[v][e]-=r[v][f]*c[f]}return c}function dn(r){return r*Math.PI/180}function We(r,e){var t=r%e;return t*e<0?t+e:t}function vu(r,e,t){return r+t*(e-r)}function vs(r,e){var t=Math.pow(10,e);return Math.round(r*t)/t}function tn(r,e){return Math.floor(vs(r,e))}function en(r,e){return Math.ceil(vs(r,e))}var du=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xr=6378137,$e=Math.PI*Xr,pu=[-$e,-$e,$e,$e],gu=[-180,-85,180,85],rn=Xr*Math.log(Math.tan(Math.PI/2)),De=function(r){du(e,r);function e(t){return r.call(this,{code:t,units:le.METERS,extent:pu,global:!0,worldExtent:gu,getPointResolution:function(n,i){return n/uu(i[1]/Xr)}})||this}return e}(Nr),$a=[new De("EPSG:3857"),new De("EPSG:102100"),new De("EPSG:102113"),new De("EPSG:900913"),new De("http://www.opengis.net/def/crs/EPSG/0/3857"),new De("http://www.opengis.net/gml/srs/epsg.xml#3857")];function _u(r,e,t){var n=r.length,i=t>1?t:2,a=e;a===void 0&&(i>2?a=r.slice():a=new Array(n));for(var o=0;o<n;o+=i){a[o]=$e*r[o]/180;var s=Xr*Math.log(Math.tan(Math.PI*(+r[o+1]+90)/360));s>rn?s=rn:s<-rn&&(s=-rn),a[o+1]=s}return a}function yu(r,e,t){var n=r.length,i=t>1?t:2,a=e;a===void 0&&(i>2?a=r.slice():a=new Array(n));for(var o=0;o<n;o+=i)a[o]=180*r[o]/$e,a[o+1]=360*Math.atan(Math.exp(r[o+1]/Xr))/Math.PI-90;return a}var mu=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Eu=6378137,Ka=[-180,-90,180,90],Tu=Math.PI*Eu/180,Ce=function(r){mu(e,r);function e(t,n){return r.call(this,{code:t,units:le.DEGREES,extent:Ka,axisOrientation:n,global:!0,metersPerUnit:Tu,worldExtent:Ka})||this}return e}(Nr),qa=[new Ce("CRS:84"),new Ce("EPSG:4326","neu"),new Ce("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ce("urn:ogc:def:crs:OGC:2:84"),new Ce("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ce("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ce("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],wi={};function Mu(r){return wi[r]||wi[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function xu(r,e){wi[r]=e}var Qe={};function ar(r,e,t){var n=r.getCode(),i=e.getCode();n in Qe||(Qe[n]={}),Qe[n][i]=t}function ds(r,e){var t;return r in Qe&&e in Qe[r]&&(t=Qe[r][e]),t}function Ru(r,e){return r[0]+=+e[0],r[1]+=+e[1],r}function xn(r,e){for(var t=!0,n=r.length-1;n>=0;--n)if(r[n]!=e[n]){t=!1;break}return t}function Yi(r,e){var t=Math.cos(e),n=Math.sin(e),i=r[0]*t-r[1]*n,a=r[1]*t+r[0]*n;return r[0]=i,r[1]=a,r}function wu(r,e){return r[0]*=e,r[1]*=e,r}function Cu(r,e){if(e.canWrapX()){var t=lt(e.getExtent()),n=ps(r,e,t);n&&(r[0]-=n*t)}return r}function ps(r,e,t){var n=e.getExtent(),i=0;if(e.canWrapX()&&(r[0]<n[0]||r[0]>n[2])){var a=t||lt(n);i=Math.floor((r[0]-n[0])/a)}return i}var Au=63710088e-1;function Va(r,e,t){var n=t||Au,i=dn(r[1]),a=dn(e[1]),o=(a-i)/2,s=dn(e[0]-r[0])/2,h=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(a);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}var Ci=!0;function gs(r){var e=r===void 0?!0:r;Ci=!e}function Wi(r,e,t){var n;if(e!==void 0){for(var i=0,a=r.length;i<a;++i)e[i]=r[i];n=e}else n=r.slice();return n}function _s(r,e,t){if(e!==void 0&&r!==e){for(var n=0,i=r.length;n<i;++n)e[n]=r[n];r=e}return r}function ys(r){xu(r.getCode(),r),ar(r,r,Wi)}function Ou(r){r.forEach(ys)}function ct(r){return typeof r=="string"?Mu(r):r||null}function Ha(r,e,t,n){r=ct(r);var i,a=r.getPointResolutionFunc();if(a){if(i=a(e,t),n&&n!==r.getUnits()){var o=r.getMetersPerUnit();o&&(i=i*o/Jt[n])}}else{var s=r.getUnits();if(s==le.DEGREES&&!n||n==le.DEGREES)i=e;else{var h=Ji(r,ct("EPSG:4326"));if(h===_s&&s!==le.DEGREES)i=e*r.getMetersPerUnit();else{var l=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];l=h(l,l,2);var u=Va(l.slice(0,2),l.slice(2,4)),c=Va(l.slice(4,6),l.slice(6,8));i=(u+c)/2}var o=n?Jt[n]:r.getMetersPerUnit();o!==void 0&&(i/=o)}}return i}function Ai(r){Ou(r),r.forEach(function(e){r.forEach(function(t){e!==t&&ar(e,t,Wi)})})}function Su(r,e,t,n){r.forEach(function(i){e.forEach(function(a){ar(i,a,t),ar(a,i,n)})})}function Qi(r,e){return r?typeof r=="string"?ct(r):r:ct(e)}function Za(r){return function(e,t,n){for(var i=e.length,a=n!==void 0?n:2,o=t!==void 0?t:new Array(i),s=0;s<i;s+=a)for(var h=r(e.slice(s,s+a)),l=h.length,u=0,c=a;u<c;++u)o[s+u]=u>=l?e[s+u]:h[u];return o}}function Pu(r,e,t,n){var i=ct(r),a=ct(e);ar(i,a,Za(t)),ar(a,i,Za(n))}function Iu(r,e){return gs(),ms(r,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function je(r,e){if(r===e)return!0;var t=r.getUnits()===e.getUnits();if(r.getCode()===e.getCode())return t;var n=Ji(r,e);return n===Wi&&t}function Ji(r,e){var t=r.getCode(),n=e.getCode(),i=ds(t,n);return i||(i=_s),i}function Rn(r,e){var t=ct(r),n=ct(e);return Ji(t,n)}function ms(r,e,t){var n=Rn(e,t);return n(r,void 0,r.length)}var bu=null;function Lu(){return bu}function wn(r,e){return r}function oe(r,e){return Ci&&!xn(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(Ci=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r}function Es(r,e){return r}function Ke(r,e){return r}function Ya(r,e,t){return function(n){var i,a;if(r.canWrapX()){var o=r.getExtent(),s=lt(o);n=n.slice(0),a=ps(n,r,s),a&&(n[0]=n[0]-a*s),n[0]=ot(n[0],o[0],o[2]),n[1]=ot(n[1],o[1],o[3]),i=t(n)}else i=t(n);return a&&e.canWrapX()&&(i[0]+=a*lt(e.getExtent())),i}}function Nu(){Ai($a),Ai(qa),Su(qa,$a,_u,yu)}Nu();function Du(r,e,t,n,i,a){for(var o=a||[],s=0,h=e;h<t;h+=n){var l=r[h],u=r[h+1];o[s++]=i[0]*l+i[2]*u+i[4],o[s++]=i[1]*l+i[3]*u+i[5]}return a&&o.length!=s&&(o.length=s),o}function Gu(r,e,t,n,i,a,o){for(var s=o||[],h=Math.cos(i),l=Math.sin(i),u=a[0],c=a[1],f=0,v=e;v<t;v+=n){var d=r[v]-u,p=r[v+1]-c;s[f++]=u+d*h-p*l,s[f++]=c+d*l+p*h;for(var g=v+2;g<v+n;++g)s[f++]=r[g]}return o&&s.length!=f&&(s.length=f),s}function Fu(r,e,t,n,i,a,o,s){for(var h=s||[],l=o[0],u=o[1],c=0,f=e;f<t;f+=n){var v=r[f]-l,d=r[f+1]-u;h[c++]=l+i*v,h[c++]=u+a*d;for(var p=f+2;p<f+n;++p)h[c++]=r[p]}return s&&h.length!=c&&(h.length=c),h}function Uu(r,e,t,n,i,a,o){for(var s=o||[],h=0,l=e;l<t;l+=n){s[h++]=r[l]+i,s[h++]=r[l+1]+a;for(var u=l+2;u<l+n;++u)s[h++]=r[u]}return o&&s.length!=h&&(s.length=h),s}var Bu=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Wa=Ie(),ju=function(r){Bu(e,r);function e(){var t=r.call(this)||this;return t.extent_=cr(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=bl(function(n,i,a){if(!a)return this.getSimplifiedGeometry(i);var o=this.clone();return o.applyTransform(a),o.getSimplifiedGeometry(i)}),t}return e.prototype.simplifyTransformed=function(t,n){return this.simplifyTransformedInternal(this.getRevision(),t,n)},e.prototype.clone=function(){return Q()},e.prototype.closestPointXY=function(t,n,i,a){return Q()},e.prototype.containsXY=function(t,n){var i=this.getClosestPoint([t,n]);return i[0]===t&&i[1]===n},e.prototype.getClosestPoint=function(t,n){var i=n||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Q()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&zn(n),this.extentRevision_=this.getRevision()}return su(this.extent_,t)},e.prototype.rotate=function(t,n){Q()},e.prototype.scale=function(t,n,i){Q()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Q()},e.prototype.getType=function(){return Q()},e.prototype.applyTransform=function(t){Q()},e.prototype.intersectsExtent=function(t){return Q()},e.prototype.translate=function(t,n){Q()},e.prototype.transform=function(t,n){var i=ct(t),a=i.getUnits()==le.TILE_PIXELS?function(o,s,h){var l=i.getExtent(),u=i.getWorldExtent(),c=qt(u)/qt(l);return Xn(Wa,u[0],u[3],c,-c,0,0,0),Du(o,0,o.length,h,Wa,s),Rn(i,n)(o,s,h)}:Rn(i,n);return this.applyTransform(a),this},e}(ue);const Xu=ju;var zu=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ku=function(r){zu(e,r);function e(){var t=r.call(this)||this;return t.layout=Lt.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return ru(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Q()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var n=this.getSimplifiedGeometryInternal(t),i=n.getFlatCoordinates();return i.length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,n){this.stride=Qa(t),this.layout=t,this.flatCoordinates=n},e.prototype.setCoordinates=function(t,n){Q()},e.prototype.setLayout=function(t,n,i){var a;if(t)a=Qa(t);else{for(var o=0;o<i;++o)if(n.length===0){this.layout=Lt.XY,this.stride=2;return}else n=n[0];a=n.length,t=$u(a)}this.layout=t,this.stride=a},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,n){var i=this.getFlatCoordinates();if(i){var a=this.getStride();Gu(i,0,i.length,a,t,n,i),this.changed()}},e.prototype.scale=function(t,n,i){var a=n;a===void 0&&(a=t);var o=i;o||(o=ir(this.getExtent()));var s=this.getFlatCoordinates();if(s){var h=this.getStride();Fu(s,0,s.length,h,t,a,o,s),this.changed()}},e.prototype.translate=function(t,n){var i=this.getFlatCoordinates();if(i){var a=this.getStride();Uu(i,0,i.length,a,t,n,i),this.changed()}},e}(Xu);function $u(r){var e;return r==2?e=Lt.XY:r==3?e=Lt.XYZ:r==4&&(e=Lt.XYZM),e}function Qa(r){var e;return r==Lt.XY?e=2:r==Lt.XYZ||r==Lt.XYM?e=3:r==Lt.XYZM&&(e=4),e}const ta=ku;function Ja(r,e,t,n,i,a,o){var s=r[e],h=r[e+1],l=r[t]-s,u=r[t+1]-h,c;if(l===0&&u===0)c=e;else{var f=((i-s)*l+(a-h)*u)/(l*l+u*u);if(f>1)c=t;else if(f>0){for(var v=0;v<n;++v)o[v]=vu(r[e+v],r[t+v],f);o.length=n;return}else c=e}for(var v=0;v<n;++v)o[v]=r[c+v];o.length=n}function Ts(r,e,t,n,i){var a=r[e],o=r[e+1];for(e+=n;e<t;e+=n){var s=r[e],h=r[e+1],l=Ye(a,o,s,h);l>i&&(i=l),a=s,o=h}return i}function Ku(r,e,t,n,i){for(var a=0,o=t.length;a<o;++a){var s=t[a];i=Ts(r,e,s,n,i),e=s}return i}function Ms(r,e,t,n,i,a,o,s,h,l,u){if(e==t)return l;var c,f;if(i===0)if(f=Ye(o,s,r[e],r[e+1]),f<l){for(c=0;c<n;++c)h[c]=r[e+c];return h.length=n,f}else return l;for(var v=u||[NaN,NaN],d=e+n;d<t;)if(Ja(r,d-n,d,n,o,s,v),f=Ye(o,s,v[0],v[1]),f<l){for(l=f,c=0;c<n;++c)h[c]=v[c];h.length=n,d+=n}else d+=n*Math.max((Math.sqrt(f)-Math.sqrt(l))/i|0,1);if(a&&(Ja(r,t-n,e,n,o,s,v),f=Ye(o,s,v[0],v[1]),f<l)){for(l=f,c=0;c<n;++c)h[c]=v[c];h.length=n}return l}function qu(r,e,t,n,i,a,o,s,h,l,u){for(var c=u||[NaN,NaN],f=0,v=t.length;f<v;++f){var d=t[f];l=Ms(r,e,d,n,i,a,o,s,h,l,c),e=d}return l}function Vu(r,e,t,n){for(var i=0,a=t.length;i<a;++i)r[e++]=t[i];return e}function xs(r,e,t,n){for(var i=0,a=t.length;i<a;++i)for(var o=t[i],s=0;s<n;++s)r[e++]=o[s];return e}function Hu(r,e,t,n,i){for(var a=i||[],o=0,s=0,h=t.length;s<h;++s){var l=xs(r,e,t[s],n);a[o++]=l,e=l}return a.length=o,a}function Zu(r,e,t,n,i,a,o){var s=(t-e)/n;if(s<3){for(;e<t;e+=n)a[o++]=r[e],a[o++]=r[e+1];return o}var h=new Array(s);h[0]=1,h[s-1]=1;for(var l=[e,t-n],u=0;l.length>0;){for(var c=l.pop(),f=l.pop(),v=0,d=r[f],p=r[f+1],g=r[c],y=r[c+1],_=f+n;_<c;_+=n){var m=r[_],E=r[_+1],T=cu(m,E,d,p,g,y);T>v&&(u=_,v=T)}v>i&&(h[(u-e)/n]=1,f+n<u&&l.push(f,u),u+n<c&&l.push(u,c))}for(var _=0;_<s;++_)h[_]&&(a[o++]=r[e+_*n],a[o++]=r[e+_*n+1]);return o}function Ge(r,e){return e*Math.round(r/e)}function Yu(r,e,t,n,i,a,o){if(e==t)return o;var s=Ge(r[e],i),h=Ge(r[e+1],i);e+=n,a[o++]=s,a[o++]=h;var l,u;do if(l=Ge(r[e],i),u=Ge(r[e+1],i),e+=n,e==t)return a[o++]=l,a[o++]=u,o;while(l==s&&u==h);for(;e<t;){var c=Ge(r[e],i),f=Ge(r[e+1],i);if(e+=n,!(c==l&&f==u)){var v=l-s,d=u-h,p=c-s,g=f-h;if(v*g==d*p&&(v<0&&p<v||v==p||v>0&&p>v)&&(d<0&&g<d||d==g||d>0&&g>d)){l=c,u=f;continue}a[o++]=l,a[o++]=u,s=l,h=u,l=c,u=f}}return a[o++]=l,a[o++]=u,o}function Wu(r,e,t,n,i,a,o,s){for(var h=0,l=t.length;h<l;++h){var u=t[h];o=Yu(r,e,u,n,i,a,o),s.push(o),e=u}return o}function Rs(r,e,t,n,i){for(var a=i!==void 0?i:[],o=0,s=e;s<t;s+=n)a[o++]=r.slice(s,s+n);return a.length=o,a}function Qu(r,e,t,n,i){for(var a=i!==void 0?i:[],o=0,s=0,h=t.length;s<h;++s){var l=t[s];a[o++]=Rs(r,e,l,n,a[o]),e=l}return a.length=o,a}function ws(r,e,t,n){for(var i=0,a=r[t-n],o=r[t-n+1];e<t;e+=n){var s=r[e],h=r[e+1];i+=o*s-a*h,a=s,o=h}return i/2}function Ju(r,e,t,n){for(var i=0,a=0,o=t.length;a<o;++a){var s=t[a];i+=ws(r,e,s,n),e=s}return i}var tc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ec=function(r){tc(e,r);function e(t,n){var i=r.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?i.setFlatCoordinates(n,t):i.setCoordinates(t,n),i}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,n,i,a){return a<hs(this.getExtent(),t,n)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ts(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ms(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,n,i,a))},e.prototype.getArea=function(){return ws(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Rs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=Zu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,Lt.XY)},e.prototype.getType=function(){return"LinearRing"},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xs(this.flatCoordinates,0,t,this.stride),this.changed()},e}(ta);const to=ec;var rc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),nc=function(r){rc(e,r);function e(t,n){var i=r.call(this)||this;return i.setCoordinates(t,n),i}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){var o=this.flatCoordinates,s=Ye(t,n,o[0],o[1]);if(s<a){for(var h=this.stride,l=0;l<h;++l)i[l]=o[l];return i.length=h,s}else return a},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return eu(this.flatCoordinates,t)},e.prototype.getType=function(){return"Point"},e.prototype.intersectsExtent=function(t){return ls(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(ta);const ic=nc;function ac(r,e,t,n,i){var a=cs(i,function(o){return!Se(r,e,t,n,o[0],o[1])});return!a}function Se(r,e,t,n,i,a){for(var o=0,s=r[t-n],h=r[t-n+1];e<t;e+=n){var l=r[e],u=r[e+1];h<=a?u>a&&(l-s)*(a-h)-(i-s)*(u-h)>0&&o++:u<=a&&(l-s)*(a-h)-(i-s)*(u-h)<0&&o--,s=l,h=u}return o!==0}function Cs(r,e,t,n,i,a){if(t.length===0||!Se(r,e,t[0],n,i,a))return!1;for(var o=1,s=t.length;o<s;++o)if(Se(r,t[o-1],t[o],n,i,a))return!1;return!0}function oc(r,e,t,n,i,a,o){for(var s,h,l,u,c,f,v,d=i[a+1],p=[],g=0,y=t.length;g<y;++g){var _=t[g];for(u=r[_-n],f=r[_-n+1],s=e;s<_;s+=n)c=r[s],v=r[s+1],(d<=f&&v<=d||f<=d&&d<=v)&&(l=(d-f)/(v-f)*(c-u)+u,p.push(l)),u=c,f=v}var m=NaN,E=-1/0;for(p.sort(zi),u=p[0],s=1,h=p.length;s<h;++s){c=p[s];var T=Math.abs(c-u);T>E&&(l=(u+c)/2,Cs(r,e,t,n,l,d)&&(m=l,E=T)),u=c}return isNaN(m)&&(m=i[a]),o?(o.push(m,d,E),o):[m,d,E]}function sc(r,e,t,n,i){var a;for(e+=n;e<t;e+=n)if(a=i(r.slice(e-n,e),r.slice(e,e+n)),a)return a;return!1}function As(r,e,t,n,i){var a=us(cr(),r,e,t,n);return Zi(i,a)?tu(i,a)||a[0]>=i[0]&&a[2]<=i[2]||a[1]>=i[1]&&a[3]<=i[3]?!0:sc(r,e,t,n,function(o,s){return hu(i,o,s)}):!1}function Os(r,e,t,n,i){return!!(As(r,e,t,n,i)||Se(r,e,t,n,i[0],i[1])||Se(r,e,t,n,i[0],i[3])||Se(r,e,t,n,i[2],i[1])||Se(r,e,t,n,i[2],i[3]))}function hc(r,e,t,n,i){if(!Os(r,e,t[0],n,i))return!1;if(t.length===1)return!0;for(var a=1,o=t.length;a<o;++a)if(ac(r,t[a-1],t[a],n,i)&&!As(r,t[a-1],t[a],n,i))return!1;return!0}function lc(r,e,t,n){for(;e<t-n;){for(var i=0;i<n;++i){var a=r[e+i];r[e+i]=r[t-n+i],r[t-n+i]=a}e+=n,t-=n}}function Ss(r,e,t,n){for(var i=0,a=r[t-n],o=r[t-n+1];e<t;e+=n){var s=r[e],h=r[e+1];i+=(s-a)*(h+o),a=s,o=h}return i===0?void 0:i>0}function uc(r,e,t,n,i){for(var a=i!==void 0?i:!1,o=0,s=t.length;o<s;++o){var h=t[o],l=Ss(r,e,h,n);if(o===0){if(a&&l||!a&&!l)return!1}else if(a&&!l||!a&&l)return!1;e=h}return!0}function eo(r,e,t,n,i){for(var a=i!==void 0?i:!1,o=0,s=t.length;o<s;++o){var h=t[o],l=Ss(r,e,h,n),u=o===0?a&&l||!a&&!l:a&&!l||!a&&l;u&&lc(r,e,h,n),e=h}return e}var cc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ps=function(r){cc(e,r);function e(t,n,i){var a=r.call(this)||this;return a.ends_=[],a.flatInteriorPointRevision_=-1,a.flatInteriorPoint_=null,a.maxDelta_=-1,a.maxDeltaRevision_=-1,a.orientedRevision_=-1,a.orientedFlatCoordinates_=null,n!==void 0&&i?(a.setFlatCoordinates(n,t),a.ends_=i):a.setCoordinates(t,n),a}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?Pl(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,i,a){return a<hs(this.getExtent(),t,n)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ku(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qu(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,n,i,a))},e.prototype.containsXY=function(t,n){return Cs(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,n)},e.prototype.getArea=function(){return Ju(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var n;return t!==void 0?(n=this.getOrientedFlatCoordinates().slice(),eo(n,0,this.ends_,this.stride,t)):n=this.flatCoordinates,Qu(n,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=ir(this.getExtent());this.flatInteriorPoint_=oc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new ic(this.getFlatInteriorPoint(),Lt.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new to(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,n=this.flatCoordinates,i=this.ends_,a=[],o=0,s=0,h=i.length;s<h;++s){var l=i[s],u=new to(n.slice(o,l),t);a.push(u),o=l}return a},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;uc(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=eo(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],i=[];return n.length=Wu(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,i),new e(n,Lt.XY,i)},e.prototype.getType=function(){return"Polygon"},e.prototype.intersectsExtent=function(t){return hc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=Hu(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()},e}(ta);function ro(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=[e,t,e,i,n,i,n,t,e,t];return new Ps(a,Lt.XY,[a.length])}const Bt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Ft={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function no(r){return r[0]>0&&r[1]>0}function fc(r,e,t){return t===void 0&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function Ct(r,e){return Array.isArray(r)?r:(e===void 0?e=[r,r]:(e[0]=r,e[1]=r),e)}var Is=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,bs=/^([a-z]*)$|^hsla?\(.*\)$/i;function vc(r){return typeof r=="string"?r:gc(r)}function Ls(r){var e=document.createElement("div");if(e.style.color=r,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var Ns=function(){var r=1024,e={},t=0;return function(n){var i;if(e.hasOwnProperty(n))i=e[n];else{if(t>=r){var a=0;for(var o in e)(a++&3)===0&&(delete e[o],--t)}i=pc(n),e[n]=i,++t}return i}}();function dc(r){return Array.isArray(r)?r:Ns(r)}function pc(r){var e,t,n,i,a;if(bs.exec(r)&&(r=Ls(r)),Is.exec(r)){var o=r.length-1,s=void 0;o<=4?s=1:s=2;var h=o===4||o===8;e=parseInt(r.substr(1+0*s,s),16),t=parseInt(r.substr(1+1*s,s),16),n=parseInt(r.substr(1+2*s,s),16),h?i=parseInt(r.substr(1+3*s,s),16):i=255,s==1&&(e=(e<<4)+e,t=(t<<4)+t,n=(n<<4)+n,h&&(i=(i<<4)+i)),a=[e,t,n,i/255]}else r.indexOf("rgba(")==0?(a=r.slice(5,-1).split(",").map(Number),io(a)):r.indexOf("rgb(")==0?(a=r.slice(4,-1).split(",").map(Number),a.push(1),io(a)):H(!1,14);return a}function io(r){return r[0]=ot(r[0]+.5|0,0,255),r[1]=ot(r[1]+.5|0,0,255),r[2]=ot(r[2]+.5|0,0,255),r[3]=ot(r[3],0,1),r}function gc(r){var e=r[0];e!=(e|0)&&(e=e+.5|0);var t=r[1];t!=(t|0)&&(t=t+.5|0);var n=r[2];n!=(n|0)&&(n=n+.5|0);var i=r[3]===void 0?1:Math.round(r[3]*100)/100;return"rgba("+e+","+t+","+n+","+i+")"}function _c(r){return bs.test(r)&&(r=Ls(r)),Is.test(r)||r.indexOf("rgba(")===0||r.indexOf("rgb(")===0}function Oi(r,e,t,n){var i;return t&&t.length?i=t.shift():Hl?i=new OffscreenCanvas(r||300,e||300):i=document.createElement("canvas"),r&&(i.width=r),e&&(i.height=e),i.getContext("2d",n)}function yc(r){var e=r.canvas;e.width=1,e.height=1,r.clearRect(0,0,1,1)}function ao(r,e){var t=e.parentNode;t&&t.replaceChild(r,e)}function Si(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function mc(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function Ec(r,e){for(var t=r.childNodes,n=0;;++n){var i=t[n],a=e[n];if(!i&&!a)break;if(i!==a){if(!i){r.appendChild(a);continue}if(!a){r.removeChild(i),--n;continue}r.insertBefore(a,i)}}}var nn="ol-hidden",$n="ol-unselectable",ea="ol-control",oo="ol-collapsed",Tc=new ue,Mc=new ur;Mc.setSize=function(){console.warn("labelCache is deprecated.")};const z={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var xc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Rc=function(r){xc(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un,n.background_=t.background;var i=ut({},t);return typeof t.properties=="object"&&(delete i.properties,ut(i,t.properties)),i[z.OPACITY]=t.opacity!==void 0?t.opacity:1,H(typeof i[z.OPACITY]=="number",64),i[z.VISIBLE]=t.visible!==void 0?t.visible:!0,i[z.Z_INDEX]=t.zIndex,i[z.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,i[z.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,i[z.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,i[z.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,n.className_=i.className!==void 0?i.className:"ol-layer",delete i.className,n.setProperties(i),n.state_=null,n}return e.prototype.getBackground=function(){return this.background_},e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var n=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return n.opacity=ot(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=i===void 0&&!n.managed?1/0:i,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n},e.prototype.getLayersArray=function(t){return Q()},e.prototype.getLayerStatesArray=function(t){return Q()},e.prototype.getExtent=function(){return this.get(z.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(z.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(z.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(z.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(z.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(z.OPACITY)},e.prototype.getSourceState=function(){return Q()},e.prototype.getVisible=function(){return this.get(z.VISIBLE)},e.prototype.getZIndex=function(){return this.get(z.Z_INDEX)},e.prototype.setBackground=function(t){this.background_=t,this.changed()},e.prototype.setExtent=function(t){this.set(z.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(z.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(z.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(z.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(z.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){H(typeof t=="number",64),this.set(z.OPACITY,t)},e.prototype.setVisible=function(t){this.set(z.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(z.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),r.prototype.disposeInternal.call(this)},e}(ue);const Ds=Rc;var wc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Cc=function(r){wc(e,r);function e(t){var n=this,i=ut({},t);delete i.source,n=r.call(this,i)||this,n.on,n.once,n.un,n.mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,n.rendered=!1,t.render&&(n.render=t.render),t.map&&n.setMap(t.map),n.addChangeListener(z.SOURCE,n.handleSourcePropertyChange_);var a=t.source?t.source:null;return n.setSource(a),n}return e.prototype.getLayersArray=function(t){var n=t||[];return n.push(this),n},e.prototype.getLayerStatesArray=function(t){var n=t||[];return n.push(this.getLayerState()),n},e.prototype.getSource=function(){return this.get(z.SOURCE)||null},e.prototype.getRenderSource=function(){return this.getSource()},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(at(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=K(t,G.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(n){return n([])})},e.prototype.getData=function(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)},e.prototype.render=function(t,n){var i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,n)},e.prototype.unrender=function(){this.rendered=!1},e.prototype.setMapInternal=function(t){t||this.unrender(),this.set(z.MAP,t)},e.prototype.getMapInternal=function(){return this.get(z.MAP)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(at(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(at(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=K(t,Bt.PRECOMPOSE,function(n){var i=n,a=i.frameState.layerStatesArray,o=this.getLayerState(!1);H(!a.some(function(s){return s.layer===o.layer}),67),a.push(o)},this),this.mapRenderKey_=K(this,G.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(z.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),r.prototype.disposeInternal.call(this)},e}(Ds);function Cn(r,e){if(!r.visible)return!1;var t=e.resolution;if(t<r.minResolution||t>=r.maxResolution)return!1;var n=e.zoom;return n>r.minZoom&&n<=r.maxZoom}const ra=Cc;var Ac=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Oc=function(r){Ac(e,r);function e(t){var n=r.call(this)||this;return n.ready=!0,n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=t,n.declutterExecutorGroup=null,n}return e.prototype.getFeatures=function(t){return Q()},e.prototype.getData=function(t){return null},e.prototype.prepareFrame=function(t){return Q()},e.prototype.renderFrame=function(t,n){return Q()},e.prototype.loadedTileCallback=function(t,n,i){t[n]||(t[n]={}),t[n][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,n,i){return function(a,o){var s=this.loadedTileCallback.bind(this,i,a);return t.forEachLoadedTile(n,a,o,s)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,o){},e.prototype.getDataAtPixel=function(t,n,i){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var n=t.target;n.getState()===Ft.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var n=t.getState();return n!=Ft.LOADED&&n!=Ft.ERROR&&t.addEventListener(G.CHANGE,this.boundHandleImageChange_),n==Ft.IDLE&&(t.load(),n=t.getState()),n==Ft.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()},e.prototype.disposeInternal=function(){delete this.layer_,r.prototype.disposeInternal.call(this)},e}(rs);const Sc=Oc;var Pc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ic=function(r){Pc(e,r);function e(t,n,i,a){var o=r.call(this,t)||this;return o.inversePixelTransform=n,o.frameState=i,o.context=a,o}return e}(Me);const pn=Ic,Gt={ANIMATING:0,INTERACTING:1};var bc=function(){function r(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return r.prototype.clear=function(){this.cache_={},this.cacheSize_=0},r.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},r.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},r.prototype.get=function(e,t,n){var i=so(e,t,n);return i in this.cache_?this.cache_[i]:null},r.prototype.set=function(e,t,n,i){var a=so(e,t,n);this.cache_[a]=i,++this.cacheSize_},r.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},r}();function so(r,e,t){var n=t?vc(t):"null";return e+":"+r+":"+n}var Gs=new bc,Lc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Nc=function(r){Lc(e,r);function e(t,n,i,a){var o=r.call(this)||this;return o.extent=t,o.pixelRatio_=i,o.resolution=n,o.state=a,o}return e.prototype.changed=function(){this.dispatchEvent(G.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Q()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Q()},e}(ur);const Dc=Nc;var Gc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Gc(e,r);function e(t,n,i,a,o,s){var h=r.call(this,t,n,i,Ft.IDLE)||this;return h.src_=a,h.image_=new Image,o!==null&&(h.image_.crossOrigin=o),h.unlisten_=null,h.state=Ft.IDLE,h.imageLoadFunction_=s,h}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Ft.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=qt(this.extent)/this.image_.height),this.state=Ft.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==Ft.IDLE||this.state==Ft.ERROR)&&(this.state=Ft.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=Fs(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=qt(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e})(Dc);function Fs(r,e,t){var n=r,i=!0,a=!1,o=!1,s=[Mn(n,G.LOAD,function(){o=!0,a||e()})];return n.src&&Zl?(a=!0,n.decode().then(function(){i&&e()}).catch(function(h){i&&(o?e():t())})):s.push(Mn(n,G.ERROR,t)),function(){i=!1,s.forEach(at)}}var Fc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Uc=function(r){Fc(e,r);function e(t){var n=r.call(this)||this;n.projection=ct(t.projection),n.attributions_=ho(t.attributions),n.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,n.loading=!1,n.state_=t.state!==void 0?t.state:"ready",n.wrapX_=t.wrapX!==void 0?t.wrapX:!1,n.interpolate_=!!t.interpolate,n.viewResolver=null,n.viewRejector=null;var i=n;return n.viewPromise_=new Promise(function(a,o){i.viewResolver=a,i.viewRejector=o}),n}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return Q()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getInterpolate=function(){return this.interpolate_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=ho(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(ue);function ho(r){return r?Array.isArray(r)?function(e){return r}:typeof r=="function"?r:function(e){return[r]}:null}const Bc=Uc,b={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Us(r){return Math.pow(r,3)}function fr(r){return 1-Us(1-r)}function jc(r){return 3*r*r-2*r*r*r}function Xc(r){return r}var zc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kc=function(r){zc(e,r);function e(t,n,i){var a=r.call(this)||this,o=i||{};return a.tileCoord=t,a.state=n,a.interimTile=null,a.key="",a.transition_=o.transition===void 0?250:o.transition,a.transitionStarts_={},a.interpolate=!!o.interpolate,a}return e.prototype.changed=function(){this.dispatchEvent(G.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==b.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(!!this.interimTile){var t=this.interimTile,n=this;do{if(t.getState()==b.LOADED){t.interimTile=null;break}else t.getState()==b.LOADING?n=t:t.getState()==b.IDLE?n.interimTile=t.interimTile:n=t;t=n.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==b.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){Q()},e.prototype.getAlpha=function(t,n){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(!i)i=n,this.transitionStarts_[t]=i;else if(i===-1)return 1;var a=n-i+1e3/60;return a>=this.transition_?1:Us(a/this.transition_)},e.prototype.inTransition=function(t){return this.transition_?this.transitionStarts_[t]!==-1:!1},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(ur);const na=kc;var $c=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Kc=function(r){$c(e,r);function e(t,n,i,a,o,s){var h=r.call(this,t,n,s)||this;return h.crossOrigin_=a,h.src_=i,h.key=i,h.image_=new Image,a!==null&&(h.image_.crossOrigin=a),h.unlisten_=null,h.tileLoadFunction_=o,h}return e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=b.LOADED,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){this.state=b.ERROR,this.unlistenImage_(),this.image_=qc(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=b.LOADED:this.state=b.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==b.ERROR&&(this.state=b.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==b.IDLE&&(this.state=b.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Fs(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(na);function qc(){var r=Oi(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}const Pi=Kc;var Vc=function(){function r(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return r.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},r.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},r.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var n=t-3;n>0&&this.points_[n+2]>e;)n-=3;var i=this.points_[t+2]-this.points_[n+2];if(i<1e3/60)return!1;var a=this.points_[t]-this.points_[n],o=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(o,a),this.initialVelocity_=Math.sqrt(a*a+o*o)/i,this.initialVelocity_>this.minVelocity_},r.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},r.prototype.getAngle=function(){return this.angle_},r}();const Hc=Vc;var Zc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yc=function(r){Zc(e,r);function e(t){var n=r.call(this)||this;return n.map_=t,n}return e.prototype.dispatchRenderEvent=function(t,n){Q()},e.prototype.calculateMatrices2D=function(t){var n=t.viewState,i=t.coordinateToPixelTransform,a=t.pixelToCoordinateTransform;Xn(i,t.size[0]/2,t.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),Wl(a,i)},e.prototype.forEachFeatureAtCoordinate=function(t,n,i,a,o,s,h,l){var u,c=n.viewState;function f(B,tt,et,V){return o.call(s,tt,B?et:null,V)}var v=c.projection,d=Cu(t.slice(),v),p=[[0,0]];if(v.canWrapX()&&a){var g=v.getExtent(),y=lt(g);p.push([-y,0],[y,0])}for(var _=n.layerStatesArray,m=_.length,E=[],T=[],M=0;M<p.length;M++)for(var R=m-1;R>=0;--R){var w=_[R],S=w.layer;if(S.hasRenderer()&&Cn(w,c)&&h.call(l,S)){var L=S.getRenderer(),I=S.getSource();if(L&&I){var j=I.getWrapX()?d:t,q=f.bind(null,w.managed);T[0]=j[0]+p[M][0],T[1]=j[1]+p[M][1],u=L.forEachFeatureAtCoordinate(T,n,i,q,E)}if(u)return u}}if(E.length!==0){var Y=1/E.length;return E.forEach(function(B,tt){return B.distanceSq+=tt*Y}),E.sort(function(B,tt){return B.distanceSq-tt.distanceSq}),E.some(function(B){return u=B.callback(B.feature,B.layer,B.geometry)}),u}},e.prototype.forEachLayerAtPixel=function(t,n,i,a,o){return Q()},e.prototype.hasFeatureAtCoordinate=function(t,n,i,a,o,s){var h=this.forEachFeatureAtCoordinate(t,n,i,a,wr,this,o,s);return h!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){Q()},e.prototype.scheduleExpireIconCache=function(t){Gs.canExpireCache()&&t.postRenderFunctions.push(Wc)},e}(Fn);function Wc(r,e){Gs.expire()}const Qc=Yc;var Jc=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),tf=function(r){Jc(e,r);function e(t){var n=r.call(this,t)||this;n.fontChangeListenerKey_=K(Tc,Pr.PROPERTYCHANGE,t.redrawText.bind(t)),n.element_=document.createElement("div");var i=n.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",n.element_.className=$n+" ol-layers";var a=t.getViewport();return a.insertBefore(n.element_,a.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return e.prototype.dispatchRenderEvent=function(t,n){var i=this.getMap();if(i.hasListener(t)){var a=new pn(t,void 0,n);i.dispatchEvent(a)}},e.prototype.disposeInternal=function(){at(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),r.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Bt.PRECOMPOSE,t);var n=t.layerStatesArray.sort(function(v,d){return v.zIndex-d.zIndex}),i=t.viewState;this.children_.length=0;for(var a=[],o=null,s=0,h=n.length;s<h;++s){var l=n[s];t.layerIndex=s;var u=l.layer,c=u.getSourceState();if(!Cn(l,i)||c!="ready"&&c!="undefined"){u.unrender();continue}var f=u.render(t,o);!f||(f!==o&&(this.children_.push(f),o=f),"getDeclutter"in u&&a.push(u))}for(var s=a.length-1;s>=0;--s)a[s].renderDeclutter(t);Ec(this.element_,this.children_),this.dispatchRenderEvent(Bt.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,n,i,a,o){for(var s=n.viewState,h=n.layerStatesArray,l=h.length,u=l-1;u>=0;--u){var c=h[u],f=c.layer;if(f.hasRenderer()&&Cn(c,s)&&o(f)){var v=f.getRenderer(),d=v.getDataAtPixel(t,n,i);if(d){var p=a(f,d);if(p)return p}}}},e}(Qc);const ef=tf;var Bs=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),pe=function(r){Bs(e,r);function e(t,n){var i=r.call(this,t)||this;return i.layer=n,i}return e}(Me),ti={LAYERS:"layers"},rf=function(r){Bs(e,r);function e(t){var n=this,i=t||{},a=ut({},i);delete a.layers;var o=i.layers;return n=r.call(this,a)||this,n.on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(ti.LAYERS,n.handleLayersChanged_),o?Array.isArray(o)?o=new $t(o.slice(),{unique:!0}):H(typeof o.getArray=="function",43):o=new $t(void 0,{unique:!0}),n.setLayers(o),n}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(at),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(K(t,Ut.ADD,this.handleLayersAdd_,this),K(t,Ut.REMOVE,this.handleLayersRemove_,this));for(var n in this.listenerKeys_)this.listenerKeys_[n].forEach(at);Br(this.listenerKeys_);for(var i=t.getArray(),a=0,o=i.length;a<o;a++){var s=i[a];this.registerLayerListeners_(s),this.dispatchEvent(new pe("addlayer",s))}this.changed()},e.prototype.registerLayerListeners_=function(t){var n=[K(t,Pr.PROPERTYCHANGE,this.handleLayerChange_,this),K(t,G.CHANGE,this.handleLayerChange_,this)];t instanceof e&&n.push(K(t,"addlayer",this.handleLayerGroupAdd_,this),K(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[At(t)]=n},e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new pe("addlayer",t.layer))},e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new pe("removelayer",t.layer))},e.prototype.handleLayersAdd_=function(t){var n=t.element;this.registerLayerListeners_(n),this.dispatchEvent(new pe("addlayer",n)),this.changed()},e.prototype.handleLayersRemove_=function(t){var n=t.element,i=At(n);this.listenerKeys_[i].forEach(at),delete this.listenerKeys_[i],this.dispatchEvent(new pe("removelayer",n)),this.changed()},e.prototype.getLayers=function(){return this.get(ti.LAYERS)},e.prototype.setLayers=function(t){var n=this.getLayers();if(n)for(var i=n.getArray(),a=0,o=i.length;a<o;++a)this.dispatchEvent(new pe("removelayer",i[a]));this.set(ti.LAYERS,t)},e.prototype.getLayersArray=function(t){var n=t!==void 0?t:[];return this.getLayers().forEach(function(i){i.getLayersArray(n)}),n},e.prototype.getLayerStatesArray=function(t){var n=t!==void 0?t:[],i=n.length;this.getLayers().forEach(function(u){u.getLayerStatesArray(n)});var a=this.getLayerState(),o=a.zIndex;!t&&a.zIndex===void 0&&(o=0);for(var s=i,h=n.length;s<h;s++){var l=n[s];l.opacity*=a.opacity,l.visible=l.visible&&a.visible,l.maxResolution=Math.min(l.maxResolution,a.maxResolution),l.minResolution=Math.max(l.minResolution,a.minResolution),l.minZoom=Math.max(l.minZoom,a.minZoom),l.maxZoom=Math.min(l.maxZoom,a.maxZoom),a.extent!==void 0&&(l.extent!==void 0?l.extent=_e(l.extent,a.extent):l.extent=a.extent),l.zIndex===void 0&&(l.zIndex=o)}return n},e.prototype.getSourceState=function(){return"ready"},e}(Ds);const Kn=rf;var nf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),af=function(r){nf(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.map=n,a.frameState=i!==void 0?i:null,a}return e}(Me);const Xe=af;var of=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),sf=function(r){of(e,r);function e(t,n,i,a,o,s){var h=r.call(this,t,n,o)||this;return h.originalEvent=i,h.pixel_=null,h.coordinate_=null,h.dragging=a!==void 0?a:!1,h.activePointers=s,h}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){r.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){r.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(Xe);const ve=sf,nt={SINGLECLICK:"singleclick",CLICK:G.CLICK,DBLCLICK:G.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ii={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var hf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lf=function(r){hf(e,r);function e(t,n){var i=r.call(this,t)||this;i.map_=t,i.clickTimeoutId_,i.emulateClicks_=!1,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=n===void 0?1:n,i.down_=null;var a=i.map_.getViewport();return i.activePointers_=[],i.trackedTouches_={},i.element_=a,i.pointerdownListenerKey_=K(a,Ii.POINTERDOWN,i.handlePointerDown_,i),i.originalPointerMoveEvent_,i.relayedListenerKey_=K(a,Ii.POINTERMOVE,i.relayMoveEvent_,i),i.boundHandleTouchMove_=i.handleTouchMove_.bind(i),i.element_.addEventListener(G.TOUCHMOVE,i.boundHandleTouchMove_,os?{passive:!1}:!1),i}return e.prototype.emulateClick_=function(t){var n=new ve(nt.CLICK,this.map_,t);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new ve(nt.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var i=new ve(nt.SINGLECLICK,this.map_,t);this.dispatchEvent(i)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var n=t,i=n.pointerId;if(n.type==nt.POINTERUP||n.type==nt.POINTERCANCEL){delete this.trackedTouches_[i];for(var a in this.trackedTouches_)if(this.trackedTouches_[a].target!==n.target){delete this.trackedTouches_[a];break}}else(n.type==nt.POINTERDOWN||n.type==nt.POINTERMOVE)&&(this.trackedTouches_[i]=n);this.activePointers_=Nl(this.trackedTouches_)},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var n=new ve(nt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(at),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);var n=new ve(nt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.down_={};for(var i in t){var a=t[i];this.down_[i]=typeof a=="function"?Ir:a}if(this.dragListenerKeys_.length===0){var o=this.map_.getOwnerDocument();this.dragListenerKeys_.push(K(o,nt.POINTERMOVE,this.handlePointerMove_,this),K(o,nt.POINTERUP,this.handlePointerUp_,this),K(this.element_,nt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==o&&this.dragListenerKeys_.push(K(this.element_.getRootNode(),nt.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;var n=new ve(nt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}},e.prototype.relayMoveEvent_=function(t){this.originalPointerMoveEvent_=t;var n=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ve(nt.POINTERMOVE,this.map_,t,n))},e.prototype.handleTouchMove_=function(t){var n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(at(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(G.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(at(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(at),this.dragListenerKeys_.length=0,this.element_=null,r.prototype.disposeInternal.call(this)},e}(ur);const uf=lf,de={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},mt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var An=1/0,cf=function(){function r(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return r.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Br(this.queuedElements_)},r.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n},r.prototype.enqueue=function(e){H(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=An?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},r.prototype.getCount=function(){return this.elements_.length},r.prototype.getLeftChildIndex_=function(e){return e*2+1},r.prototype.getRightChildIndex_=function(e){return e*2+2},r.prototype.getParentIndex_=function(e){return e-1>>1},r.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},r.prototype.isEmpty=function(){return this.elements_.length===0},r.prototype.isKeyQueued=function(e){return e in this.queuedElements_},r.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},r.prototype.siftUp_=function(e){for(var t=this.elements_,n=this.priorities_,i=t.length,a=t[e],o=n[e],s=e;e<i>>1;){var h=this.getLeftChildIndex_(e),l=this.getRightChildIndex_(e),u=l<i&&n[l]<n[h]?l:h;t[e]=t[u],n[e]=n[u],e=u}t[e]=a,n[e]=o,this.siftDown_(s,e)},r.prototype.siftDown_=function(e,t){for(var n=this.elements_,i=this.priorities_,a=n[t],o=i[t];t>e;){var s=this.getParentIndex_(t);if(i[s]>o)n[t]=n[s],i[t]=i[s],t=s;else break}n[t]=a,i[t]=o},r.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,n=this.priorities_,i=0,a=t.length,o,s,h;for(s=0;s<a;++s)o=t[s],h=e(o),h==An?delete this.queuedElements_[this.keyFunction_(o)]:(n[i]=h,t[i++]=o);t.length=i,n.length=i,this.heapify_()},r}();const ff=cf;var vf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),df=function(r){vf(e,r);function e(t,n){var i=r.call(this,function(a){return t.apply(null,a)},function(a){return a[0].getKey()})||this;return i.boundHandleTileChange_=i.handleTileChange.bind(i),i.tileChangeCallback_=n,i.tilesLoading_=0,i.tilesLoadingKeys_={},i}return e.prototype.enqueue=function(t){var n=r.prototype.enqueue.call(this,t);if(n){var i=t[0];i.addEventListener(G.CHANGE,this.boundHandleTileChange_)}return n},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var n=t.target,i=n.getState();if(i===b.LOADED||i===b.ERROR||i===b.EMPTY){n.removeEventListener(G.CHANGE,this.boundHandleTileChange_);var a=n.getKey();a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,n){for(var i=0,a,o,s;this.tilesLoading_<t&&i<n&&this.getCount()>0;)o=this.dequeue()[0],s=o.getKey(),a=o.getState(),a===b.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,o.load())},e}(ff);const pf=df;function gf(r,e,t,n,i){if(!r||!(t in r.wantedTiles)||!r.wantedTiles[t][e.getKey()])return An;var a=r.viewState.center,o=n[0]-a[0],s=n[1]-a[1];return 65536*Math.log(i)+Math.sqrt(o*o+s*s)/i}const jt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var _f=42,ia=256;function lo(r,e,t){return function(n,i,a,o,s){if(!!n){if(!i&&!e)return n;var h=e?0:a[0]*i,l=e?0:a[1]*i,u=s?s[0]:0,c=s?s[1]:0,f=r[0]+h/2+u,v=r[2]-h/2+u,d=r[1]+l/2+c,p=r[3]-l/2+c;f>v&&(f=(v+f)/2,v=f),d>p&&(d=(p+d)/2,p=d);var g=ot(n[0],f,v),y=ot(n[1],d,p);if(o&&t&&i){var _=30*i;g+=-_*Math.log(1+Math.max(0,f-n[0])/_)+_*Math.log(1+Math.max(0,n[0]-v)/_),y+=-_*Math.log(1+Math.max(0,d-n[1])/_)+_*Math.log(1+Math.max(0,n[1]-p)/_)}return[g,y]}}}function yf(r){return r}function aa(r,e,t,n){var i=lt(e)/t[0],a=qt(e)/t[1];return n?Math.min(r,Math.max(i,a)):Math.min(r,Math.min(i,a))}function oa(r,e,t){var n=Math.min(r,e),i=50;return n*=Math.log(1+i*Math.max(0,r/e-1))/i+1,t&&(n=Math.max(n,t),n/=Math.log(1+i*Math.max(0,t/r-1))/i+1),ot(n,t/2,e*2)}function mf(r,e,t,n){return function(i,a,o,s){if(i!==void 0){var h=r[0],l=r[r.length-1],u=t?aa(h,t,o,n):h;if(s){var c=e!==void 0?e:!0;return c?oa(i,u,l):ot(i,l,u)}var f=Math.min(u,i),v=Math.floor(ki(r,f,a));return r[v]>u&&v<r.length-1?r[v+1]:r[v]}else return}}function Ef(r,e,t,n,i,a){return function(o,s,h,l){if(o!==void 0){var u=i?aa(e,i,h,a):e,c=t!==void 0?t:0;if(l){var f=n!==void 0?n:!0;return f?oa(o,u,c):ot(o,c,u)}var v=1e-9,d=Math.ceil(Math.log(e/u)/Math.log(r)-v),p=-s*(.5-v)+.5,g=Math.min(u,o),y=Math.floor(Math.log(e/g)/Math.log(r)+p),_=Math.max(d,y),m=e/Math.pow(r,_);return ot(m,c,u)}else return}}function uo(r,e,t,n,i){return function(a,o,s,h){if(a!==void 0){var l=n?aa(r,n,s,i):r,u=t!==void 0?t:!0;return!u||!h?ot(a,e,l):oa(a,l,e)}else return}}function sa(r){if(r!==void 0)return 0}function co(r){if(r!==void 0)return r}function Tf(r){var e=2*Math.PI/r;return function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function Mf(r){var e=r||dn(5);return function(t,n){if(n)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}var xf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ei=0,Rf=function(r){xf(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un;var i=ut({},t);return n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=Qi(i.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,i.projection&&gs(),i.center&&(i.center=oe(i.center,n.projection_)),i.extent&&(i.extent=Ke(i.extent,n.projection_)),n.applyOptions_(i),n}return e.prototype.applyOptions_=function(t){var n=ut({},t);for(var i in jt)delete n[i];this.setProperties(n,!0);var a=Cf(t);this.maxResolution_=a.maxResolution,this.minResolution_=a.minResolution,this.zoomFactor_=a.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=a.minZoom;var o=wf(t),s=a.constraint,h=Af(t);this.constraints_={center:o,resolution:s,rotation:h},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var n=this.padding_;this.padding_=t;var i=this.getCenter();if(i){var a=t||[0,0,0,0];n=n||[0,0,0,0];var o=this.getResolution(),s=o/2*(a[3]-n[3]+n[1]-a[1]),h=o/2*(a[0]-n[0]+n[2]-a[2]);this.setCenterInternal([i[0]+s,i[1]-h])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),ut({},n,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),i=0;i<n.length;++i){var a=arguments[i];a.center&&(a=ut({},a),a.center=oe(a.center,this.getProjection())),a.anchor&&(a=ut({},a),a.anchor=oe(a.anchor,this.getProjection())),n[i]=a}this.animateInternal.apply(this,n)},e.prototype.animateInternal=function(t){var n=arguments.length,i;n>1&&typeof arguments[n-1]=="function"&&(i=arguments[n-1],--n);for(var a=0;a<n&&!this.isDef();++a){var o=arguments[a];o.center&&this.setCenterInternal(o.center),o.zoom!==void 0?this.setZoom(o.zoom):o.resolution&&this.setResolution(o.resolution),o.rotation!==void 0&&this.setRotation(o.rotation)}if(a===n){i&&an(i,!0);return}for(var s=Date.now(),h=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_,c=[];a<n;++a){var f=arguments[a],v={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||jc,callback:i};if(f.center&&(v.sourceCenter=h,v.targetCenter=f.center.slice(),h=v.targetCenter),f.zoom!==void 0?(v.sourceResolution=l,v.targetResolution=this.getResolutionForZoom(f.zoom),l=v.targetResolution):f.resolution&&(v.sourceResolution=l,v.targetResolution=f.resolution,l=v.targetResolution),f.rotation!==void 0){v.sourceRotation=u;var d=We(f.rotation-u+Math.PI,2*Math.PI)-Math.PI;v.targetRotation=u+d,u=v.targetRotation}Of(v)?v.complete=!0:s+=v.duration,c.push(v)}this.animations_.push(c),this.setHint(Gt.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Gt.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[Gt.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(Gt.ANIMATING,-this.hints_[Gt.ANIMATING]);for(var t,n=0,i=this.animations_.length;n<i;++n){var a=this.animations_[n];if(a[0].callback&&an(a[0].callback,!1),!t)for(var o=0,s=a.length;o<s;++o){var h=a[o];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),n=!1,i=this.animations_.length-1;i>=0;--i){for(var a=this.animations_[i],o=!0,s=0,h=a.length;s<h;++s){var l=a[s];if(!l.complete){var u=t-l.start,c=l.duration>0?u/l.duration:1;c>=1?(l.complete=!0,c=1):o=!1;var f=l.easing(c);if(l.sourceCenter){var v=l.sourceCenter[0],d=l.sourceCenter[1],p=l.targetCenter[0],g=l.targetCenter[1];this.nextCenter_=l.targetCenter;var y=v+f*(p-v),_=d+f*(g-d);this.targetCenter_=[y,_]}if(l.sourceResolution&&l.targetResolution){var m=f===1?l.targetResolution:l.sourceResolution+f*(l.targetResolution-l.sourceResolution);if(l.anchor){var E=this.getViewportSize_(this.getRotation()),T=this.constraints_.resolution(m,0,E,!0);this.targetCenter_=this.calculateCenterZoom(T,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){var M=f===1?We(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+f*(l.targetRotation-l.sourceRotation);if(l.anchor){var R=this.constraints_.rotation(M,!0);this.targetCenter_=this.calculateCenterRotate(R,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=M}if(this.applyTargetState_(!0),n=!0,!l.complete)break}}if(o){this.animations_[i]=null,this.setHint(Gt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var w=a[0].callback;w&&an(w,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,n){var i,a=this.getCenterInternal();return a!==void 0&&(i=[a[0]-n[0],a[1]-n[1]],Yi(i,t-this.getRotation()),Ru(i,n)),i},e.prototype.calculateCenterZoom=function(t,n){var i,a=this.getCenterInternal(),o=this.getResolution();if(a!==void 0&&o!==void 0){var s=n[0]-t*(n[0]-a[0])/o,h=n[1]-t*(n[1]-a[1])/o;i=[s,h]}return i},e.prototype.getViewportSize_=function(t){var n=this.viewportSize_;if(t){var i=n[0],a=n[1];return[Math.abs(i*Math.cos(t))+Math.abs(a*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(a*Math.cos(t))]}else return n},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&wn(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(jt.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var n=this.calculateExtentInternal(t);return Es(n,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var n=t||this.getViewportSizeMinusPadding_(),i=this.getCenterInternal();H(i,1);var a=this.getResolution();H(a!==void 0,2);var o=this.getRotation();return H(o!==void 0,3),Ri(i,a,o,n)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(jt.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,n){return this.getResolutionForExtentInternal(Ke(t,this.getProjection()),n)},e.prototype.getResolutionForExtentInternal=function(t,n){var i=n||this.getViewportSizeMinusPadding_(),a=lt(t)/i[0],o=qt(t)/i[1];return Math.max(a,o)},e.prototype.getResolutionForValueFunction=function(t){var n=t||2,i=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,o=Math.log(i/a)/Math.log(n);return function(s){var h=i/Math.pow(n,s*o);return h}},e.prototype.getRotation=function(){return this.get(jt.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var n=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,o=Math.log(i/a)/n;return function(s){var h=Math.log(i/s)/n/o;return h}},e.prototype.getViewportSizeMinusPadding_=function(t){var n=this.getViewportSize_(t),i=this.padding_;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n},e.prototype.getState=function(){var t=this.getProjection(),n=this.getResolution(),i=this.getRotation(),a=this.getCenterInternal(),o=this.padding_;if(o){var s=this.getViewportSizeMinusPadding_();a=ri(a,this.getViewportSize_(),[s[0]/2+o[3],s[1]/2+o[0]],n,i)}return{center:a.slice(0),projection:t!==void 0?t:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,n=this.getResolution();return n!==void 0&&(t=this.getZoomForResolution(n)),t},e.prototype.getZoomForResolution=function(t){var n=this.minZoom_||0,i,a;if(this.resolutions_){var o=ki(this.resolutions_,t,1);n=o,i=this.resolutions_[o],o==this.resolutions_.length-1?a=2:a=i/this.resolutions_[o+1]}else i=this.maxResolution_,a=this.zoomFactor_;return n+Math.log(i/t)/Math.log(a)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var n=ot(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(i,ot(t-n,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,n){var i;if(H(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){H(!kn(t),25);var a=Ke(t,this.getProjection());i=ro(a)}else if(t.getType()==="Circle"){var a=Ke(t.getExtent(),this.getProjection());i=ro(a),i.rotate(this.getRotation(),ir(a))}else{var o=Lu();o?i=t.clone().transform(o,this.getProjection()):i=t}this.fitInternal(i,n)},e.prototype.rotatedExtentForGeometry=function(t){for(var n=this.getRotation(),i=Math.cos(n),a=Math.sin(-n),o=t.getFlatCoordinates(),s=t.getStride(),h=1/0,l=1/0,u=-1/0,c=-1/0,f=0,v=o.length;f<v;f+=s){var d=o[f]*i-o[f+1]*a,p=o[f]*a+o[f+1]*i;h=Math.min(h,d),l=Math.min(l,p),u=Math.max(u,d),c=Math.max(c,p)}return[h,l,u,c]},e.prototype.fitInternal=function(t,n){var i=n||{},a=i.size;a||(a=this.getViewportSizeMinusPadding_());var o=i.padding!==void 0?i.padding:[0,0,0,0],s=i.nearest!==void 0?i.nearest:!1,h;i.minResolution!==void 0?h=i.minResolution:i.maxZoom!==void 0?h=this.getResolutionForZoom(i.maxZoom):h=0;var l=this.rotatedExtentForGeometry(t),u=this.getResolutionForExtentInternal(l,[a[0]-o[1]-o[3],a[1]-o[0]-o[2]]);u=isNaN(u)?h:Math.max(u,h),u=this.getConstrainedResolution(u,s?0:1);var c=this.getRotation(),f=Math.sin(c),v=Math.cos(c),d=ir(l);d[0]+=(o[1]-o[3])/2*u,d[1]+=(o[0]-o[2])/2*u;var p=d[0]*v-d[1]*f,g=d[1]*v+d[0]*f,y=this.getConstrainedCenter([p,g],u),_=i.callback?i.callback:Ir;i.duration!==void 0?this.animateInternal({resolution:u,center:y,duration:i.duration,easing:i.easing},_):(this.targetResolution_=u,this.targetCenter_=y,this.applyTargetState_(!1,!0),an(_,!0))},e.prototype.centerOn=function(t,n,i){this.centerOnInternal(oe(t,this.getProjection()),n,i)},e.prototype.centerOnInternal=function(t,n,i){this.setCenterInternal(ri(t,n,i,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,n,i,a){var o,s=this.padding_;if(s&&t){var h=this.getViewportSizeMinusPadding_(-i),l=ri(t,a,[h[0]/2+s[3],h[1]/2+s[0]],n,i);o=[t[0]-l[0],t[1]-l[1]]}return o},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var n=wn(this.targetCenter_,this.getProjection());this.setCenter([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var n=this.targetCenter_;this.setCenterInternal([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustResolution=function(t,n){var i=n&&oe(n,this.getProjection());this.adjustResolutionInternal(t,i)},e.prototype.adjustResolutionInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),a=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,a,i);n&&(this.targetCenter_=this.calculateCenterZoom(o,n)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,n){this.adjustResolution(Math.pow(this.zoomFactor_,-t),n)},e.prototype.adjustRotation=function(t,n){n&&(n=oe(n,this.getProjection())),this.adjustRotationInternal(t,n)},e.prototype.adjustRotationInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),a=this.constraints_.rotation(this.targetRotation_+t,i);n&&(this.targetCenter_=this.calculateCenterRotate(a,n)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(t&&oe(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,n){return this.hints_[t]+=n,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,n){var i=this.getAnimating()||this.getInteracting()||n,a=this.constraints_.rotation(this.targetRotation_,i),o=this.getViewportSize_(a),s=this.constraints_.resolution(this.targetResolution_,0,o,i),h=this.constraints_.center(this.targetCenter_,s,o,i,this.calculateCenterShift(this.targetCenter_,s,a,o));this.get(jt.ROTATION)!==a&&this.set(jt.ROTATION,a),this.get(jt.RESOLUTION)!==s&&(this.set(jt.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!h||!this.get(jt.CENTER)||!xn(this.get(jt.CENTER),h))&&this.set(jt.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,n,i){var a=t!==void 0?t:200,o=n||0,s=this.constraints_.rotation(this.targetRotation_),h=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,o,h),u=this.constraints_.center(this.targetCenter_,l,h,!1,this.calculateCenterShift(this.targetCenter_,l,s,h));if(a===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=s,this.targetCenter_=u,this.applyTargetState_();return}var c=i||(a===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==s||!this.getCenterInternal()||!xn(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:l,duration:a,easing:fr,anchor:c}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Gt.INTERACTING,1)},e.prototype.endInteraction=function(t,n,i){var a=i&&oe(i,this.getProjection());this.endInteractionInternal(t,n,a)},e.prototype.endInteractionInternal=function(t,n,i){this.setHint(Gt.INTERACTING,-1),this.resolveConstraints(t,n,i)},e.prototype.getConstrainedCenter=function(t,n){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,n||this.getResolution(),i)},e.prototype.getConstrainedZoom=function(t,n){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,n))},e.prototype.getConstrainedResolution=function(t,n){var i=n||0,a=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,a)},e}(ue);function an(r,e){setTimeout(function(){r(e)},0)}function wf(r){if(r.extent!==void 0){var e=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return lo(r.extent,r.constrainOnlyCenter,e)}var t=Qi(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&t.isGlobal()){var n=t.getExtent().slice();return n[0]=-1/0,n[2]=1/0,lo(n,!1,!1)}return yf}function Cf(r){var e,t,n,i=28,a=2,o=r.minZoom!==void 0?r.minZoom:ei,s=r.maxZoom!==void 0?r.maxZoom:i,h=r.zoomFactor!==void 0?r.zoomFactor:a,l=r.multiWorld!==void 0?r.multiWorld:!1,u=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,c=r.showFullExtent!==void 0?r.showFullExtent:!1,f=Qi(r.projection,"EPSG:3857"),v=f.getExtent(),d=r.constrainOnlyCenter,p=r.extent;if(!l&&!p&&f.isGlobal()&&(d=!1,p=v),r.resolutions!==void 0){var g=r.resolutions;t=g[o],n=g[s]!==void 0?g[s]:g[g.length-1],r.constrainResolution?e=mf(g,u,!d&&p,c):e=uo(t,n,u,!d&&p,c)}else{var y=v?Math.max(lt(v),qt(v)):360*Jt[le.DEGREES]/f.getMetersPerUnit(),_=y/ia/Math.pow(a,ei),m=_/Math.pow(a,i-ei);t=r.maxResolution,t!==void 0?o=0:t=_/Math.pow(h,o),n=r.minResolution,n===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?n=t/Math.pow(h,s):n=_/Math.pow(h,s):n=m),s=o+Math.floor(Math.log(t/n)/Math.log(h)),n=t/Math.pow(h,s-o),r.constrainResolution?e=Ef(h,t,n,u,!d&&p,c):e=uo(t,n,u,!d&&p,c)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:o,zoomFactor:h}}function Af(r){var e=r.enableRotation!==void 0?r.enableRotation:!0;if(e){var t=r.constrainRotation;return t===void 0||t===!0?Mf():t===!1?co:typeof t=="number"?Tf(t):co}else return sa}function Of(r){return!(r.sourceCenter&&r.targetCenter&&!xn(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function ri(r,e,t,n,i){var a=Math.cos(-i),o=Math.sin(-i),s=r[0]*a-r[1]*o,h=r[1]*a+r[0]*o;s+=(e[0]/2-t[0])*n,h+=(t[1]-e[1]/2)*n,o=-o;var l=s*a-h*o,u=h*a+s*o;return[l,u]}const ge=Rf;var Sf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function js(r){if(r instanceof ra){r.setMapInternal(null);return}r instanceof Kn&&r.getLayers().forEach(js)}function Xs(r,e){if(r instanceof ra){r.setMapInternal(e);return}if(r instanceof Kn)for(var t=r.getLayers().getArray(),n=0,i=t.length;n<i;++n)Xs(t[n],e)}var Pf=function(r){Sf(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un;var i=If(t);n.renderComplete_,n.loaded_=!0,n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,n.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:as,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=Ie(),n.pixelToCoordinateTransform_=Ie(),n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=t.moveTolerance,n.keyboardEventTarget_=i.keyboardEventTarget,n.targetChangeHandlerKeys_=null,n.controls=i.controls||new $t,n.interactions=i.interactions||new $t,n.overlays_=i.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new pf(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addChangeListener(mt.LAYERGROUP,n.handleLayerGroupChanged_),n.addChangeListener(mt.VIEW,n.handleViewChanged_),n.addChangeListener(mt.SIZE,n.handleSizeChanged_),n.addChangeListener(mt.TARGET,n.handleTargetChanged_),n.setProperties(i.values);var a=n;return t.view&&!(t.view instanceof ge)&&t.view.then(function(o){a.setView(new ge(o))}),n.controls.addEventListener(Ut.ADD,function(o){o.element.setMap(this)}.bind(n)),n.controls.addEventListener(Ut.REMOVE,function(o){o.element.setMap(null)}.bind(n)),n.interactions.addEventListener(Ut.ADD,function(o){o.element.setMap(this)}.bind(n)),n.interactions.addEventListener(Ut.REMOVE,function(o){o.element.setMap(null)}.bind(n)),n.overlays_.addEventListener(Ut.ADD,function(o){this.addOverlayInternal_(o.element)}.bind(n)),n.overlays_.addEventListener(Ut.REMOVE,function(o){var s=o.element,h=s.getId();h!==void 0&&delete this.overlayIdIndex_[h.toString()],o.element.setMap(null)}.bind(n)),n.controls.forEach(function(o){o.setMap(this)}.bind(n)),n.interactions.forEach(function(o){o.setMap(this)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var n=this.getLayerGroup().getLayers();n.push(t)},e.prototype.handleLayerAdd_=function(t){Xs(t.layer,this)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var n=t.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.setTarget(null),r.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,n,i){if(!(!this.frameState_||!this.renderer_)){var a=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};var o=i.hitTolerance!==void 0?i.hitTolerance:0,s=i.layerFilter!==void 0?i.layerFilter:wr,h=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,o,h,n,null,s,null)}},e.prototype.getFeaturesAtPixel=function(t,n){var i=[];return this.forEachFeatureAtPixel(t,function(a){i.push(a)},n),i},e.prototype.getAllLayers=function(){var t=[];function n(i){i.forEach(function(a){a instanceof Kn?n(a.getLayers()):t.push(a)})}return n(this.getLayers()),t},e.prototype.forEachLayerAtPixel=function(t,n,i){if(!(!this.frameState_||!this.renderer_)){var a=i||{},o=a.hitTolerance!==void 0?a.hitTolerance:0,s=a.layerFilter||wr;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,o,n,s)}},e.prototype.hasFeatureAtPixel=function(t,n){if(!this.frameState_||!this.renderer_)return!1;var i=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};var a=n.layerFilter!==void 0?n.layerFilter:wr,o=n.hitTolerance!==void 0?n.hitTolerance:0,s=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,o,s,a,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var n=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-n.left,i.clientY-n.top]},e.prototype.getTarget=function(){return this.get(mt.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return wn(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var n=this.frameState_;return n?br(n.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var n=this.overlayIdIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(mt.LAYERGROUP)},e.prototype.setLayers=function(t){var n=this.getLayerGroup();if(t instanceof $t){n.setLayers(t);return}var i=n.getLayers();i.clear(),i.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var a=t[n];if(!!a.visible){var o=a.layer.getRenderer();if(o&&!o.ready)return!0;var s=a.layer.getSource();if(s&&s.loading)return!0}}return!1},e.prototype.getPixelFromCoordinate=function(t){var n=oe(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)},e.prototype.getPixelFromCoordinateInternal=function(t){var n=this.frameState_;return n?br(n.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(mt.SIZE)},e.prototype.getView=function(){return this.get(mt.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,n,i,a){return gf(this.frameState_,t,n,i,a)},e.prototype.handleBrowserEvent=function(t,n){var i=n||t.type,a=new ve(i,this,t);this.handleMapBrowserEvent(a)},e.prototype.handleMapBrowserEvent=function(t){if(!!this.frameState_){var n=t.originalEvent,i=n.type;if(i===Ii.POINTERDOWN||i===G.WHEEL||i===G.KEYDOWN){var a=this.getOwnerDocument(),o=this.viewport_.getRootNode?this.viewport_.getRootNode():a,s=n.target;if(this.overlayContainerStopEvent_.contains(s)||!(o===a?a.documentElement:o).contains(s))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var h=this.getInteractions().getArray().slice(),l=h.length-1;l>=0;l--){var u=h[l];if(!(u.getMap()!==this||!u.getActive()||!this.getTargetElement())){var c=u.handleEvent(t);if(!c||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){var i=this.maxTilesLoading_,a=i;if(t){var o=t.viewHints;if(o[Gt.ANIMATING]||o[Gt.INTERACTING]){var s=Date.now()-t.time>8;i=s?0:8,a=s?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,a))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(Bt.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Bt.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Xe(de.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Xe(de.LOADSTART,this,t))));for(var h=this.postRenderFunctions_,l=0,u=h.length;l<u;++l)h[l](this,t);h.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,n=this.targetChangeHandlerKeys_.length;t<n;++t)at(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(G.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(G.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Si(this.viewport_)}var i=this.getTargetElement();if(!i)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{i.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new uf(this,this.moveTolerance_);for(var a in nt)this.mapBrowserEventHandler_.addEventListener(nt[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(G.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(G.WHEEL,this.boundHandleBrowserEvent_,os?{passive:!1}:!1);var o=this.getOwnerDocument().defaultView,s=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[K(s,G.KEYDOWN,this.handleBrowserEvent,this),K(s,G.KEYPRESS,this.handleBrowserEvent,this),K(o,G.RESIZE,this.updateSize,this)]}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(at(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(at(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=K(t,Pr.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=K(t,G.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(at),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new pe("addlayer",t)),this.layerGroupPropertyListenerKeys_=[K(t,Pr.PROPERTYCHANGE,this.render,this),K(t,G.CHANGE,this.render,this),K(t,"addlayer",this.handleLayerAdd_,this),K(t,"removelayer",this.handleLayerRemove_,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var a=t[n].layer;a.hasRenderer()&&a.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var n=this.getLayerGroup().getLayers();return n.remove(t)},e.prototype.handleLayerRemove_=function(t){js(t.layer)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var n=this,i=this.getSize(),a=this.getView(),o=this.frameState_,s=null;if(i!==void 0&&no(i)&&a&&a.isDef()){var h=a.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=a.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Ri(l.center,l.resolution,l.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:l,viewHints:h,wantedTiles:{},mapId:At(this),renderTargets:{}},l.nextCenter&&l.nextResolution){var u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;s.nextExtent=Ri(l.nextCenter,l.nextResolution,u,i)}}if(this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),o){var c=!this.previousExtent_||!kn(this.previousExtent_)&&!ka(s.extent,this.previousExtent_);c&&(this.dispatchEvent(new Xe(de.MOVESTART,this,o)),this.previousExtent_=zn(this.previousExtent_))}var f=this.previousExtent_&&!s.viewHints[Gt.ANIMATING]&&!s.viewHints[Gt.INTERACTING]&&!ka(s.extent,this.previousExtent_);f&&(this.dispatchEvent(new Xe(de.MOVEEND,this,s)),Jl(s.extent,this.previousExtent_))}this.dispatchEvent(new Xe(de.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(de.LOADSTART)||this.hasListener(de.LOADEND)||this.hasListener(Bt.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){var n=this.getLayerGroup();n&&this.handleLayerRemove_(new pe("removelayer",n)),this.set(mt.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(mt.SIZE,t)},e.prototype.setTarget=function(t){this.set(mt.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof ge){this.set(mt.VIEW,t);return}this.set(mt.VIEW,new ge);var n=this;t.then(function(i){n.setView(new ge(i))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),n=void 0;if(t){var i=getComputedStyle(t),a=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),o=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(a)&&!isNaN(o)&&(n=[a,o],!no(n)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(n),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var n=void 0,i=getComputedStyle(this.viewport_);i.width&&i.height&&(n=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(n)}},e}(ue);function If(r){var e=null;r.keyboardEventTarget!==void 0&&(e=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);var t={},n=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new Kn({layers:r.layers});t[mt.LAYERGROUP]=n,t[mt.TARGET]=r.target,t[mt.VIEW]=r.view instanceof ge?r.view:new ge;var i;r.controls!==void 0&&(Array.isArray(r.controls)?i=new $t(r.controls.slice()):(H(typeof r.controls.getArray=="function",47),i=r.controls));var a;r.interactions!==void 0&&(Array.isArray(r.interactions)?a=new $t(r.interactions.slice()):(H(typeof r.interactions.getArray=="function",48),a=r.interactions));var o;return r.overlays!==void 0?Array.isArray(r.overlays)?o=new $t(r.overlays.slice()):(H(typeof r.overlays.getArray=="function",49),o=r.overlays):o=new $t,{controls:i,interactions:a,keyboardEventTarget:e,overlays:o,values:t}}const bf=Pf;var Lf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Nf=function(r){Lf(e,r);function e(t){var n=r.call(this)||this,i=t.element;return i&&!t.target&&!i.style.pointerEvents&&(i.style.pointerEvents="auto"),n.element=i||null,n.target_=null,n.map_=null,n.listenerKeys=[],t.render&&(n.render=t.render),t.target&&n.setTarget(t.target),n}return e.prototype.disposeInternal=function(){Si(this.element),r.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Si(this.element);for(var n=0,i=this.listenerKeys.length;n<i;++n)at(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=t,t){var a=this.target_?this.target_:t.getOverlayContainerStopEvent();a.appendChild(this.element),this.render!==Ir&&this.listenerKeys.push(K(t,de.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(ue);const ha=Nf;var Df=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gf=function(r){Df(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this,n.ulElement_=document.createElement("ul"),n.collapsed_=i.collapsed!==void 0?i.collapsed:!0,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=i.collapsible!==void 0,n.collapsible_=i.collapsible!==void 0?i.collapsible:!0,n.collapsible_||(n.collapsed_=!1);var a=i.className!==void 0?i.className:"ol-attribution",o=i.tipLabel!==void 0?i.tipLabel:"Attributions",s=i.expandClassName!==void 0?i.expandClassName:a+"-expand",h=i.collapseLabel!==void 0?i.collapseLabel:"\u203A",l=i.collapseClassName!==void 0?i.collapseClassName:a+"-collapse";typeof h=="string"?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=h,n.collapseLabel_.className=l):n.collapseLabel_=h;var u=i.label!==void 0?i.label:"i";typeof u=="string"?(n.label_=document.createElement("span"),n.label_.textContent=u,n.label_.className=s):n.label_=u;var c=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_;n.toggleButton_=document.createElement("button"),n.toggleButton_.setAttribute("type","button"),n.toggleButton_.setAttribute("aria-expanded",String(!n.collapsed_)),n.toggleButton_.title=o,n.toggleButton_.appendChild(c),n.toggleButton_.addEventListener(G.CLICK,n.handleClick_.bind(n),!1);var f=a+" "+$n+" "+ea+(n.collapsed_&&n.collapsible_?" "+oo:"")+(n.collapsible_?"":" ol-uncollapsible"),v=n.element;return v.className=f,v.appendChild(n.toggleButton_),v.appendChild(n.ulElement_),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return e.prototype.collectSourceAttributions_=function(t){for(var n={},i=[],a=!0,o=t.layerStatesArray,s=0,h=o.length;s<h;++s){var l=o[s];if(!!Cn(l,t.viewState)){var u=l.layer.getSource();if(!!u){var c=u.getAttributions();if(!!c){var f=c(t);if(!!f)if(a=a&&u.getAttributionsCollapsible()!==!1,Array.isArray(f))for(var v=0,d=f.length;v<d;++v)f[v]in n||(i.push(f[v]),n[f[v]]=!0);else f in n||(i.push(f),n[f]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(a),i},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var n=this.collectSourceAttributions_(t),i=n.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!es(n,this.renderedAttributions_)){mc(this.ulElement_);for(var a=0,o=n.length;a<o;++a){var s=document.createElement("li");s.innerHTML=n[a],this.ulElement_.appendChild(s)}this.renderedAttributions_=n}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(oo),this.collapsed_?ao(this.collapseLabel_,this.label_):ao(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(ha);const Ff=Gf;var Uf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bf=function(r){Uf(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this;var a=i.className!==void 0?i.className:"ol-rotate",o=i.label!==void 0?i.label:"\u21E7",s=i.compassClassName!==void 0?i.compassClassName:"ol-compass";n.label_=null,typeof o=="string"?(n.label_=document.createElement("span"),n.label_.className=s,n.label_.textContent=o):(n.label_=o,n.label_.classList.add(s));var h=i.tipLabel?i.tipLabel:"Reset rotation",l=document.createElement("button");l.className=a+"-reset",l.setAttribute("type","button"),l.title=h,l.appendChild(n.label_),l.addEventListener(G.CLICK,n.handleClick_.bind(n),!1);var u=a+" "+$n+" "+ea,c=n.element;return c.className=u,c.appendChild(l),n.callResetNorth_=i.resetNorth?i.resetNorth:void 0,n.duration_=i.duration!==void 0?i.duration:250,n.autoHide_=i.autoHide!==void 0?i.autoHide:!0,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(nn),n}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),n=t.getView();if(!!n){var i=n.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:fr}):n.setRotation(0))}},e.prototype.render=function(t){var n=t.frameState;if(!!n){var i=n.viewState.rotation;if(i!=this.rotation_){var a="rotate("+i+"rad)";if(this.autoHide_){var o=this.element.classList.contains(nn);!o&&i===0?this.element.classList.add(nn):o&&i!==0&&this.element.classList.remove(nn)}this.label_.style.transform=a}this.rotation_=i}},e}(ha);const jf=Bf;var Xf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zf=function(r){Xf(e,r);function e(t){var n=this,i=t||{};n=r.call(this,{element:document.createElement("div"),target:i.target})||this;var a=i.className!==void 0?i.className:"ol-zoom",o=i.delta!==void 0?i.delta:1,s=i.zoomInClassName!==void 0?i.zoomInClassName:a+"-in",h=i.zoomOutClassName!==void 0?i.zoomOutClassName:a+"-out",l=i.zoomInLabel!==void 0?i.zoomInLabel:"+",u=i.zoomOutLabel!==void 0?i.zoomOutLabel:"\u2013",c=i.zoomInTipLabel!==void 0?i.zoomInTipLabel:"Zoom in",f=i.zoomOutTipLabel!==void 0?i.zoomOutTipLabel:"Zoom out",v=document.createElement("button");v.className=s,v.setAttribute("type","button"),v.title=c,v.appendChild(typeof l=="string"?document.createTextNode(l):l),v.addEventListener(G.CLICK,n.handleClick_.bind(n,o),!1);var d=document.createElement("button");d.className=h,d.setAttribute("type","button"),d.title=f,d.appendChild(typeof u=="string"?document.createTextNode(u):u),d.addEventListener(G.CLICK,n.handleClick_.bind(n,-o),!1);var p=a+" "+$n+" "+ea,g=n.element;return g.className=p,g.appendChild(v),g.appendChild(d),n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleClick_=function(t,n){n.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var n=this.getMap(),i=n.getView();if(!!i){var a=i.getZoom();if(a!==void 0){var o=i.getConstrainedZoom(a+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:o,duration:this.duration_,easing:fr})):i.setZoom(o)}}},e}(ha);const kf=zf;function $f(r){var e=r||{},t=new $t,n=e.zoom!==void 0?e.zoom:!0;n&&t.push(new kf(e.zoomOptions));var i=e.rotate!==void 0?e.rotate:!0;i&&t.push(new jf(e.rotateOptions));var a=e.attribution!==void 0?e.attribution:!0;return a&&t.push(new Ff(e.attributionOptions)),t}const fo={ACTIVE:"active"};var Kf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),qf=function(r){Kf(e,r);function e(t){var n=r.call(this)||this;return n.on,n.once,n.un,t&&t.handleEvent&&(n.handleEvent=t.handleEvent),n.map_=null,n.setActive(!0),n}return e.prototype.getActive=function(){return this.get(fo.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(fo.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(ue);function Vf(r,e,t){var n=r.getCenterInternal();if(n){var i=[n[0]+e[0],n[1]+e[1]];r.animateInternal({duration:t!==void 0?t:250,easing:Xc,center:r.getConstrainedCenter(i)})}}function la(r,e,t,n){var i=r.getZoom();if(i!==void 0){var a=r.getConstrainedZoom(i+e),o=r.getResolutionForZoom(a);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:o,anchor:t,duration:n!==void 0?n:250,easing:fr})}}const zr=qf;var Hf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zf=function(r){Hf(e,r);function e(t){var n=r.call(this)||this,i=t||{};return n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==nt.DBLCLICK){var i=t.originalEvent,a=t.map,o=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_,h=a.getView();la(h,s,o,this.duration_),i.preventDefault(),n=!0}return!n},e}(zr);const Yf=Zf;var Wf=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qf=function(r){Wf(e,r);function e(t){var n=this,i=t||{};return n=r.call(this,i)||this,i.handleDownEvent&&(n.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(n.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(n.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(n.handleUpEvent=i.handleUpEvent),i.stopDown&&(n.stopDown=i.stopDown),n.handlingDownUpSequence=!1,n.targetPointers=[],n}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var n=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==nt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==nt.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==nt.POINTERDOWN){var a=this.handleDownEvent(t);this.handlingDownUpSequence=a,n=this.stopDown(a)}else t.type==nt.POINTERMOVE&&this.handleMoveEvent(t);return!n},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){t.activePointers&&(this.targetPointers=t.activePointers)},e}(zr);function ua(r){for(var e=r.length,t=0,n=0,i=0;i<e;i++)t+=r[i].clientX,n+=r[i].clientY;return[t/e,n/e]}const kr=Qf;function bi(r){var e=arguments;return function(t){for(var n=!0,i=0,a=e.length;i<a&&(n=n&&e[i](t),!!n);++i);return n}}var Jf=function(r){var e=r.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},tv=function(r){var e=r.map.getTargetElement(),t=r.map.getOwnerDocument().activeElement;return e.contains(t)},zs=function(r){return r.map.getTargetElement().hasAttribute("tabindex")?tv(r):!0},ev=wr,ks=function(r){var e=r.originalEvent;return e.button==0&&!(ql&&Vl&&e.ctrlKey)},$s=function(r){var e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},rv=function(r){var e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Ks=function(r){var e=r.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},ni=function(r){var e=r.originalEvent;return H(e!==void 0,56),e.pointerType=="mouse"},nv=function(r){var e=r.originalEvent;return H(e!==void 0,56),e.isPrimary&&e.button===0},iv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),av=function(r){iv(e,r);function e(t){var n=r.call(this,{stopDown:Un})||this,i=t||{};n.kinetic_=i.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var a=i.condition?i.condition:bi($s,nv);return n.condition_=i.onFocusOnly?bi(zs,a):a,n.noKinetic_=!1,n}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,i=ua(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var a=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],o=t.map,s=o.getView();wu(a,s.getResolution()),Yi(a,s.getRotation()),s.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var n=t.map,i=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var a=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),s=i.getCenterInternal(),h=n.getPixelFromCoordinateInternal(s),l=n.getCoordinateFromPixelInternal([h[0]-a*Math.cos(o),h[1]-a*Math.sin(o)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:fr})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var n=t.map,i=n.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(kr);const ov=av;var sv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hv=function(r){sv(e,r);function e(t){var n=this,i=t||{};return n=r.call(this,{stopDown:Un})||this,n.condition_=i.condition?i.condition:Jf,n.lastAngle_=void 0,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleDragEvent=function(t){if(!!ni(t)){var n=t.map,i=n.getView();if(i.getConstraints().rotation!==sa){var a=n.getSize(),o=t.pixel,s=Math.atan2(a[1]/2-o[1],o[0]-a[0]/2);if(this.lastAngle_!==void 0){var h=s-this.lastAngle_;i.adjustRotationInternal(-h)}this.lastAngle_=s}}},e.prototype.handleUpEvent=function(t){if(!ni(t))return!0;var n=t.map,i=n.getView();return i.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!ni(t))return!1;if(ks(t)&&this.condition_(t)){var n=t.map;return n.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(kr);const lv=hv;var uv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cv=function(r){uv(e,r);function e(t){var n=r.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+t,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,n=this.endPixel_,i="px",a=this.element_.style;a.left=Math.min(t[0],n[0])+i,a.top=Math.min(t[1],n[1])+i,a.width=Math.abs(n[0]-t[0])+i,a.height=Math.abs(n[1]-t[1])+i},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,n){this.startPixel_=t,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,n=this.endPixel_,i=[t,[t[0],n[1]],n,[n[0],t[1]]],a=i.map(this.map_.getCoordinateFromPixelInternal,this.map_);a[4]=a[0].slice(),this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new Ps([a])},e.prototype.getGeometry=function(){return this.geometry_},e}(Fn);const fv=cv;var qs=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),on={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},ii=function(r){qs(e,r);function e(t,n,i){var a=r.call(this,t)||this;return a.coordinate=n,a.mapBrowserEvent=i,a}return e}(Me),vv=function(r){qs(e,r);function e(t){var n=r.call(this)||this;n.on,n.once,n.un;var i=t||{};return n.box_=new fv(i.className||"ol-dragbox"),n.minArea_=i.minArea!==void 0?i.minArea:64,i.onBoxEnd&&(n.onBoxEnd=i.onBoxEnd),n.startPixel_=null,n.condition_=i.condition?i.condition:ks,n.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:n.defaultBoxEndCondition,n}return e.prototype.defaultBoxEndCondition=function(t,n,i){var a=i[0]-n[0],o=i[1]-n[1];return a*a+o*o>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ii(on.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var n=this.boxEndCondition_(t,this.startPixel_,t.pixel);return n&&this.onBoxEnd(t),this.dispatchEvent(new ii(n?on.BOXEND:on.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ii(on.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(kr);const dv=vv;var pv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),gv=function(r){pv(e,r);function e(t){var n=this,i=t||{},a=i.condition?i.condition:rv;return n=r.call(this,{condition:a,className:i.className||"ol-dragzoom",minArea:i.minArea})||this,n.duration_=i.duration!==void 0?i.duration:200,n.out_=i.out!==void 0?i.out:!1,n}return e.prototype.onBoxEnd=function(t){var n=this.getMap(),i=n.getView(),a=this.getGeometry();if(this.out_){var o=i.rotatedExtentForGeometry(a),s=i.getResolutionForExtentInternal(o),h=i.getResolution()/s;a=a.clone(),a.scale(h*h)}i.fitInternal(a,{duration:this.duration_,easing:fr})},e}(dv);const _v=gv,Ae={LEFT:37,UP:38,RIGHT:39,DOWN:40};var yv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mv=function(r){yv(e,r);function e(t){var n=r.call(this)||this,i=t||{};return n.defaultCondition_=function(a){return $s(a)&&Ks(a)},n.condition_=i.condition!==void 0?i.condition:n.defaultCondition_,n.duration_=i.duration!==void 0?i.duration:100,n.pixelDelta_=i.pixelDelta!==void 0?i.pixelDelta:128,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==G.KEYDOWN){var i=t.originalEvent,a=i.keyCode;if(this.condition_(t)&&(a==Ae.DOWN||a==Ae.LEFT||a==Ae.RIGHT||a==Ae.UP)){var o=t.map,s=o.getView(),h=s.getResolution()*this.pixelDelta_,l=0,u=0;a==Ae.DOWN?u=-h:a==Ae.LEFT?l=-h:a==Ae.RIGHT?l=h:u=h;var c=[l,u];Yi(c,s.getRotation()),Vf(s,c,this.duration_),i.preventDefault(),n=!0}}return!n},e}(zr);const Ev=mv;var Tv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Mv=function(r){Tv(e,r);function e(t){var n=r.call(this)||this,i=t||{};return n.condition_=i.condition?i.condition:Ks,n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:100,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==G.KEYDOWN||t.type==G.KEYPRESS){var i=t.originalEvent,a=i.charCode;if(this.condition_(t)&&(a=="+".charCodeAt(0)||a=="-".charCodeAt(0))){var o=t.map,s=a=="+".charCodeAt(0)?this.delta_:-this.delta_,h=o.getView();la(h,s,void 0,this.duration_),i.preventDefault(),n=!0}}return!n},e}(zr);const xv=Mv;var Rv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ai={TRACKPAD:"trackpad",WHEEL:"wheel"},wv=function(r){Rv(e,r);function e(t){var n=this,i=t||{};n=r.call(this,i)||this,n.totalDelta_=0,n.lastDelta_=0,n.maxDelta_=i.maxDelta!==void 0?i.maxDelta:1,n.duration_=i.duration!==void 0?i.duration:250,n.timeout_=i.timeout!==void 0?i.timeout:80,n.useAnchor_=i.useAnchor!==void 0?i.useAnchor:!0,n.constrainResolution_=i.constrainResolution!==void 0?i.constrainResolution:!1;var a=i.condition?i.condition:ev;return n.condition_=i.onFocusOnly?bi(zs,a):a,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();if(!!t){var n=t.getView();n.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var n=t.type;if(n!==G.WHEEL)return!0;var i=t.map,a=t.originalEvent;a.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var o;if(t.type==G.WHEEL&&(o=a.deltaY,kl&&a.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(o/=as),a.deltaMode===WheelEvent.DOM_DELTA_LINE&&(o*=40)),o===0)return!1;this.lastDelta_=o;var s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(o)<4?ai.TRACKPAD:ai.WHEEL);var h=i.getView();if(this.mode_===ai.TRACKPAD&&!(h.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-o/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=o;var l=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1},e.prototype.handleWheelZoom_=function(t){var n=t.getView();n.getAnimating()&&n.cancelAnimations();var i=-ot(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),la(n,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(zr);const Cv=wv;var Av=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ov=function(r){Av(e,r);function e(t){var n=this,i=t||{},a=i;return a.stopDown||(a.stopDown=Un),n=r.call(this,a)||this,n.anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=i.threshold!==void 0?i.threshold:.3,n.duration_=i.duration!==void 0?i.duration:250,n}return e.prototype.handleDragEvent=function(t){var n=0,i=this.targetPointers[0],a=this.targetPointers[1],o=Math.atan2(a.clientY-i.clientY,a.clientX-i.clientX);if(this.lastAngle_!==void 0){var s=o-this.lastAngle_;this.rotationDelta_+=s,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=s}this.lastAngle_=o;var h=t.map,l=h.getView();if(l.getConstraints().rotation!==sa){var u=h.getViewport().getBoundingClientRect(),c=ua(this.targetPointers);c[0]-=u.left,c[1]-=u.top,this.anchor_=h.getCoordinateFromPixelInternal(c),this.rotating_&&(h.render(),l.adjustRotationInternal(n,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,i=n.getView();return i.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(kr);const Sv=Ov;var Pv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Iv=function(r){Pv(e,r);function e(t){var n=this,i=t||{},a=i;return a.stopDown||(a.stopDown=Un),n=r.call(this,a)||this,n.anchor_=null,n.duration_=i.duration!==void 0?i.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return e.prototype.handleDragEvent=function(t){var n=1,i=this.targetPointers[0],a=this.targetPointers[1],o=i.clientX-a.clientX,s=i.clientY-a.clientY,h=Math.sqrt(o*o+s*s);this.lastDistance_!==void 0&&(n=this.lastDistance_/h),this.lastDistance_=h;var l=t.map,u=l.getView();n!=1&&(this.lastScaleDelta_=n);var c=l.getViewport().getBoundingClientRect(),f=ua(this.targetPointers);f[0]-=c.left,f[1]-=c.top,this.anchor_=l.getCoordinateFromPixelInternal(f),l.render(),u.adjustResolutionInternal(n,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,i=n.getView(),a=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,a),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(kr);const bv=Iv;function Lv(r){var e=r||{},t=new $t,n=new Hc(-.005,.05,100),i=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;i&&t.push(new lv);var a=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;a&&t.push(new Yf({delta:e.zoomDelta,duration:e.zoomDuration}));var o=e.dragPan!==void 0?e.dragPan:!0;o&&t.push(new ov({onFocusOnly:e.onFocusOnly,kinetic:n}));var s=e.pinchRotate!==void 0?e.pinchRotate:!0;s&&t.push(new Sv);var h=e.pinchZoom!==void 0?e.pinchZoom:!0;h&&t.push(new bv({duration:e.zoomDuration}));var l=e.keyboard!==void 0?e.keyboard:!0;l&&(t.push(new Ev),t.push(new xv({delta:e.zoomDelta,duration:e.zoomDuration})));var u=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;u&&t.push(new Cv({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var c=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return c&&t.push(new _v({duration:e.zoomDuration})),t}var Nv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Dv=function(r){Nv(e,r);function e(t){return t=ut({},t),t.controls||(t.controls=$f()),t.interactions||(t.interactions=Lv({onFocusOnly:!0})),r.call(this,t)||this}return e.prototype.createRenderer=function(){return new ef(this)},e}(bf);const Gv=Dv;var Fv=function(){function r(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return r.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},r.prototype.expireCache=function(e){for(;this.canExpireCache();)this.pop()},r.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},r.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},r.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},r.prototype.get=function(e,t){var n=this.entries_[e];return H(n!==void 0,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_},r.prototype.remove=function(e){var t=this.entries_[e];return H(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},r.prototype.getCount=function(){return this.count_},r.prototype.getKeys=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e},r.prototype.getValues=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e},r.prototype.peekLast=function(){return this.oldest_.value_},r.prototype.peekLastKey=function(){return this.oldest_.key_},r.prototype.peekFirstKey=function(){return this.newest_.key_},r.prototype.peek=function(e){if(!!this.containsKey(e))return this.entries_[e].value_},r.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},r.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},r.prototype.set=function(e,t){H(!(e in this.entries_),16);var n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},r.prototype.setSize=function(e){this.highWaterMark=e},r}();const Vs=Fv;function On(r,e,t,n){return n!==void 0?(n[0]=r,n[1]=e,n[2]=t,n):[r,e,t]}function $r(r,e,t){return r+"/"+e+"/"+t}function Dr(r){return $r(r[0],r[1],r[2])}function Uv(r){return r.split("/").map(Number)}function Bv(r){return(r[1]<<r[0])+r[2]}function jv(r,e){var t=r[0],n=r[1],i=r[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;var a=e.getFullTileRange(t);return a?a.containsXY(n,i):!0}var Xv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zv=function(r){Xv(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.expireCache=function(t){for(;this.canExpireCache();){var n=this.peekLast();if(n.getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=this.peekFirstKey(),n=Uv(t),i=n[0];this.forEach(function(a){a.tileCoord[0]!==i&&(this.remove(Dr(a.tileCoord)),a.release())}.bind(this))}},e}(Vs);const Hs=zv;var Zs=function(){function r(e,t,n,i){this.minX=e,this.maxX=t,this.minY=n,this.maxY=i}return r.prototype.contains=function(e){return this.containsXY(e[1],e[2])},r.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},r.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY},r.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},r.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},r.prototype.getHeight=function(){return this.maxY-this.minY+1},r.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},r.prototype.getWidth=function(){return this.maxX-this.minX+1},r.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},r}();function Fe(r,e,t,n,i){return i!==void 0?(i.minX=r,i.maxX=e,i.minY=t,i.maxY=n,i):new Zs(r,e,t,n)}const Ys=Zs,sn={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var kv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$v=function(r){kv(e,r);function e(t){var n=this,i=t||{},a=ut({},i);return delete a.preload,delete a.useInterimTilesOnError,n=r.call(this,a)||this,n.on,n.once,n.un,n.setPreload(i.preload!==void 0?i.preload:0),n.setUseInterimTilesOnError(i.useInterimTilesOnError!==void 0?i.useInterimTilesOnError:!0),n}return e.prototype.getPreload=function(){return this.get(sn.PRELOAD)},e.prototype.setPreload=function(t){this.set(sn.PRELOAD,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(sn.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(t){this.set(sn.USE_INTERIM_TILES_ON_ERROR,t)},e.prototype.getData=function(t){return r.prototype.getData.call(this,t)},e}(ra);const Kv=$v;var qv=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vv=function(r){qv(e,r);function e(t){var n=this,i=b.IDLE;return n=r.call(this,t.tileCoord,i,{transition:t.transition,interpolate:t.interpolate})||this,n.loader_=t.loader,n.data_=null,n.error_=null,n.size_=t.size||[256,256],n}return e.prototype.getSize=function(){return this.size_},e.prototype.getData=function(){return this.data_},e.prototype.getError=function(){return this.error_},e.prototype.load=function(){if(!(this.state!==b.IDLE&&this.state!==b.ERROR)){this.state=b.LOADING,this.changed();var t=this;this.loader_().then(function(n){t.data_=n,t.state=b.LOADED,t.changed()}).catch(function(n){t.error_=n,t.state=b.ERROR,t.changed()})}},e}(na);const Ws=Vv;var Hv=.5,ie=!0,Zv=10,vo=.25,Yv=function(){function r(e,t,n,i,a,o){this.sourceProj_=e,this.targetProj_=t;var s={},h=Rn(this.targetProj_,this.sourceProj_);this.transformInv_=function(m){var E=m[0]+"/"+m[1];return s[E]||(s[E]=h(m)),s[E]},this.maxSourceExtent_=i,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&lt(i)==lt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?lt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?lt(this.targetProj_.getExtent()):null;var l=jr(n),u=Hi(n),c=Vi(n),f=qi(n),v=this.transformInv_(l),d=this.transformInv_(u),p=this.transformInv_(c),g=this.transformInv_(f),y=Zv+(o?Math.max(0,Math.ceil(fs(xi(n)/(o*o*256*256)))):0);if(this.addQuad_(l,u,c,f,v,d,p,g,y),this.wrapsXInSource_){var _=1/0;this.triangles_.forEach(function(m,E,T){_=Math.min(_,m.source[0][0],m.source[1][0],m.source[2][0])}),this.triangles_.forEach(function(m){if(Math.max(m.source[0][0],m.source[1][0],m.source[2][0])-_>this.sourceWorldWidth_/2){var E=[[m.source[0][0],m.source[0][1]],[m.source[1][0],m.source[1][1]],[m.source[2][0],m.source[2][1]]];E[0][0]-_>this.sourceWorldWidth_/2&&(E[0][0]-=this.sourceWorldWidth_),E[1][0]-_>this.sourceWorldWidth_/2&&(E[1][0]-=this.sourceWorldWidth_),E[2][0]-_>this.sourceWorldWidth_/2&&(E[2][0]-=this.sourceWorldWidth_);var T=Math.min(E[0][0],E[1][0],E[2][0]),M=Math.max(E[0][0],E[1][0],E[2][0]);M-T<this.sourceWorldWidth_/2&&(m.source=E)}}.bind(this))}s={}}return r.prototype.addTriangle_=function(e,t,n,i,a,o){this.triangles_.push({source:[i,a,o],target:[e,t,n]})},r.prototype.addQuad_=function(e,t,n,i,a,o,s,h,l){var u=Mi([a,o,s,h]),c=this.sourceWorldWidth_?lt(u)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,v=this.sourceProj_.canWrapX()&&c>.5&&c<1,d=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var p=Mi([e,t,n,i]),g=lt(p)/this.targetWorldWidth_;d=g>vo||d}!v&&this.sourceProj_.isGlobal()&&c&&(d=c>vo||d)}if(!(!d&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!Zi(u,this.maxSourceExtent_))){var y=0;if(!d&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(h[0])||!isFinite(h[1]))){if(l>0)d=!0;else if(y=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(s[0])||!isFinite(s[1])?2:0)+(!isFinite(h[0])||!isFinite(h[1])?1:0),y!=1&&y!=2&&y!=4&&y!=8)return}if(l>0){if(!d){var _=[(e[0]+n[0])/2,(e[1]+n[1])/2],m=this.transformInv_(_),E=void 0;if(v){var T=(We(a[0],f)+We(s[0],f))/2;E=T-We(m[0],f)}else E=(a[0]+s[0])/2-m[0];var M=(a[1]+s[1])/2-m[1],R=E*E+M*M;d=R>this.errorThresholdSquared_}if(d){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){var w=[(t[0]+n[0])/2,(t[1]+n[1])/2],S=this.transformInv_(w),L=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(L);this.addQuad_(e,t,w,L,a,o,S,I,l-1),this.addQuad_(L,w,n,i,I,S,s,h,l-1)}else{var j=[(e[0]+t[0])/2,(e[1]+t[1])/2],q=this.transformInv_(j),Y=[(n[0]+i[0])/2,(n[1]+i[1])/2],B=this.transformInv_(Y);this.addQuad_(e,j,Y,i,a,q,B,h,l-1),this.addQuad_(j,t,n,Y,q,o,s,B,l-1)}return}}if(v){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(y&11)==0&&this.addTriangle_(e,n,i,a,s,h),(y&14)==0&&this.addTriangle_(e,n,t,a,s,o),y&&((y&13)==0&&this.addTriangle_(t,i,e,o,h,a),(y&7)==0&&this.addTriangle_(t,i,n,o,h,s))}},r.prototype.calculateSourceExtent=function(){var e=cr();return this.triangles_.forEach(function(t,n,i){var a=t.source;vn(e,a[0]),vn(e,a[1]),vn(e,a[2])}),e},r.prototype.getTriangles=function(){return this.triangles_},r}();const Wv=Yv;var po={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},oi,Qs=[];function go(r,e,t,n,i){r.beginPath(),r.moveTo(0,0),r.lineTo(e,t),r.lineTo(n,i),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(e,n)+1,Math.max(t,i)),r.restore()}function si(r,e){return Math.abs(r[e*4]-210)>2||Math.abs(r[e*4+3]-.75*255)>2}function Qv(){if(oi===void 0){var r=document.createElement("canvas").getContext("2d");r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",go(r,4,5,4,0),go(r,4,5,0,5);var e=r.getImageData(0,0,3,3).data;oi=si(e,0)||si(e,4)||si(e,8)}return oi}function _o(r,e,t,n){var i=ms(t,e,r),a=Ha(e,n,t),o=e.getMetersPerUnit();o!==void 0&&(a*=o);var s=r.getMetersPerUnit();s!==void 0&&(a/=s);var h=r.getExtent();if(!h||Lr(h,i)){var l=Ha(r,a,i)/a;isFinite(l)&&l>0&&(a/=l)}return a}function Jv(r,e,t,n){var i=ir(t),a=_o(r,e,i,n);return(!isFinite(a)||a<=0)&&cs(t,function(o){return a=_o(r,e,o,n),isFinite(a)&&a>0}),a}function t0(r,e,t,n,i,a,o,s,h,l,u,c){var f=Oi(Math.round(t*r),Math.round(t*e),Qs);if(c||ut(f,po),h.length===0)return f.canvas;f.scale(t,t);function v(E){return Math.round(E*t)/t}f.globalCompositeOperation="lighter";var d=cr();h.forEach(function(E,T,M){nu(d,E.extent)});var p=lt(d),g=qt(d),y=Oi(Math.round(t*p/n),Math.round(t*g/n));c||ut(y,po);var _=t/n;h.forEach(function(E,T,M){var R=E.extent[0]-d[0],w=-(E.extent[3]-d[3]),S=lt(E.extent),L=qt(E.extent);E.image.width>0&&E.image.height>0&&y.drawImage(E.image,l,l,E.image.width-2*l,E.image.height-2*l,R*_,w*_,S*_,L*_)});var m=jr(o);return s.getTriangles().forEach(function(E,T,M){var R=E.source,w=E.target,S=R[0][0],L=R[0][1],I=R[1][0],j=R[1][1],q=R[2][0],Y=R[2][1],B=v((w[0][0]-m[0])/a),tt=v(-(w[0][1]-m[1])/a),et=v((w[1][0]-m[0])/a),V=v(-(w[1][1]-m[1])/a),W=v((w[2][0]-m[0])/a),Z=v(-(w[2][1]-m[1])/a),ht=S,Pt=L;S=0,L=0,I-=ht,j-=Pt,q-=ht,Y-=Pt;var It=[[I,j,0,0,et-B],[q,Y,0,0,W-B],[0,0,I,j,V-tt],[0,0,q,Y,Z-tt]],Tt=fu(It);if(!!Tt){if(f.save(),f.beginPath(),Qv()||!c){f.moveTo(et,V);for(var ft=4,Nt=B-et,Vt=tt-V,yt=0;yt<ft;yt++)f.lineTo(et+v((yt+1)*Nt/ft),V+v(yt*Vt/(ft-1))),yt!=ft-1&&f.lineTo(et+v((yt+1)*Nt/ft),V+v((yt+1)*Vt/(ft-1)));f.lineTo(W,Z)}else f.moveTo(et,V),f.lineTo(B,tt),f.lineTo(W,Z);f.clip(),f.transform(Tt[0],Tt[2],Tt[1],Tt[3],B,tt),f.translate(d[0]-ht,d[3]-Pt),f.scale(n/t,-n/t),f.drawImage(y.canvas,0,0),f.restore()}}),u&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,s.getTriangles().forEach(function(E,T,M){var R=E.target,w=(R[0][0]-m[0])/a,S=-(R[0][1]-m[1])/a,L=(R[1][0]-m[0])/a,I=-(R[1][1]-m[1])/a,j=(R[2][0]-m[0])/a,q=-(R[2][1]-m[1])/a;f.beginPath(),f.moveTo(L,I),f.lineTo(w,S),f.lineTo(j,q),f.closePath(),f.stroke()}),f.restore()),f.canvas}var e0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),r0=function(r){e0(e,r);function e(t,n,i,a,o,s,h,l,u,c,f,v){var d=r.call(this,o,b.IDLE,{interpolate:!!v})||this;d.renderEdges_=f!==void 0?f:!1,d.pixelRatio_=h,d.gutter_=l,d.canvas_=null,d.sourceTileGrid_=n,d.targetTileGrid_=a,d.wrappedTileCoord_=s||o,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var p=a.getTileCoordExtent(d.wrappedTileCoord_),g=d.targetTileGrid_.getExtent(),y=d.sourceTileGrid_.getExtent(),_=g?_e(p,g):p;if(xi(_)===0)return d.state=b.EMPTY,d;var m=t.getExtent();m&&(y?y=_e(y,m):y=m);var E=a.getResolution(d.wrappedTileCoord_[0]),T=Jv(t,i,_,E);if(!isFinite(T)||T<=0)return d.state=b.EMPTY,d;var M=c!==void 0?c:Hv;if(d.triangulation_=new Wv(t,i,_,y,T*M,E),d.triangulation_.getTriangles().length===0)return d.state=b.EMPTY,d;d.sourceZ_=n.getZForResolution(T);var R=d.triangulation_.calculateSourceExtent();if(y&&(t.canWrapX()?(R[1]=ot(R[1],y[1],y[3]),R[3]=ot(R[3],y[1],y[3])):R=_e(R,y)),!xi(R))d.state=b.EMPTY;else{for(var w=n.getTileRangeForExtentAndZ(R,d.sourceZ_),S=w.minX;S<=w.maxX;S++)for(var L=w.minY;L<=w.maxY;L++){var I=u(d.sourceZ_,S,L,h);I&&d.sourceTiles_.push(I)}d.sourceTiles_.length===0&&(d.state=b.EMPTY)}return d}return e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(u,c,f){u&&u.getState()==b.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(u.tileCoord),image:u.getImage()})}.bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=b.ERROR;else{var n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),a=typeof i=="number"?i:i[0],o=typeof i=="number"?i:i[1],s=this.targetTileGrid_.getResolution(n),h=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=t0(a,o,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),s,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=b.LOADED}this.changed()},e.prototype.load=function(){if(this.state==b.IDLE){this.state=b.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n,i,a){var o=n.getState();if(o==b.IDLE||o==b.LOADING){t++;var s=K(n,G.CHANGE,function(h){var l=n.getState();(l==b.LOADED||l==b.ERROR||l==b.EMPTY)&&(at(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}.bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(n,i,a){var o=n.getState();o==b.IDLE&&n.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(at),this.sourcesListenerKeys_=null},e.prototype.release=function(){this.canvas_&&(yc(this.canvas_.getContext("2d")),Qs.push(this.canvas_),this.canvas_=null),r.prototype.release.call(this)},e}(na);const Js=r0;var ca=34962,fa=34963,n0=35040,va=35044,i0=35048,a0=5121,o0=5123,s0=5125,th=5126,yo=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function eh(r,e){for(var t=ut({preserveDrawingBuffer:!0,antialias:!Kl},e),n=yo.length,i=0;i<n;++i)try{var a=r.getContext(yo[i],t);if(a)return a}catch{}return null}var h0={STATIC_DRAW:va,STREAM_DRAW:n0,DYNAMIC_DRAW:i0},l0=function(){function r(e,t){this.array=null,this.type=e,H(e===ca||e===fa,62),this.usage=t!==void 0?t:h0.STATIC_DRAW}return r.prototype.ofSize=function(e){this.array=new(hi(this.type))(e)},r.prototype.fromArray=function(e){var t=hi(this.type);this.array=t.from?t.from(e):new t(e)},r.prototype.fromArrayBuffer=function(e){this.array=new(hi(this.type))(e)},r.prototype.getType=function(){return this.type},r.prototype.getArray=function(){return this.array},r.prototype.getUsage=function(){return this.usage},r.prototype.getSize=function(){return this.array?this.array.length:0},r}();function hi(r){switch(r){case ca:return Float32Array;case fa:return Uint32Array;default:return Float32Array}}const rh=l0;var u0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function nh(r,e,t){var n=t?r.LINEAR:r.NEAREST;r.bindTexture(r.TEXTURE_2D,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n)}function c0(r,e,t,n){nh(r,e,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)}function mo(r,e,t,n,i,a){var o=r.getGL(),s,h;if(t instanceof Float32Array){s=o.FLOAT,r.getExtension("OES_texture_float");var l=r.getExtension("OES_texture_float_linear");h=l!==null}else s=o.UNSIGNED_BYTE,h=!0;nh(o,e,a&&h);var u=t.byteLength/n[1],c=1;u%8===0?c=8:u%4===0?c=4:u%2===0&&(c=2);var f;switch(i){case 1:{f=o.LUMINANCE;break}case 2:{f=o.LUMINANCE_ALPHA;break}case 3:{f=o.RGB;break}case 4:{f=o.RGBA;break}default:throw new Error("Unsupported number of bands: ".concat(i))}var v=o.getParameter(o.UNPACK_ALIGNMENT);o.pixelStorei(o.UNPACK_ALIGNMENT,c),o.texImage2D(o.TEXTURE_2D,0,f,n[0],n[1],0,f,s,t),o.pixelStorei(o.UNPACK_ALIGNMENT,v)}var ze=null;function f0(){var r=document.createElement("canvas");r.width=1,r.height=1,ze=r.getContext("2d")}var v0=function(r){u0(e,r);function e(t){var n=r.call(this)||this;n.tile,n.textures=[],n.handleTileChange_=n.handleTileChange_.bind(n),n.renderSize_=Ct(t.grid.getTileSize(t.tile.tileCoord[0])),n.gutter_=t.gutter||0,n.bandCount=NaN,n.helper_=t.helper;var i=new rh(ca,va);return i.fromArray([0,1,1,1,1,0,0,0]),n.helper_.flushBufferData(i),n.coords=i,n.setTile(t.tile),n}return e.prototype.setTile=function(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(G.CHANGE,this.handleTileChange_),this.tile=t,this.textures.length=0,this.loaded=t.getState()===b.LOADED,this.loaded)this.uploadTile_();else{if(t instanceof Pi){var n=t.getImage();n instanceof Image&&!n.crossOrigin&&(n.crossOrigin="anonymous")}t.addEventListener(G.CHANGE,this.handleTileChange_)}},e.prototype.uploadTile_=function(){var t=this.helper_,n=t.getGL(),i=this.tile;if(i instanceof Pi||i instanceof Js){var a=n.createTexture();this.textures.push(a),this.bandCount=4,c0(n,a,i.getImage(),i.interpolate);return}var o=i.getSize(),s=[o[0]+2*this.gutter_,o[1]+2*this.gutter_],h=i.getData(),l=h instanceof Float32Array,u=s[0]*s[1],c=l?Float32Array:Uint8Array,f=c.BYTES_PER_ELEMENT,v=h.byteLength/s[1];this.bandCount=Math.floor(v/f/s[0]);var d=Math.ceil(this.bandCount/4);if(d===1){var a=n.createTexture();this.textures.push(a),mo(t,a,h,s,this.bandCount,i.interpolate);return}for(var p=new Array(d),g=0;g<d;++g){var a=n.createTexture();this.textures.push(a);var y=g<d-1?4:this.bandCount%4;p[g]=new c(u*y)}for(var _=0,m=0,E=s[0]*this.bandCount,T=0;T<s[1];++T){for(var M=0;M<E;++M){var R=h[m+M],w=Math.floor(_/this.bandCount),S=M%this.bandCount,g=Math.floor(S/4),L=p[g],y=L.length/u,I=S%4;L[w*y+I]=R,++_}m+=v/f}for(var g=0;g<d;++g){var a=this.textures[g],L=p[g],y=L.length/u;mo(t,a,L,s,y,i.interpolate)}},e.prototype.handleTileChange_=function(){this.tile.getState()===b.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(G.CHANGE))},e.prototype.disposeInternal=function(){var t=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var n=0;n<this.textures.length;++n)t.deleteTexture(this.textures[n]);this.tile.removeEventListener(G.CHANGE,this.handleTileChange_)},e.prototype.getPixelData=function(t,n){if(!this.loaded)return null;var i=this.renderSize_[0],a=this.renderSize_[1],o=this.gutter_;if(this.tile instanceof Ws){var s=this.tile.getSize(),h=s[0],l=s[1],u=h+2*o,c=l+2*o,f=o+Math.floor(h*(t/i)),v=o+Math.floor(l*(n/a)),d=this.tile.getData();if(d instanceof DataView){var p=d.byteLength/(u*c),g=p*(v*u+f),y=d.buffer.slice(g,g+p);return new DataView(y)}var _=this.bandCount*(v*u+f);return d.slice(_,_+this.bandCount)}ze||f0(),ze.clearRect(0,0,1,1);var m=this.tile.getImage(),E=m.width,T=m.height,M=E-2*o,R=T-2*o,w=o+Math.floor(M*(t/i)),S=o+Math.floor(R*(n/a)),L;try{ze.drawImage(m,w,S,1,1,0,0,1,1),L=ze.getImageData(0,0,1,1).data}catch{return ze=null,null}return L},e}(ur);const d0=v0,hn={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};var p0=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,g0=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`,_0=function(){function r(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e.vertexShader||p0),t.compileShader(n);var i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,e.fragmentShader||g0),t.compileShader(i),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,n),t.attachShader(this.renderTargetProgram_,i),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();var a=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(o){this.uniforms_.push({value:e.uniforms[o],location:t.getUniformLocation(this.renderTargetProgram_,o)})}.bind(this))}return r.prototype.getGL=function(){return this.gl_},r.prototype.init=function(e){var t=this.getGL(),n=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;var i=0,a=t.RGBA,o=0,s=t.RGBA,h=t.UNSIGNED_BYTE,l=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,i,a,n[0],n[1],o,s,h,l),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},r.prototype.apply=function(e,t,n,i){var a=this.getGL(),o=e.size;if(a.bindFramebuffer(a.FRAMEBUFFER,t?t.getFrameBuffer():null),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.renderTargetTexture_),!t){var s=At(a.canvas);if(!e.renderTargets[s]){var h=a.getContextAttributes();h&&h.preserveDrawingBuffer&&(a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)),e.renderTargets[s]=!0}}a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.bindBuffer(a.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),a.useProgram(this.renderTargetProgram_),a.enableVertexAttribArray(this.renderTargetAttribLocation_),a.vertexAttribPointer(this.renderTargetAttribLocation_,2,a.FLOAT,!1,0,0),a.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),a.uniform1i(this.renderTargetTextureLocation_,0);var l=e.layerStatesArray[e.layerIndex].opacity;a.uniform1f(this.renderTargetOpacityLocation_,l),this.applyUniforms(e),n&&n(a,e),a.drawArrays(a.TRIANGLES,0,6),i&&i(a,e)},r.prototype.getFrameBuffer=function(){return this.frameBuffer_},r.prototype.applyUniforms=function(e){var t=this.getGL(),n,i=1;this.uniforms_.forEach(function(a){if(n=typeof a.value=="function"?a.value(e):a.value,n instanceof HTMLCanvasElement||n instanceof ImageData)a.texture||(a.texture=t.createTexture()),t.activeTexture(t["TEXTURE".concat(i)]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,n.width,n.height,0,t.UNSIGNED_BYTE,new Uint8Array(n.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.uniform1i(a.location,i++);else if(Array.isArray(n))switch(n.length){case 2:t.uniform2f(a.location,n[0],n[1]);return;case 3:t.uniform3f(a.location,n[0],n[1],n[2]);return;case 4:t.uniform4f(a.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&t.uniform1f(a.location,n)})},r}();const Eo=_0;function ih(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function gn(r,e){return r[0]=e[0],r[1]=e[1],r[4]=e[2],r[5]=e[3],r[12]=e[4],r[13]=e[5],r}var y0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_r={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},Er={UNSIGNED_BYTE:a0,UNSIGNED_SHORT:o0,UNSIGNED_INT:s0,FLOAT:th},Sn={};function To(r){return"shared/"+r}var Mo=0;function m0(){var r="unique/"+Mo;return Mo+=1,r}function E0(r){var e=Sn[r];if(!e){var t=document.createElement("canvas");t.style.position="absolute",t.style.left="0",e={users:0,canvas:t},Sn[r]=e}return e.users+=1,e.canvas}function T0(r){var e=Sn[r];if(!!e&&(e.users-=1,!(e.users>0))){var t=e.canvas,n=eh(t),i=n.getExtension("WEBGL_lose_context");i&&i.loseContext(),delete Sn[r]}}var M0=function(r){y0(e,r);function e(t){var n=r.call(this)||this,i=t||{};n.boundHandleWebGLContextLost_=n.handleWebGLContextLost.bind(n),n.boundHandleWebGLContextRestored_=n.handleWebGLContextRestored.bind(n),n.canvasCacheKey_=i.canvasCacheKey?To(i.canvasCacheKey):m0(),n.canvas_=E0(n.canvasCacheKey_),n.gl_=eh(n.canvas_),n.bufferCache_={},n.extensionCache_={},n.currentProgram_=null,n.canvas_.addEventListener(hn.LOST,n.boundHandleWebGLContextLost_),n.canvas_.addEventListener(hn.RESTORED,n.boundHandleWebGLContextRestored_),n.offsetRotateMatrix_=Ie(),n.offsetScaleMatrix_=Ie(),n.tmpMat4_=ih(),n.uniformLocations_={},n.attribLocations_={},n.uniforms_=[],i.uniforms&&n.setUniforms(i.uniforms);var a=n.getGL();return n.postProcessPasses_=i.postProcesses?i.postProcesses.map(function(o){return new Eo({webGlContext:a,scaleRatio:o.scaleRatio,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,uniforms:o.uniforms})}):[new Eo({webGlContext:a})],n.shaderCompileErrors_=null,n.startTime_=Date.now(),n}return e.prototype.setUniforms=function(t){this.uniforms_=[];for(var n in t)this.uniforms_.push({name:n,value:t[n]});this.uniformLocations_={}},e.prototype.canvasCacheKeyMatches=function(t){return this.canvasCacheKey_===To(t)},e.prototype.getExtension=function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var n=this.gl_.getExtension(t);return this.extensionCache_[t]=n,n},e.prototype.bindBuffer=function(t){var n=this.getGL(),i=At(t),a=this.bufferCache_[i];if(!a){var o=n.createBuffer();a={buffer:t,webGlBuffer:o},this.bufferCache_[i]=a}n.bindBuffer(t.getType(),a.webGlBuffer)},e.prototype.flushBufferData=function(t){var n=this.getGL();this.bindBuffer(t),n.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var n=this.getGL(),i=At(t),a=this.bufferCache_[i];a&&!n.isContextLost()&&n.deleteBuffer(a.webGlBuffer),delete this.bufferCache_[i]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(hn.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(hn.RESTORED,this.boundHandleWebGLContextRestored_),T0(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},e.prototype.prepareDraw=function(t,n){var i=this.getGL(),a=this.getCanvas(),o=t.size,s=t.pixelRatio;a.width=o[0]*s,a.height=o[1]*s,a.style.width=o[0]+"px",a.style.height=o[1]+"px",i.useProgram(this.currentProgram_);for(var h=this.postProcessPasses_.length-1;h>=0;h--)this.postProcessPasses_[h].init(t);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,n,i){var a=this.getGL(),o=n.getSize();a.bindFramebuffer(a.FRAMEBUFFER,n.getFramebuffer()),a.viewport(0,0,o[0],o[1]),a.bindTexture(a.TEXTURE_2D,n.getTexture()),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.enable(a.BLEND),a.blendFunc(a.ONE,i?a.ZERO:a.ONE_MINUS_SRC_ALPHA),a.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,n){var i=this.getGL();this.getExtension("OES_element_index_uint");var a=i.UNSIGNED_INT,o=4,s=n-t,h=t*o;i.drawElements(i.TRIANGLES,s,a,h)},e.prototype.finalizeDraw=function(t,n,i){for(var a=0,o=this.postProcessPasses_.length;a<o;a++)a===o-1?this.postProcessPasses_[a].apply(t,null,n,i):this.postProcessPasses_[a].apply(t,this.postProcessPasses_[a+1])},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var n=t.size,i=t.viewState.rotation,a=fn(this.offsetScaleMatrix_);Ti(a,2/n[0],2/n[1]);var o=fn(this.offsetRotateMatrix_);i!==0&&ss(o,-i),this.setUniformMatrixValue(_r.OFFSET_SCALE_MATRIX,gn(this.tmpMat4_,a)),this.setUniformMatrixValue(_r.OFFSET_ROTATION_MATRIX,gn(this.tmpMat4_,o)),this.setUniformFloatValue(_r.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(_r.ZOOM,t.viewState.zoom),this.setUniformFloatValue(_r.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var n=this.getGL(),i,a=0;this.uniforms_.forEach(function(o){if(i=typeof o.value=="function"?o.value(t):o.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData){o.texture||(o.prevValue=void 0,o.texture=n.createTexture()),n.activeTexture(n["TEXTURE".concat(a)]),n.bindTexture(n.TEXTURE_2D,o.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var s=!(i instanceof HTMLImageElement)||i.complete;s&&o.prevValue!==i&&(o.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),n.uniform1i(this.getUniformLocation(o.name),a++)}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(o.name,gn(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:n.uniform2f(this.getUniformLocation(o.name),i[0],i[1]);return;case 3:n.uniform3f(this.getUniformLocation(o.name),i[0],i[1],i[2]);return;case 4:n.uniform4f(this.getUniformLocation(o.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(this.getUniformLocation(o.name),i)}.bind(this))},e.prototype.useProgram=function(t){if(t==this.currentProgram_)return!1;var n=this.getGL();return n.useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0},e.prototype.compileShader=function(t,n){var i=this.getGL(),a=i.createShader(n);return i.shaderSource(a,t),i.compileShader(a),a},e.prototype.getProgram=function(t,n){var i=this.getGL(),a=this.compileShader(t,i.FRAGMENT_SHADER),o=this.compileShader(n,i.VERTEX_SHADER),s=i.createProgram();if(i.attachShader(s,a),i.attachShader(s,o),i.linkProgram(s),!i.getShaderParameter(a,i.COMPILE_STATUS)){var h="Fragment shader compliation failed: ".concat(i.getShaderInfoLog(a));throw new Error(h)}if(i.deleteShader(a),!i.getShaderParameter(o,i.COMPILE_STATUS)){var h="Vertex shader compilation failed: ".concat(i.getShaderInfoLog(o));throw new Error(h)}if(i.deleteShader(o),!i.getProgramParameter(s,i.LINK_STATUS)){var h="GL program linking failed: ".concat(i.getShaderInfoLog(o));throw new Error(h)}return s},e.prototype.getUniformLocation=function(t){return this.uniformLocations_[t]===void 0&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return this.attribLocations_[t]===void 0&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,n){var i=t.size,a=t.viewState.rotation,o=t.viewState.resolution,s=t.viewState.center;return fn(n),Xn(n,0,0,2/(o*i[0]),2/(o*i[1]),-a,-s[0],-s[1]),n},e.prototype.setUniformFloatValue=function(t,n){this.getGL().uniform1f(this.getUniformLocation(t),n)},e.prototype.setUniformFloatVec4=function(t,n){this.getGL().uniform4fv(this.getUniformLocation(t),n)},e.prototype.setUniformMatrixValue=function(t,n){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,n)},e.prototype.enableAttributeArray_=function(t,n,i,a,o){var s=this.getAttributeLocation(t);s<0||(this.getGL().enableVertexAttribArray(s),this.getGL().vertexAttribPointer(s,n,i,!1,a,o))},e.prototype.enableAttributes=function(t){for(var n=x0(t),i=0,a=0;a<t.length;a++){var o=t[a];this.enableAttributeArray_(o.name,o.size,o.type||th,n,i),i+=o.size*ah(o.type)}},e.prototype.handleWebGLContextLost=function(){Br(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,n,i){var a=this.getGL(),o=i||a.createTexture(),s=0,h=a.RGBA,l=0,u=a.RGBA,c=a.UNSIGNED_BYTE;return a.bindTexture(a.TEXTURE_2D,o),n?a.texImage2D(a.TEXTURE_2D,s,h,u,c,n):a.texImage2D(a.TEXTURE_2D,s,h,t[0],t[1],l,u,c,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),o},e}(Fn);function x0(r){for(var e=0,t=0;t<r.length;t++){var n=r[t];e+=n.size*ah(n.type)}return e}function ah(r){switch(r){case Er.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Er.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Er.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Er.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var R0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),w0=function(r){R0(e,r);function e(t,n){var i=r.call(this,t)||this,a=n||{};return i.inversePixelTransform_=Ie(),i.pixelContext_=null,i.postProcesses_=a.postProcesses,i.uniforms_=a.uniforms,i.helper,t.addChangeListener(z.MAP,i.removeHelper.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return e.prototype.dispatchPreComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Bt.PRECOMPOSE)){var a=new pn(Bt.PRECOMPOSE,void 0,n,t);i.dispatchEvent(a)}},e.prototype.dispatchPostComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Bt.POSTCOMPOSE)){var a=new pn(Bt.POSTCOMPOSE,void 0,n,t);i.dispatchEvent(a)}},e.prototype.reset=function(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},e.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},e.prototype.prepareFrame=function(t){if(this.getLayer().getRenderSource()){for(var n=!0,i=-1,a=void 0,o=0,s=t.layerStatesArray.length;o<s;o++){var h=t.layerStatesArray[o].layer,l=h.getRenderer();if(!(l instanceof e)){n=!0;continue}var u=h.getClassName();if((n||u!==a)&&(i+=1,n=!1),a=u,l===this)break}var c="map/"+t.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(c))&&(this.removeHelper(),this.helper=new M0({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:c}),a&&(this.helper.getCanvas().className=a),this.afterHelperCreated())}return this.prepareFrameInternal(t)},e.prototype.afterHelperCreated=function(){},e.prototype.prepareFrameInternal=function(t){return!0},e.prototype.disposeInternal=function(){this.removeHelper(),r.prototype.disposeInternal.call(this)},e.prototype.dispatchRenderEvent_=function(t,n,i){var a=this.getLayer();if(a.hasListener(t)){Xn(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);var o=new pn(t,this.inversePixelTransform_,i,n);a.dispatchEvent(o)}},e.prototype.preRender=function(t,n){this.dispatchRenderEvent_(Bt.PRERENDER,t,n)},e.prototype.postRender=function(t,n){this.dispatchRenderEvent_(Bt.POSTRENDER,t,n)},e.prototype.getDataAtPixel=function(t,n,i){var a=br([n.pixelRatio,0,0,n.pixelRatio,0,0],t.slice()),o=this.helper.getGL();if(!o)return null;var s=this.getLayer(),h=s.getExtent();if(h){var l=br(n.pixelToCoordinateTransform,t.slice());if(!Lr(h,l))return null}var u=o.getContextAttributes();if(!u||!u.preserveDrawingBuffer)return new Uint8Array;var c=Math.round(a[0]),f=Math.round(a[1]),v=this.pixelContext_;if(!v){var d=document.createElement("canvas");d.width=1,d.height=1,v=d.getContext("2d"),this.pixelContext_=v}v.clearRect(0,0,1,1);var p;try{v.drawImage(o.canvas,c,f,1,1,0,0,1,1),p=v.getImageData(0,0,1,1).data}catch{return p}return p[3]===0?null:p},e}(Sc);const C0=w0;var A0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),D={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},_n={TEXTURE_COORD:"a_textureCoord"},O0=[{name:_n.TEXTURE_COORD,size:2,type:Er.FLOAT}],S0={};function P0(r){return 2*(1-1/(r+1))-1}function xo(r,e,t){t in r||(r[t]=[]),r[t].push(e)}function li(r,e){var t=r.layerStatesArray[r.layerIndex];t.extent&&(e=_e(e,Ke(t.extent,r.viewState.projection)));var n=t.layer.getRenderSource();if(!n.getWrapX()){var i=n.getTileGridForProjection(r.viewState.projection).getExtent();i&&(e=_e(e,i))}return e}function ui(r,e){return"".concat(r.getKey(),",").concat(Dr(e))}var I0=function(r){A0(e,r);function e(t,n){var i=r.call(this,t,{uniforms:n.uniforms})||this;i.renderComplete=!1,i.tileTransform_=Ie(),i.tempMat4_=ih(),i.tempTileRange_=new Ys(0,0,0,0),i.tempTileCoord_=On(0,0,0),i.tempSize_=[0,0],i.program_,i.vertexShader_=n.vertexShader,i.fragmentShader_=n.fragmentShader,i.indices_=new rh(fa,va),i.indices_.fromArray([0,1,3,1,2,3]);var a=n.cacheSize!==void 0?n.cacheSize:512;return i.tileTextureCache_=new Vs(a),i.paletteTextures_=n.paletteTextures||[],i.frameState_=null,i}return e.prototype.reset=function(t){r.prototype.reset.call(this,{uniforms:t.uniforms}),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))},e.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)},e.prototype.isDrawableTile_=function(t){var n=this.getLayer(),i=t.getState(),a=n.getUseInterimTilesOnError();return i==b.LOADED||i==b.EMPTY||i==b.ERROR&&!a},e.prototype.prepareFrameInternal=function(t){var n=this.getLayer(),i=n.getRenderSource();return!i||kn(li(t,t.extent))?!1:i.getState()==="ready"},e.prototype.enqueueTiles=function(t,n,i,a){var o=t.viewState,s=this.getLayer(),h=s.getRenderSource(),l=h.getTileGridForProjection(o.projection),u=h.getGutterForProjection(o.projection),c=At(h);c in t.wantedTiles||(t.wantedTiles[c]={});for(var f=t.wantedTiles[c],v=this.tileTextureCache_,d=Math.max(i-s.getPreload(),l.getMinZoom(),s.getMinZoom()),p=i;p>=d;--p)for(var g=l.getTileRangeForExtentAndZ(n,p,this.tempTileRange_),y=l.getResolution(p),_=g.minX;_<=g.maxX;++_)for(var m=g.minY;m<=g.maxY;++m){var E=On(p,_,m,this.tempTileCoord_),T=ui(h,E),M=void 0,R=void 0;if(v.containsKey(T)&&(M=v.get(T),R=M.tile),!M||M.tile.key!==h.getKey())if(R=h.getTile(p,_,m,t.pixelRatio,o.projection),!M)M=new d0({tile:R,grid:l,helper:this.helper,gutter:u}),v.set(T,M);else if(this.isDrawableTile_(R))M.setTile(R);else{var w=R.getInterimTile();M.setTile(w)}xo(a,M,p);var S=R.getKey();f[S]=!0,R.getState()===b.IDLE&&(t.tileQueue.isKeyQueued(S)||t.tileQueue.enqueue([R,c,l.getTileCoordCenter(E),y]))}},e.prototype.renderFrame=function(t){this.frameState_=t,this.renderComplete=!0;var n=this.helper.getGL();this.preRender(n,t);var i=t.viewState,a=this.getLayer(),o=a.getRenderSource(),s=o.getTileGridForProjection(i.projection),h=o.getGutterForProjection(i.projection),l=li(t,t.extent),u=s.getZForResolution(i.resolution,o.zDirection),c={};if(t.nextExtent){var f=s.getZForResolution(i.nextResolution,o.zDirection),v=li(t,t.nextExtent);this.enqueueTiles(t,v,f,c)}this.enqueueTiles(t,l,u,c);for(var d={},p=At(this),g=t.time,y=!1,_=c[u],m=0,E=_.length;m<E;++m){var T=_[m],M=T.tile,R=M.tileCoord;if(T.loaded){var w=M.getAlpha(p,g);if(w===1){M.endTransition(p);continue}y=!0;var S=Dr(R);d[S]=w}this.renderComplete=!1;var L=this.findAltTiles_(s,R,u+1,c);if(!L)for(var I=s.getMinZoom(),j=u-1;j>=I;--j){var q=this.findAltTiles_(s,R,j,c);if(q)break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(t,!y);for(var Y=Object.keys(c).map(Number).sort(zi),B=i.center[0],tt=i.center[1],et=0,V=Y.length;et<V;++et)for(var W=Y[et],Z=s.getResolution(W),ht=Ct(s.getTileSize(W),this.tempSize_),Pt=s.getOrigin(W),It=ht[0]+2*h,Tt=ht[1]+2*h,ft=It/Tt,Nt=(B-Pt[0])/(ht[0]*Z),Vt=(Pt[1]-tt)/(ht[1]*Z),yt=i.resolution/Z,re=P0(W),Da=c[W],m=0,E=Da.length;m<E;++m){var T=Da[m];if(!!T.loaded){var M=T.tile,R=M.tileCoord,S=Dr(R),Wr=R[1],Ga=R[2];fn(this.tileTransform_),Ti(this.tileTransform_,2/(t.size[0]*yt/It),-2/(t.size[1]*yt/It)),ss(this.tileTransform_,i.rotation),Ti(this.tileTransform_,1,1/ft),Yl(this.tileTransform_,(ht[0]*(Wr-Nt)-h)/It,(ht[1]*(Ga-Vt)-h)/Tt),this.helper.setUniformMatrixValue(D.TILE_TRANSFORM,gn(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(T.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(O0);for(var ne=0;ne<T.textures.length;){var _l="TEXTURE"+ne,yl="".concat(D.TILE_TEXTURE_ARRAY,"[").concat(ne,"]");n.activeTexture(n[_l]),n.bindTexture(n.TEXTURE_2D,T.textures[ne]),n.uniform1i(this.helper.getUniformLocation(yl),ne),++ne}for(var Jn=0;Jn<this.paletteTextures_.length;++Jn){var Fa=this.paletteTextures_[Jn];n.activeTexture(n["TEXTURE"+ne]);var ml=Fa.getTexture(n);n.bindTexture(n.TEXTURE_2D,ml),n.uniform1i(this.helper.getUniformLocation(Fa.name),ne),++ne}var w=S in d?d[S]:1;w<1&&(t.animate=!0),this.helper.setUniformFloatValue(D.TRANSITION_ALPHA,w),this.helper.setUniformFloatValue(D.DEPTH,re),this.helper.setUniformFloatValue(D.TEXTURE_PIXEL_WIDTH,It),this.helper.setUniformFloatValue(D.TEXTURE_PIXEL_HEIGHT,Tt),this.helper.setUniformFloatValue(D.TEXTURE_RESOLUTION,Z),this.helper.setUniformFloatValue(D.TEXTURE_ORIGIN_X,Pt[0]+Wr*ht[0]*Z-h*Z),this.helper.setUniformFloatValue(D.TEXTURE_ORIGIN_Y,Pt[1]-Ga*ht[1]*Z+h*Z);var Qr=l;h>0&&(Qr=s.getTileCoordExtent(R),_e(Qr,l,Qr)),this.helper.setUniformFloatVec4(D.RENDER_EXTENT,Qr),this.helper.setUniformFloatValue(D.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(D.ZOOM,i.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var El=this.helper.getCanvas(),Ua=this.tileTextureCache_;Ua.canExpireCache();){var T=Ua.pop();T.dispose()}var Tl=function(B1,Ml){o.expireCache(Ml.viewState.projection,S0)};return t.postRenderFunctions.push(Tl),this.postRender(n,t),El},e.prototype.getData=function(t){var n=this.helper.getGL();if(!n)return null;var i=this.frameState_;if(!i)return null;var a=this.getLayer(),o=br(i.pixelToCoordinateTransform,t.slice()),s=i.viewState,h=a.getExtent();if(h&&!Lr(Ke(h,s.projection),o))return null;var l=a.getSources(Mi([o]),s.resolution),u,c,f;for(u=l.length-1;u>=0;--u)if(c=l[u],c.getState()==="ready"){if(f=c.getTileGridForProjection(s.projection),c.getWrapX())break;var v=f.getExtent();if(!v||Lr(v,o))break}if(u<0)return null;for(var d=this.tileTextureCache_,p=f.getZForResolution(s.resolution);p>=f.getMinZoom();--p){var g=f.getTileCoordForCoordAndZ(o,p),y=ui(c,g);if(!!d.containsKey(y)){var _=d.get(y);if(!!_.loaded){var m=f.getOrigin(p),E=Ct(f.getTileSize(p)),T=f.getResolution(p),M=(o[0]-m[0])/T-g[1]*E[0],R=(m[1]-o[1])/T-g[2]*E[1];return _.getPixelData(M,R)}}}return null},e.prototype.findAltTiles_=function(t,n,i,a){var o=t.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!o)return!1;for(var s=!0,h=this.tileTextureCache_,l=this.getLayer().getRenderSource(),u=o.minX;u<=o.maxX;++u)for(var c=o.minY;c<=o.maxY;++c){var f=ui(l,[i,u,c]),v=!1;if(h.containsKey(f)){var d=h.get(f);d.loaded&&(xo(a,d,i),v=!0)}v||(s=!1)}return s},e.prototype.removeHelper=function(){if(this.helper){var t=this.tileTextureCache_;t.forEach(function(n){return n.dispose()}),t.clear()}r.prototype.removeHelper.call(this)},e.prototype.disposeInternal=function(){var t=this.helper;if(t){var n=t.getGL();n.deleteProgram(this.program_),delete this.program_,t.deleteBuffer(this.indices_)}r.prototype.disposeInternal.call(this),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_},e}(C0);const b0=I0;var L0=function(){function r(e,t){this.name=e,this.data=t,this.texture_=null}return r.prototype.getTexture=function(e){if(!this.texture_){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_},r}();const N0=L0;var A={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},U={};function te(r){if(typeof r=="number")return A.NUMBER;if(typeof r=="boolean")return A.BOOLEAN;if(typeof r=="string")return _c(r)?A.COLOR|A.STRING:A.STRING;if(!Array.isArray(r))throw new Error("Unhandled value type: ".concat(JSON.stringify(r)));var e=r,t=e.every(function(i){return typeof i=="number"});if(t)return e.length===3||e.length===4?A.COLOR|A.NUMBER_ARRAY:A.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(e)));var n=U[e[0]];if(n===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return n.getReturnType(e.slice(1))}function D0(r){return fs(r)%1===0}function qn(r){var e=r.toString();return e.indexOf(".")===-1?e+".0":e}function oh(r){if(r.length<2||r.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(r.length,"(").concat(r.map(qn).join(", "),")")}function G0(r){var e=dc(r).slice();return e.length<4&&e.push(1),oh(e.map(function(t,n){return n<3?t/255:t}))}function sh(r,e){return r.stringLiteralsMap[e]===void 0&&(r.stringLiteralsMap[e]=Object.keys(r.stringLiteralsMap).length),r.stringLiteralsMap[e]}function F0(r,e){return qn(sh(r,e))}function P(r,e,t){if(Array.isArray(e)&&typeof e[0]=="string"){var n=U[e[0]];if(n===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return n.toGlsl(r,e.slice(1),t)}var i=te(e);if((i&A.NUMBER)>0)return qn(e);if((i&A.BOOLEAN)>0)return e.toString();if((i&A.STRING)>0&&(t===void 0||t==A.STRING))return F0(r,e.toString());if((i&A.COLOR)>0&&(t===void 0||t==A.COLOR))return G0(e);if((i&A.NUMBER_ARRAY)>0)return oh(e);throw new Error("Unexpected expression ".concat(e," (expected type ").concat(t,")"))}function hh(r){if(!(te(r)&A.NUMBER))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(r)," instead"))}function st(r){for(var e=0;e<r.length;e++)hh(r[e])}function lh(r){if(!(te(r)&A.STRING))throw new Error("A string value was expected, got ".concat(JSON.stringify(r)," instead"))}function da(r){if(!(te(r)&A.BOOLEAN))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(r)," instead"))}function J(r,e){if(r.length!==e)throw new Error("Exactly ".concat(e," arguments were expected, got ").concat(r.length," instead"))}function xe(r,e){if(r.length<e)throw new Error("At least ".concat(e," arguments were expected, got ").concat(r.length," instead"))}function Vn(r,e){if(r.length>e)throw new Error("At most ".concat(e," arguments were expected, got ").concat(r.length," instead"))}function uh(r){if(r.length%2!==0)throw new Error("An even amount of arguments was expected, got ".concat(r," instead"))}function U0(r){if(r.length%2===0)throw new Error("An odd amount of arguments was expected, got ".concat(r," instead"))}function pa(r,e){if(!D0(e))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(r)))}U.get={getReturnType:function(r){return A.ANY},toGlsl:function(r,e){J(e,1),lh(e[0]);var t=e[0].toString();r.attributes.indexOf(t)===-1&&r.attributes.push(t);var n=r.inFragmentShader?"v_":"a_";return n+t}};function ch(r){return"u_var_"+r}U.var={getReturnType:function(r){return A.ANY},toGlsl:function(r,e){J(e,1),lh(e[0]);var t=e[0].toString();return r.variables.indexOf(t)===-1&&r.variables.push(t),ch(t)}};var fh="u_paletteTextures";U.palette={getReturnType:function(r){return A.COLOR},toGlsl:function(r,e){J(e,2),hh(e[0]);var t=P(r,e[0]),n=e[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");for(var i=n.length,a=new Uint8Array(i*4),o=0;o<i;o++){var s=n[o],h=void 0;if(typeof s=="string")h=Ns(s);else{if(!Array.isArray(s))throw new Error("The second argument of palette must be an array of strings or colors");var l=s.length;if(l===4)h=s;else{if(l!==3)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(l));h=[s[0],s[1],s[2],1]}}var u=o*4;a[u]=h[0],a[u+1]=h[1],a[u+2]=h[2],a[u+3]=h[3]*255}r.paletteTextures||(r.paletteTextures=[]);var c="".concat(fh,"[").concat(r.paletteTextures.length,"]"),f=new N0(c,a);return r.paletteTextures.push(f),"texture2D(".concat(c,", vec2((").concat(t," + 0.5) / ").concat(i,".0, 0.5))")}};var ci="getBandValue";U.band={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){xe(e,1),Vn(e,3);var t=e[0];if(!(ci in r.functions)){for(var n="",i=r.bandCount||1,a=0;a<i;a++){var o=Math.floor(a/4),s=a%4;s===i-1&&s===1&&(s=3);var h="".concat(D.TILE_TEXTURE_ARRAY,"[").concat(o,"]");n+=`
          if (band == `.concat(a+1,`.0) {
            return texture2D(`).concat(h,", v_textureCoord + vec2(dx, dy))[").concat(s,`];
          }
        `)}r.functions[ci]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / `.concat(D.TEXTURE_PIXEL_WIDTH,`;
          float dy = yOffset / `).concat(D.TEXTURE_PIXEL_HEIGHT,`;
          `).concat(n,`
        }
      `)}var l=P(r,t),u=P(r,e[1]||0),c=P(r,e[2]||0);return"".concat(ci,"(").concat(l,", ").concat(u,", ").concat(c,")")}};U.time={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,0),"u_time"}};U.zoom={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,0),"u_zoom"}};U.resolution={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,0),"u_resolution"}};U["*"]={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," * ").concat(P(r,e[1]),")")}};U["/"]={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," / ").concat(P(r,e[1]),")")}};U["+"]={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," + ").concat(P(r,e[1]),")")}};U["-"]={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," - ").concat(P(r,e[1]),")")}};U.clamp={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){J(e,3),st(e);var t=P(r,e[1]),n=P(r,e[2]);return"clamp(".concat(P(r,e[0]),", ").concat(t,", ").concat(n,")")}};U["%"]={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,2),st(e),"mod(".concat(P(r,e[0]),", ").concat(P(r,e[1]),")")}};U["^"]={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,2),st(e),"pow(".concat(P(r,e[0]),", ").concat(P(r,e[1]),")")}};U.abs={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,1),st(e),"abs(".concat(P(r,e[0]),")")}};U.floor={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,1),st(e),"floor(".concat(P(r,e[0]),")")}};U.round={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,1),st(e),"floor(".concat(P(r,e[0])," + 0.5)")}};U.ceil={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,1),st(e),"ceil(".concat(P(r,e[0]),")")}};U.sin={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,1),st(e),"sin(".concat(P(r,e[0]),")")}};U.cos={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return J(e,1),st(e),"cos(".concat(P(r,e[0]),")")}};U.atan={getReturnType:function(r){return A.NUMBER},toGlsl:function(r,e){return xe(e,1),Vn(e,2),st(e),e.length===2?"atan(".concat(P(r,e[0]),", ").concat(P(r,e[1]),")"):"atan(".concat(P(r,e[0]),")")}};U[">"]={getReturnType:function(r){return A.BOOLEAN},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," > ").concat(P(r,e[1]),")")}};U[">="]={getReturnType:function(r){return A.BOOLEAN},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," >= ").concat(P(r,e[1]),")")}};U["<"]={getReturnType:function(r){return A.BOOLEAN},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," < ").concat(P(r,e[1]),")")}};U["<="]={getReturnType:function(r){return A.BOOLEAN},toGlsl:function(r,e){return J(e,2),st(e),"(".concat(P(r,e[0])," <= ").concat(P(r,e[1]),")")}};function vh(r){return{getReturnType:function(e){return A.BOOLEAN},toGlsl:function(e,t){J(t,2);for(var n=A.ANY,i=0;i<t.length;i++)n&=te(t[i]);if(n===A.NONE)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(t)," instead"));return n&=~A.COLOR,"(".concat(P(e,t[0],n)," ").concat(r," ").concat(P(e,t[1],n),")")}}}U["=="]=vh("==");U["!="]=vh("!=");U["!"]={getReturnType:function(r){return A.BOOLEAN},toGlsl:function(r,e){return J(e,1),da(e[0]),"(!".concat(P(r,e[0]),")")}};function dh(r){return{getReturnType:function(e){return A.BOOLEAN},toGlsl:function(e,t){xe(t,2);for(var n=0;n<t.length;n++)da(t[n]);var i="";return i=t.map(function(a){return P(e,a)}).join(" ".concat(r," ")),i="(".concat(i,")"),i}}}U.all=dh("&&");U.any=dh("||");U.between={getReturnType:function(r){return A.BOOLEAN},toGlsl:function(r,e){J(e,3),st(e);var t=P(r,e[1]),n=P(r,e[2]),i=P(r,e[0]);return"(".concat(i," >= ").concat(t," && ").concat(i," <= ").concat(n,")")}};U.array={getReturnType:function(r){return A.NUMBER_ARRAY},toGlsl:function(r,e){xe(e,2),Vn(e,4),st(e);var t=e.map(function(n){return P(r,n,A.NUMBER)});return"vec".concat(e.length,"(").concat(t.join(", "),")")}};U.color={getReturnType:function(r){return A.COLOR},toGlsl:function(r,e){xe(e,3),Vn(e,4),st(e);var t=e;e.length===3&&t.push(1);var n=e.map(function(i,a){return P(r,i,A.NUMBER)+(a<3?" / 255.0":"")});return"vec".concat(e.length,"(").concat(n.join(", "),")")}};U.interpolate={getReturnType:function(r){for(var e=A.COLOR|A.NUMBER,t=3;t<r.length;t+=2)e=e&te(r[t]);return e},toGlsl:function(r,e,t){uh(e),xe(e,6);var n=e[0],i;switch(n[0]){case"linear":i=1;break;case"exponential":i=n[1];break;default:i=null}if(!i)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(n)));var a=t!==void 0?t:A.ANY,o=U.interpolate.getReturnType(e)&a;pa(e,o);for(var s=P(r,e[1]),h=qn(i),l="",u=2;u<e.length-2;u+=2){var c=P(r,e[u]),f=l||P(r,e[u+1],o),v=P(r,e[u+2]),d=P(r,e[u+3],o);l="mix(".concat(f,", ").concat(d,", pow(clamp((").concat(s," - ").concat(c,") / (").concat(v," - ").concat(c,"), 0.0, 1.0), ").concat(h,"))")}return l}};U.match={getReturnType:function(r){for(var e=A.ANY,t=2;t<r.length;t+=2)e=e&te(r[t]);return e=e&te(r[r.length-1]),e},toGlsl:function(r,e,t){uh(e),xe(e,4);var n=t!==void 0?t:A.ANY,i=U.match.getReturnType(e)&n;pa(e,i);for(var a=P(r,e[0]),o=P(r,e[e.length-1],i),s=null,h=e.length-3;h>=1;h-=2){var l=P(r,e[h]),u=P(r,e[h+1],i);s="(".concat(a," == ").concat(l," ? ").concat(u," : ").concat(s||o,")")}return s}};U.case={getReturnType:function(r){for(var e=A.ANY,t=1;t<r.length;t+=2)e=e&te(r[t]);return e=e&te(r[r.length-1]),e},toGlsl:function(r,e,t){U0(e),xe(e,3);var n=t!==void 0?t:A.ANY,i=U.case.getReturnType(e)&n;pa(e,i);for(var a=0;a<e.length-1;a+=2)da(e[a]);for(var o=P(r,e[e.length-1],i),s=null,a=e.length-3;a>=0;a-=2){var h=P(r,e[a]),l=P(r,e[a+1],i);s="(".concat(h," ? ").concat(l," : ").concat(s||o,")")}return s}};var B0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function Ro(r,e){var t=`
    attribute vec2 `.concat(_n.TEXTURE_COORD,`;
    uniform mat4 `).concat(D.TILE_TRANSFORM,`;
    uniform float `).concat(D.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(D.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(D.TEXTURE_RESOLUTION,`;
    uniform float `).concat(D.TEXTURE_ORIGIN_X,`;
    uniform float `).concat(D.TEXTURE_ORIGIN_Y,`;
    uniform float `).concat(D.DEPTH,`;

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = `).concat(_n.TEXTURE_COORD,`;
      v_mapCoord = vec2(
        `).concat(D.TEXTURE_ORIGIN_X," + ").concat(D.TEXTURE_RESOLUTION," * ").concat(D.TEXTURE_PIXEL_WIDTH,` * v_textureCoord[0],
        `).concat(D.TEXTURE_ORIGIN_Y," - ").concat(D.TEXTURE_RESOLUTION," * ").concat(D.TEXTURE_PIXEL_HEIGHT,` * v_textureCoord[1]
      );
      gl_Position = `).concat(D.TILE_TRANSFORM," * vec4(").concat(_n.TEXTURE_COORD,", ").concat(D.DEPTH,`, 1.0);
    }
  `),n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},i=[];if(r.color!==void 0){var a=P(n,r.color,A.COLOR);i.push("color = ".concat(a,";"))}if(r.contrast!==void 0){var o=P(n,r.contrast,A.NUMBER);i.push("color.rgb = clamp((".concat(o," + 1.0) * color.rgb - (").concat(o," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(r.exposure!==void 0){var s=P(n,r.exposure,A.NUMBER);i.push("color.rgb = clamp((".concat(s," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(r.saturation!==void 0){var h=P(n,r.saturation,A.NUMBER);i.push(`
      float saturation = `.concat(h,` + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `))}if(r.gamma!==void 0){var l=P(n,r.gamma,A.NUMBER);i.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(l,"));"))}if(r.brightness!==void 0){var u=P(n,r.brightness,A.NUMBER);i.push("color.rgb = clamp(color.rgb + ".concat(u,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var c={},f=n.variables.length;if(f>1&&!r.variables)throw new Error("Missing variables in style (expected ".concat(n.variables,")"));for(var v=function(m){var E=n.variables[m];if(!(E in r.variables))throw new Error("Missing '".concat(E,"' in style variables"));var T=ch(E);c[T]=function(){var M=r.variables[E];return typeof M=="string"&&(M=sh(n,M)),M!==void 0?M:-9999999}},d=0;d<f;++d)v(d);var p=Object.keys(c).map(function(m){return"uniform float ".concat(m,";")}),g=Math.ceil(e/4);p.push("uniform sampler2D ".concat(D.TILE_TEXTURE_ARRAY,"[").concat(g,"];")),n.paletteTextures&&p.push("uniform sampler2D ".concat(fh,"[").concat(n.paletteTextures.length,"];"));var y=Object.keys(n.functions).map(function(m){return n.functions[m]}),_=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 `.concat(D.RENDER_EXTENT,`;
    uniform float `).concat(D.TRANSITION_ALPHA,`;
    uniform float `).concat(D.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(D.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(D.RESOLUTION,`;
    uniform float `).concat(D.ZOOM,`;

    `).concat(p.join(`
`),`

    `).concat(y.join(`
`),`

    void main() {
      if (
        v_mapCoord[0] < `).concat(D.RENDER_EXTENT,`[0] ||
        v_mapCoord[1] < `).concat(D.RENDER_EXTENT,`[1] ||
        v_mapCoord[0] > `).concat(D.RENDER_EXTENT,`[2] ||
        v_mapCoord[1] > `).concat(D.RENDER_EXTENT,`[3]
      ) {
        discard;
      }

      vec4 color = texture2D(`).concat(D.TILE_TEXTURE_ARRAY,`[0],  v_textureCoord);

      `).concat(i.join(`
`),`

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= `).concat(D.TRANSITION_ALPHA,`;
    }`);return{vertexShader:t,fragmentShader:_,uniforms:c,paletteTextures:n.paletteTextures}}var ph=function(r){B0(e,r);function e(t){var n=this,i=t?ut({},t):{},a=i.style||{};delete i.style;var o=i.cacheSize;return delete i.cacheSize,n=r.call(this,i)||this,n.sources_=i.sources,n.renderedSource_=null,n.renderedResolution_=NaN,n.style_=a,n.cacheSize_=o,n.styleVariables_=n.style_.variables||{},n.addChangeListener(z.SOURCE,n.handleSourceUpdate_),n}return e.prototype.getSources=function(t,n){var i=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(t,n):this.sources_:i?[i]:[]},e.prototype.getRenderSource=function(){return this.renderedSource_||this.getSource()},e.prototype.getSourceState=function(){var t=this.getRenderSource();return t?t.getState():"undefined"},e.prototype.handleSourceUpdate_=function(){this.getSource()&&this.setStyle(this.style_)},e.prototype.getSourceBandCount_=function(){var t=Number.MAX_SAFE_INTEGER,n=this.getSources([-t,-t,t,t],t);return n&&n.length&&"bandCount"in n[0]?n[0].bandCount:4},e.prototype.createRenderer=function(){var t=Ro(this.style_,this.getSourceBandCount_());return new b0(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.cacheSize_,paletteTextures:t.paletteTextures})},e.prototype.renderSources=function(t,n){for(var i=this.getRenderer(),a,o=0,s=n.length;o<s;++o)this.renderedSource_=n[o],i.prepareFrame(t)&&(a=i.renderFrame(t));return a},e.prototype.render=function(t,n){var i=this;this.rendered=!0;for(var a=t.viewState,o=this.getSources(t.extent,a.resolution),s=!0,h=function(v,d){var p=o[v],g=p.getState();if(g=="loading"){var y=function(){p.getState()=="ready"&&(p.removeEventListener("change",y),i.changed())};p.addEventListener("change",y)}s=s&&g=="ready"},l=0,u=o.length;l<u;++l)h(l);var c=this.renderSources(t,o);if(this.getRenderer().renderComplete&&s)return this.renderedResolution_=a.resolution,c;if(this.renderedResolution_>.5*a.resolution){var f=this.getSources(t.extent,this.renderedResolution_).filter(function(v){return!o.includes(v)});if(f.length>0)return this.renderSources(t,f)}return c},e.prototype.setStyle=function(t){this.styleVariables_=t.variables||{},this.style_=t;var n=Ro(this.style_,this.getSourceBandCount_()),i=this.getRenderer();i.reset({vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms,paletteTextures:n.paletteTextures}),this.changed()},e.prototype.updateStyleVariables=function(t){ut(this.styleVariables_,t),this.changed()},e}(Kv);ph.prototype.dispose;const gh=ph,Je={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var j0=[0,0,0],fe=5,X0=function(){function r(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,H(Il(this.resolutions_,function(o,s){return s-o},!0),17);var t;if(!e.origins){for(var n=0,i=this.resolutions_.length-1;n<i;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,H(this.origins_.length==this.resolutions_.length,20));var a=e.extent;a!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=jr(a)),H(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,H(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:ia,H(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=a!==void 0?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(o,s){var h=new Ys(Math.min(0,o[0]),Math.max(o[0]-1,-1),Math.min(0,o[1]),Math.max(o[1]-1,-1));if(a){var l=this.getTileRangeForExtentAndZ(a,s);h.minX=Math.max(l.minX,h.minX),h.maxX=Math.min(l.maxX,h.maxX),h.minY=Math.max(l.minY,h.minY),h.maxY=Math.min(l.maxY,h.maxY)}return h},this):a&&this.calculateTileRanges_(a)}return r.prototype.forEachTileCoord=function(e,t,n){for(var i=this.getTileRangeForExtentAndZ(e,t),a=i.minX,o=i.maxX;a<=o;++a)for(var s=i.minY,h=i.maxY;s<=h;++s)n([t,a,s])},r.prototype.forEachTileCoordParentTileRange=function(e,t,n,i){var a,o,s,h=null,l=e[0]-1;for(this.zoomFactor_===2?(o=e[1],s=e[2]):h=this.getTileCoordExtent(e,i);l>=this.minZoom;){if(this.zoomFactor_===2?(o=Math.floor(o/2),s=Math.floor(s/2),a=Fe(o,o,s,s,n)):a=this.getTileRangeForExtentAndZ(h,l,n),t(l,a))return!0;--l}return!1},r.prototype.getExtent=function(){return this.extent_},r.prototype.getMaxZoom=function(){return this.maxZoom},r.prototype.getMinZoom=function(){return this.minZoom},r.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},r.prototype.getResolution=function(e){return this.resolutions_[e]},r.prototype.getResolutions=function(){return this.resolutions_},r.prototype.getTileCoordChildTileRange=function(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){var i=e[1]*2,a=e[2]*2;return Fe(i,i+1,a,a+1,t)}var o=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e[0]+1,t)}return null},r.prototype.getTileRangeForTileCoordAndZ=function(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;var i=e[0],a=e[1],o=e[2];if(t===i)return Fe(a,o,a,o,n);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,t-i),h=Math.floor(a*s),l=Math.floor(o*s);if(t<i)return Fe(h,h,l,l,n);var u=Math.floor(s*(a+1))-1,c=Math.floor(s*(o+1))-1;return Fe(h,u,l,c,n)}var f=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(f,t,n)},r.prototype.getTileRangeExtent=function(e,t,n){var i=this.getOrigin(e),a=this.getResolution(e),o=Ct(this.getTileSize(e),this.tmpSize_),s=i[0]+t.minX*o[0]*a,h=i[0]+(t.maxX+1)*o[0]*a,l=i[1]+t.minY*o[1]*a,u=i[1]+(t.maxY+1)*o[1]*a;return nr(s,l,h,u,n)},r.prototype.getTileRangeForExtentAndZ=function(e,t,n){var i=j0;this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,i);var a=i[1],o=i[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,i),Fe(a,i[1],o,i[2],n)},r.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),n=this.getResolution(e[0]),i=Ct(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*n,t[1]-(e[2]+.5)*i[1]*n]},r.prototype.getTileCoordExtent=function(e,t){var n=this.getOrigin(e[0]),i=this.getResolution(e[0]),a=Ct(this.getTileSize(e[0]),this.tmpSize_),o=n[0]+e[1]*a[0]*i,s=n[1]-(e[2]+1)*a[1]*i,h=o+a[0]*i,l=s+a[1]*i;return nr(o,s,h,l,t)},r.prototype.getTileCoordForCoordAndResolution=function(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)},r.prototype.getTileCoordForXYAndResolution_=function(e,t,n,i,a){var o=this.getZForResolution(n),s=n/this.getResolution(o),h=this.getOrigin(o),l=Ct(this.getTileSize(o),this.tmpSize_),u=s*(e-h[0])/n/l[0],c=s*(h[1]-t)/n/l[1];return i?(u=en(u,fe)-1,c=en(c,fe)-1):(u=tn(u,fe),c=tn(c,fe)),On(o,u,c,a)},r.prototype.getTileCoordForXYAndZ_=function(e,t,n,i,a){var o=this.getOrigin(n),s=this.getResolution(n),h=Ct(this.getTileSize(n),this.tmpSize_),l=(e-o[0])/s/h[0],u=(o[1]-t)/s/h[1];return i?(l=en(l,fe)-1,u=en(u,fe)-1):(l=tn(l,fe),u=tn(u,fe)),On(n,l,u,a)},r.prototype.getTileCoordForCoordAndZ=function(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)},r.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},r.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},r.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null},r.prototype.getZForResolution=function(e,t){var n=ki(this.resolutions_,e,t||0);return ot(n,this.minZoom,this.maxZoom)},r.prototype.tileCoordIntersectsViewport=function(e,t){return Os(t,0,t.length,2,this.getTileCoordExtent(e))},r.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,n=new Array(t),i=this.minZoom;i<t;++i)n[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=n},r}();const Hn=X0;function _h(r){var e=r.getDefaultTileGrid();return e||(e=$0(r),r.setDefaultTileGrid(e)),e}function z0(r,e,t){var n=e[0],i=r.getTileCoordCenter(e),a=Zn(t);if(Lr(a,i))return e;var o=lt(a),s=Math.ceil((a[0]-i[0])/o);return i[0]+=o*s,r.getTileCoordForCoordAndZ(i,n)}function k0(r,e,t,n){var i=n!==void 0?n:"top-left",a=mh(r,e,t);return new Hn({extent:r,origin:au(r,i),resolutions:a,tileSize:t})}function yh(r){var e=r||{},t=e.extent||ct("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:mh(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Hn(n)}function mh(r,e,t,n){for(var i=e!==void 0?e:_f,a=qt(r),o=lt(r),s=Ct(t!==void 0?t:ia),h=n>0?n:Math.max(o/s[0],a/s[1]),l=i+1,u=new Array(l),c=0;c<l;++c)u[c]=h/Math.pow(2,c);return u}function $0(r,e,t,n){var i=Zn(r);return k0(i,e,t,n)}function Zn(r){r=ct(r);var e=r.getExtent();if(!e){var t=180*Jt[le.DEGREES]/r.getMetersPerUnit();e=nr(-t,-t,t,t)}return e}var Eh=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),K0=function(r){Eh(e,r);function e(t){var n=r.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})||this;n.on,n.once,n.un,n.opaque_=t.opaque!==void 0?t.opaque:!1,n.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,n.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;var i=[256,256];return n.tileGrid&&Ct(n.tileGrid.getTileSize(n.tileGrid.getMinZoom()),i),n.tileCache=new Hs(t.cacheSize||0),n.tmpSize=[0,0],n.key_=t.key||"",n.tileOptions={transition:t.transition,interpolate:t.interpolate},n.zDirection=t.zDirection?t.zDirection:0,n}return e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,n){var i=this.getTileCacheForProjection(t);i&&i.expireCache(n)},e.prototype.forEachLoadedTile=function(t,n,i,a){var o=this.getTileCacheForProjection(t);if(!o)return!1;for(var s=!0,h,l,u,c=i.minX;c<=i.maxX;++c)for(var f=i.minY;f<=i.maxY;++f)l=$r(n,c,f),u=!1,o.containsKey(l)&&(h=o.get(l),u=h.getState()===b.LOADED,u&&(u=a(h)!==!1)),u||(s=!1);return s},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},e.prototype.getTile=function(t,n,i,a,o){return Q()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:_h(t)},e.prototype.getTileCacheForProjection=function(t){var n=this.getProjection();return H(n===null||je(n,t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,n,i){var a=this.getTileGridForProjection(i),o=this.getTilePixelRatio(n),s=Ct(a.getTileSize(t),this.tmpSize);return o==1?s:fc(s,o,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,n){var i=n!==void 0?n:this.getProjection(),a=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=z0(a,t,i)),jv(t,a)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),r.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,n){var i=this.getTileCacheForProjection(n);t>i.highWaterMark&&(i.highWaterMark=t)},e.prototype.useTile=function(t,n,i,a){},e}(Bc),Th=function(r){Eh(e,r);function e(t,n){var i=r.call(this,t)||this;return i.tile=n,i}return e}(Me);const Mh=K0;var q0=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),V0=function(r){q0(e,r);function e(t){var n=this,i=t.projection===void 0?"EPSG:3857":t.projection,a=t.tileGrid;if(a===void 0&&i&&(a=yh({extent:Zn(i),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),n=r.call(this,{cacheSize:.1,attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:i,tileGrid:a,opaque:t.opaque,state:t.state,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate})||this,n.gutter_=t.gutter!==void 0?t.gutter:0,n.tileSize_=t.tileSize?Ct(t.tileSize):null,!n.tileSize_&&t.tilePixelRatio&&a){var o=Ct(a.getTileSize(0));n.tileSize_=[o[0]*t.tilePixelRatio,o[1]*t.tilePixelRatio]}return n.tileSizes_=null,n.tileLoadingKeys_={},n.loader_=t.loader,n.handleTileChange_=n.handleTileChange_.bind(n),n.bandCount=t.bandCount===void 0?4:t.bandCount,n}return e.prototype.setTileSizes=function(t){this.tileSizes_=t},e.prototype.getTileSize=function(t){if(this.tileSizes_)return this.tileSizes_[t];if(this.tileSize_)return this.tileSize_;var n=this.getTileGrid();return n?Ct(n.getTileSize(t)):[256,256]},e.prototype.getGutterForProjection=function(t){return this.gutter_},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.getTile=function(t,n,i,a,o){var s=this.getTileSize(t),h=$r(t,n,i);if(this.tileCache.containsKey(h))return this.tileCache.get(h);var l=this.loader_;function u(){return Ll(function(){return l(t,n,i)})}var c=ut({tileCoord:[t,n,i],loader:u,size:s},this.tileOptions),f=new Ws(c);return f.key=this.getKey(),f.addEventListener(G.CHANGE,this.handleTileChange_),this.tileCache.set(h,f),f},e.prototype.handleTileChange_=function(t){var n=t.target,i=At(n),a=n.getState(),o;a==b.LOADING?(this.tileLoadingKeys_[i]=!0,o=Je.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],o=a==b.ERROR?Je.TILELOADERROR:a==b.LOADED?Je.TILELOADEND:void 0),o&&this.dispatchEvent(new Th(o,n))},e}(Mh);const H0=V0;function _t(r){return(e,...t)=>Z0(r,e,t)}function vr(r,e){return _t(xh(r,e).get)}const{apply:Z0,construct:j1,defineProperty:X1,get:z1,getOwnPropertyDescriptor:xh,getPrototypeOf:ga,has:k1,ownKeys:Y0,set:$1,setPrototypeOf:K1}=Reflect,{iterator:Kr,species:q1,toStringTag:W0,for:V1}=Symbol,Q0=Object,{create:_a,defineProperty:J0,freeze:H1,is:Z1}=Q0,td=Array,ed=td.prototype,Rh=ed[Kr],rd=_t(Rh),wh=ArrayBuffer,nd=wh.prototype;vr(nd,"byteLength");const wo=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;wo&&vr(wo.prototype,"byteLength");const Ch=ga(Uint8Array);Ch.from;const Rt=Ch.prototype;Rt[Kr];_t(Rt.keys);_t(Rt.values);_t(Rt.entries);_t(Rt.set);_t(Rt.reverse);_t(Rt.fill);_t(Rt.copyWithin);_t(Rt.sort);_t(Rt.slice);_t(Rt.subarray);vr(Rt,"buffer");vr(Rt,"byteOffset");vr(Rt,"length");vr(Rt,W0);const dr=Uint32Array,id=Float32Array,Pn=ga([][Kr]()),ad=_t(Pn.next),od=_t(function*(){}().next),sd=ga(Pn),hd=DataView.prototype,ld=_t(hd.getUint16),ya=WeakMap,Ah=ya.prototype,Oh=_t(Ah.get),ud=_t(Ah.set),Sh=new ya,cd=_a(null,{next:{value:function(){const e=Oh(Sh,this);return ad(e)}},[Kr]:{value:function(){return this}}});function fd(r){if(r[Kr]===Rh)return r;const e=_a(cd);return ud(Sh,e,rd(r)),e}const vd=new ya,dd=_a(sd,{next:{value:function(){const e=Oh(vd,this);return od(e)},writable:!0,configurable:!0}});for(const r of Y0(Pn))r!=="next"&&J0(dd,r,xh(Pn,r));const Ph=new wh(4),pd=new id(Ph),gd=new dr(Ph),Ht=new dr(512),Zt=new dr(512);for(let r=0;r<256;++r){const e=r-127;e<-27?(Ht[r]=0,Ht[r|256]=32768,Zt[r]=24,Zt[r|256]=24):e<-14?(Ht[r]=1024>>-e-14,Ht[r|256]=1024>>-e-14|32768,Zt[r]=-e-1,Zt[r|256]=-e-1):e<=15?(Ht[r]=e+15<<10,Ht[r|256]=e+15<<10|32768,Zt[r]=13,Zt[r|256]=13):e<128?(Ht[r]=31744,Ht[r|256]=64512,Zt[r]=24,Zt[r|256]=24):(Ht[r]=31744,Ht[r|256]=64512,Zt[r]=13,Zt[r|256]=13)}const ma=new dr(2048),pr=new dr(64),Ih=new dr(64);for(let r=1;r<1024;++r){let e=r<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,ma[r]=e|t}for(let r=1024;r<2048;++r)ma[r]=939524096+(r-1024<<13);for(let r=1;r<31;++r)pr[r]=r<<23;pr[31]=1199570944;pr[32]=2147483648;for(let r=33;r<63;++r)pr[r]=2147483648+(r-32<<23);pr[63]=3347054592;for(let r=1;r<64;++r)r!==32&&(Ih[r]=1024);function _d(r){const e=r>>10;return gd[0]=ma[Ih[e]+(r&1023)]+pr[e],pd[0]}function bh(r,e,...t){return _d(ld(r,e,...fd(t)))}var Cr={exports:{}};function Lh(r,e,t){const n=t&&t.debug||!1;n&&console.log("getting "+e+" in "+r);const i=typeof r=="object"?r.outer:r,a=`${e}\\="([^"]*)"`;n&&console.log("pattern:",a);const s=new RegExp(a).exec(i);if(n&&console.log("match:",s),s)return s[1]}Cr.exports=Lh;Cr.exports.default=Lh;var Ea={exports:{}},Ta={exports:{}},Ma={exports:{}};function Nh(r,e,t){const i=new RegExp(e).exec(r.slice(t));return i?t+i.index:-1}Ma.exports=Nh;Ma.exports.default=Nh;var xa={exports:{}};function Dh(r,e,t){const i=new RegExp(e).exec(r.slice(t));return i?t+i.index+i[0].length-1:-1}xa.exports=Dh;xa.exports.default=Dh;var Ra={exports:{}};function Gh(r,e){const t=new RegExp(e,"g"),n=r.match(t);return n?n.length:0}Ra.exports=Gh;Ra.exports.default=Gh;const yd=Ma.exports,fi=xa.exports,Co=Ra.exports;function Fh(r,e,t){const n=t&&t.debug||!1,i=!(t&&typeof t.nested===!1),a=t&&t.startIndex||0;n&&console.log("[xml-utils] starting findTagByName with",e," and ",t);const o=yd(r,`<${e}[ >/]`,a);if(n&&console.log("[xml-utils] start:",o),o===-1)return;const s=r.slice(o+e.length);let h=fi(s,"^[^<]*[ /]>",0);const l=h!==-1&&s[h-1]==="/";if(n&&console.log("[xml-utils] selfClosing:",l),l===!1)if(i){let v=0,d=1,p=0;for(;(h=fi(s,"[ /]"+e+">",v))!==-1;){const g=s.substring(v,h+1);if(d+=Co(g,"<"+e),p+=Co(g,"/"+e+">"),p>=d)break;v=h}}else h=fi(s,"[ /]"+e+">",0);const u=o+e.length+h+1;if(n&&console.log("[xml-utils] end:",u),u===-1)return;const c=r.slice(o,u);let f;return l?f=null:f=c.slice(c.indexOf(">")+1,c.lastIndexOf("<")),{inner:f,outer:c,start:o,end:u}}Ta.exports=Fh;Ta.exports.default=Fh;const md=Ta.exports;function Uh(r,e,t){const n=[],i=t&&t.debug||!1,a=t&&typeof t.nested=="boolean"?t.nested:!0;let o=t&&t.startIndex||0,s;for(;s=md(r,e,{debug:i,startIndex:o});)a?o=s.start+1+e.length:o=s.end,n.push(s);return i&&console.log("findTagsByName found",n.length,"tags"),n}Ea.exports=Uh;Ea.exports.default=Uh;const Ar={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Yt={};for(const r in Ar)Ar.hasOwnProperty(r)&&(Yt[Ar[r]]=parseInt(r,10));const Ed=[Yt.BitsPerSample,Yt.ExtraSamples,Yt.SampleFormat,Yt.StripByteCounts,Yt.StripOffsets,Yt.StripRowCounts,Yt.TileByteCounts,Yt.TileOffsets,Yt.SubIFDs],vi={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},F={};for(const r in vi)vi.hasOwnProperty(r)&&(F[vi[r]]=parseInt(r,10));const bt={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},Td={Unspecified:0,Assocalpha:1,Unassalpha:2},Y1={Version:0,AddCompression:1},W1={None:0,Deflate:1},Md={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function xd(r,e){const{width:t,height:n}=r,i=new Uint8Array(t*n*3);let a;for(let o=0,s=0;o<r.length;++o,s+=3)a=256-r[o]/e*256,i[s]=a,i[s+1]=a,i[s+2]=a;return i}function Rd(r,e){const{width:t,height:n}=r,i=new Uint8Array(t*n*3);let a;for(let o=0,s=0;o<r.length;++o,s+=3)a=r[o]/e*256,i[s]=a,i[s+1]=a,i[s+2]=a;return i}function wd(r,e){const{width:t,height:n}=r,i=new Uint8Array(t*n*3),a=e.length/3,o=e.length/3*2;for(let s=0,h=0;s<r.length;++s,h+=3){const l=r[s];i[h]=e[l]/65536*256,i[h+1]=e[l+a]/65536*256,i[h+2]=e[l+o]/65536*256}return i}function Cd(r){const{width:e,height:t}=r,n=new Uint8Array(e*t*3);for(let i=0,a=0;i<r.length;i+=4,a+=3){const o=r[i],s=r[i+1],h=r[i+2],l=r[i+3];n[a]=255*((255-o)/256)*((255-l)/256),n[a+1]=255*((255-s)/256)*((255-l)/256),n[a+2]=255*((255-h)/256)*((255-l)/256)}return n}function Ad(r){const{width:e,height:t}=r,n=new Uint8ClampedArray(e*t*3);for(let i=0,a=0;i<r.length;i+=3,a+=3){const o=r[i],s=r[i+1],h=r[i+2];n[a]=o+1.402*(h-128),n[a+1]=o-.34414*(s-128)-.71414*(h-128),n[a+2]=o+1.772*(s-128)}return n}const Od=.95047,Sd=1,Pd=1.08883;function Id(r){const{width:e,height:t}=r,n=new Uint8Array(e*t*3);for(let i=0,a=0;i<r.length;i+=3,a+=3){const o=r[i+0],s=r[i+1]<<24>>24,h=r[i+2]<<24>>24;let l=(o+16)/116,u=s/500+l,c=l-h/200,f,v,d;u=Od*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),l=Sd*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),c=Pd*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),f=u*3.2406+l*-1.5372+c*-.4986,v=u*-.9689+l*1.8758+c*.0415,d=u*.0557+l*-.204+c*1.057,f=f>.0031308?1.055*f**(1/2.4)-.055:12.92*f,v=v>.0031308?1.055*v**(1/2.4)-.055:12.92*v,d=d>.0031308?1.055*d**(1/2.4)-.055:12.92*d,n[a]=Math.max(0,Math.min(1,f))*255,n[a+1]=Math.max(0,Math.min(1,v))*255,n[a+2]=Math.max(0,Math.min(1,d))*255}return n}const bd="modulepreload",Ld=function(r){return"/"+r},Ao={},Re=function(e,t,n){return!t||t.length===0?e():Promise.all(t.map(i=>{if(i=Ld(i),i in Ao)return;Ao[i]=!0;const a=i.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${o}`))return;const s=document.createElement("link");if(s.rel=a?"stylesheet":bd,a||(s.as="script",s.crossOrigin=""),s.href=i,document.head.appendChild(s),a)return new Promise((h,l)=>{s.addEventListener("load",h),s.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())},Bh=new Map;function we(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>Bh.set(t,e))}async function jh(r){const e=Bh.get(r.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${r.Compression}`);const t=await e();return new t(r)}we([void 0,1],()=>Re(()=>import("./raw.c45fc51f.js"),["assets/raw.c45fc51f.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));we(5,()=>Re(()=>import("./lzw.654ab67e.js"),["assets/lzw.654ab67e.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));we(6,()=>{throw new Error("old style JPEG compression is not supported.")});we(7,()=>Re(()=>import("./jpeg.0079b036.js"),["assets/jpeg.0079b036.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));we([8,32946],()=>Re(()=>import("./deflate.e51481f5.js"),["assets/deflate.e51481f5.js","assets/pako.esm.9c7e9728.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));we(32773,()=>Re(()=>import("./packbits.d5c3724c.js"),["assets/packbits.d5c3724c.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));we(34887,()=>Re(()=>import("./lerc.7eca8890.js"),["assets/lerc.7eca8890.js","assets/pako.esm.9c7e9728.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));we(50001,()=>Re(()=>import("./webimage.eace165f.js"),["assets/webimage.eace165f.js","assets/basedecoder.c2fc4d47.js"]).then(r=>r.default));function Yn(r,e,t,n=1){return new(Object.getPrototypeOf(r)).constructor(e*t*n)}function Nd(r,e,t,n,i){const a=e/n,o=t/i;return r.map(s=>{const h=Yn(s,n,i);for(let l=0;l<i;++l){const u=Math.min(Math.round(o*l),t-1);for(let c=0;c<n;++c){const f=Math.min(Math.round(a*c),e-1),v=s[u*e+f];h[l*n+c]=v}}return h})}function tr(r,e,t){return(1-t)*r+t*e}function Dd(r,e,t,n,i){const a=e/n,o=t/i;return r.map(s=>{const h=Yn(s,n,i);for(let l=0;l<i;++l){const u=o*l,c=Math.floor(u),f=Math.min(Math.ceil(u),t-1);for(let v=0;v<n;++v){const d=a*v,p=d%1,g=Math.floor(d),y=Math.min(Math.ceil(d),e-1),_=s[c*e+g],m=s[c*e+y],E=s[f*e+g],T=s[f*e+y],M=tr(tr(_,m,p),tr(E,T,p),u%1);h[l*n+v]=M}}return h})}function Gd(r,e,t,n,i,a="nearest"){switch(a.toLowerCase()){case"nearest":return Nd(r,e,t,n,i);case"bilinear":case"linear":return Dd(r,e,t,n,i);default:throw new Error(`Unsupported resampling method: '${a}'`)}}function Fd(r,e,t,n,i,a){const o=e/n,s=t/i,h=Yn(r,n,i,a);for(let l=0;l<i;++l){const u=Math.min(Math.round(s*l),t-1);for(let c=0;c<n;++c){const f=Math.min(Math.round(o*c),e-1);for(let v=0;v<a;++v){const d=r[u*e*a+f*a+v];h[l*n*a+c*a+v]=d}}}return h}function Ud(r,e,t,n,i,a){const o=e/n,s=t/i,h=Yn(r,n,i,a);for(let l=0;l<i;++l){const u=s*l,c=Math.floor(u),f=Math.min(Math.ceil(u),t-1);for(let v=0;v<n;++v){const d=o*v,p=d%1,g=Math.floor(d),y=Math.min(Math.ceil(d),e-1);for(let _=0;_<a;++_){const m=r[c*e*a+g*a+_],E=r[c*e*a+y*a+_],T=r[f*e*a+g*a+_],M=r[f*e*a+y*a+_],R=tr(tr(m,E,p),tr(T,M,p),u%1);h[l*n*a+v*a+_]=R}}}return h}function Bd(r,e,t,n,i,a,o="nearest"){switch(o.toLowerCase()){case"nearest":return Fd(r,e,t,n,i,a);case"bilinear":case"linear":return Ud(r,e,t,n,i,a);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function jd(r,e,t){let n=0;for(let i=e;i<t;++i)n+=r[i];return n}function Li(r,e,t){switch(r){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function Xd(r,e){return(r===1||r===2)&&e<=32&&e%8===0?!1:!(r===3&&(e===16||e===32||e===64))}function zd(r,e,t,n,i,a,o){const s=new DataView(r),h=t===2?o*a:o*a*n,l=t===2?1:n,u=Li(e,i,h),c=parseInt("1".repeat(i),2);if(e===1){let f;t===1?f=n*i:f=i;let v=a*f;(v&7)!==0&&(v=v+7&-8);for(let d=0;d<o;++d){const p=d*v;for(let g=0;g<a;++g){const y=p+g*l*i;for(let _=0;_<l;++_){const m=y+_*i,E=(d*a+g)*l+_,T=Math.floor(m/8),M=m%8;if(M+i<=8)u[E]=s.getUint8(T)>>8-i-M&c;else if(M+i<=16)u[E]=s.getUint16(T)>>16-i-M&c;else if(M+i<=24){const R=s.getUint16(T)<<8|s.getUint8(T+2);u[E]=R>>24-i-M&c}else u[E]=s.getUint32(T)>>32-i-M&c}}}}return u.buffer}class kd{constructor(e,t,n,i,a,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=n,this.littleEndian=i,this.tiles=a?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=typeof s>"u"?1:s,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,n=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(i,a){return bh(this,i,a)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const n=this.getSampleFormat(e),i=this.getBitsPerSample(e);return Li(n,i,t)}async getTileOrStrip(e,t,n,i,a){const o=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight());let h;const{tiles:l}=this;this.planarConfiguration===1?h=t*o+e:this.planarConfiguration===2&&(h=n*o*s+t*o+e);let u,c;this.isTiled?(u=this.fileDirectory.TileOffsets[h],c=this.fileDirectory.TileByteCounts[h]):(u=this.fileDirectory.StripOffsets[h],c=this.fileDirectory.StripByteCounts[h]);const f=(await this.source.fetch([{offset:u,length:c}],a))[0];let v;return l===null||!l[h]?(v=(async()=>{let d=await i.decode(this.fileDirectory,f);const p=this.getSampleFormat(),g=this.getBitsPerSample();return Xd(p,g)&&(d=zd(d,p,this.planarConfiguration,this.getSamplesPerPixel(),g,this.getTileWidth(),this.getBlockHeight(t))),d})(),l!==null&&(l[h]=v)):v=l[h],{x:e,y:t,sample:n,data:await v}}async _readRaster(e,t,n,i,a,o,s,h,l){const u=this.getTileWidth(),c=this.getTileHeight(),f=this.getWidth(),v=this.getHeight(),d=Math.max(Math.floor(e[0]/u),0),p=Math.min(Math.ceil(e[2]/u),Math.ceil(f/u)),g=Math.max(Math.floor(e[1]/c),0),y=Math.min(Math.ceil(e[3]/c),Math.ceil(v/c)),_=e[2]-e[0];let m=this.getBytesPerPixel();const E=[],T=[];for(let w=0;w<t.length;++w)this.planarConfiguration===1?E.push(jd(this.fileDirectory.BitsPerSample,0,t[w])/8):E.push(0),T.push(this.getReaderForSample(t[w]));const M=[],{littleEndian:R}=this;for(let w=g;w<y;++w)for(let S=d;S<p;++S)for(let L=0;L<t.length;++L){const I=L,j=t[L];this.planarConfiguration===2&&(m=this.getSampleByteSize(L));const q=this.getTileOrStrip(S,w,j,a,l);M.push(q),q.then(Y=>{const B=Y.data,tt=new DataView(B),et=this.getBlockHeight(Y.y),V=Y.y*c,W=Y.x*u,Z=V+et,ht=(Y.x+1)*u,Pt=T[I],It=Math.min(et,et-(Z-e[3]),v-V),Tt=Math.min(u,u-(ht-e[2]),f-W);for(let ft=Math.max(0,e[1]-V);ft<It;++ft)for(let Nt=Math.max(0,e[0]-W);Nt<Tt;++Nt){const Vt=(ft*u+Nt)*m,yt=Pt.call(tt,Vt+E[I],R);let re;i?(re=(ft+V-e[1])*_*t.length+(Nt+W-e[0])*t.length+I,n[re]=yt):(re=(ft+V-e[1])*_+Nt+W-e[0],n[I][re]=yt)}})}if(await Promise.all(M),o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s){let w;return i?w=Bd(n,e[2]-e[0],e[3]-e[1],o,s,t.length,h):w=Gd(n,e[2]-e[0],e[3]-e[1],o,s,h),w.width=o,w.height=s,w}return n.width=o||e[2]-e[0],n.height=s||e[3]-e[1],n}async readRasters({window:e,samples:t=[],interleave:n,pool:i=null,width:a,height:o,resampleMethod:s,fillValue:h,signal:l}={}){const u=e||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=u[2]-u[0],f=u[3]-u[1],v=c*f,d=this.getSamplesPerPixel();if(!t||!t.length)for(let _=0;_<d;++_)t.push(_);else for(let _=0;_<t.length;++_)if(t[_]>=d)return Promise.reject(new RangeError(`Invalid sample index '${t[_]}'.`));let p;if(n){const _=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,m=Math.max.apply(null,this.fileDirectory.BitsPerSample);p=Li(_,m,v*t.length),h&&p.fill(h)}else{p=[];for(let _=0;_<t.length;++_){const m=this.getArrayForSample(t[_],v);Array.isArray(h)&&_<h.length?m.fill(h[_]):h&&!Array.isArray(h)&&m.fill(h),p.push(m)}}const g=i||await jh(this.fileDirectory);return await this._readRaster(u,t,p,n,g,a,o,s,l)}async readRGB({window:e,interleave:t=!0,pool:n=null,width:i,height:a,resampleMethod:o,enableAlpha:s=!1,signal:h}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const u=this.fileDirectory.PhotometricInterpretation;if(u===bt.RGB){let y=[0,1,2];if(this.fileDirectory.ExtraSamples!==Td.Unspecified&&s){y=[];for(let _=0;_<this.fileDirectory.BitsPerSample.length;_+=1)y.push(_)}return this.readRasters({window:e,interleave:t,samples:y,pool:n,width:i,height:a,resampleMethod:o,signal:h})}let c;switch(u){case bt.WhiteIsZero:case bt.BlackIsZero:case bt.Palette:c=[0];break;case bt.CMYK:c=[0,1,2,3];break;case bt.YCbCr:case bt.CIELab:c=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const f={window:l,interleave:!0,samples:c,pool:n,width:i,height:a,resampleMethod:o,signal:h},{fileDirectory:v}=this,d=await this.readRasters(f),p=2**this.fileDirectory.BitsPerSample[0];let g;switch(u){case bt.WhiteIsZero:g=xd(d,p);break;case bt.BlackIsZero:g=Rd(d,p);break;case bt.Palette:g=wd(d,v.ColorMap);break;case bt.CMYK:g=Cd(d);break;case bt.YCbCr:g=Ad(d);break;case bt.CIELab:g=Id(d);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const y=new Uint8Array(g.length/3),_=new Uint8Array(g.length/3),m=new Uint8Array(g.length/3);for(let E=0,T=0;E<g.length;E+=3,++T)y[T]=g[E],_[T]=g[E+1],m[T]=g[E+2];g=[y,_,m]}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let i=Ea.exports(n,"Item");e===null?i=i.filter(a=>Cr.exports(a,"sample")===void 0):i=i.filter(a=>Number(Cr.exports(a,"sample"))===e);for(let a=0;a<i.length;++a){const o=i[a];t[Cr.exports(o,"name")]=o.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(n)return[n[0],n[5],n[10]];if(e){const[i,a,o]=e.getResolution();return[i*e.getWidth()/this.getWidth(),a*e.getHeight()/this.getHeight(),o*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),n=e[0],i=e[1],a=n+t[0]*this.getWidth(),o=i+t[1]*this.getHeight();return[Math.min(n,a),Math.min(i,o),Math.max(n,a),Math.max(i,o)]}}const Xh=kd;class $d{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const n=this.getUint32(e,t),i=this.getUint32(e+4,t);let a;if(t){if(a=n+2**32*i,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}if(a=2**32*n+i,!Number.isSafeInteger(a))throw new Error(`${a} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return a}getInt64(e,t){let n=0;const i=(this._dataView.getUint8(e+(t?7:0))&128)>0;let a=!0;for(let o=0;o<8;o++){let s=this._dataView.getUint8(e+(t?o:7-o));i&&(a?s!==0&&(s=~(s-1)&255,a=!1):s=~s&255),n+=s*256**o}return i&&(n=-n),n}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return bh(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class Kd{constructor(e,t,n,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=n,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),n=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*t+n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(e){let t=0;const n=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let i=!0;for(let a=0;a<8;a++){let o=this._dataView.getUint8(e+(this._littleEndian?a:7-a));n&&(i?o!==0&&(o=~(o-1)&255,i=!1):o=~o&255),t+=o*256**a}return n&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const qd=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class Vd{constructor(e=qd,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(n=>{Re(()=>import("./decoder.f53bb359.js"),[]).then(i=>{n(i.create)})}),this._awaitingDecoder.then(n=>{this._awaitingDecoder=null,this.workers=[];for(let i=0;i<e;i++)this.workers.push({worker:n(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?jh(e).then(n=>n.decode(e,t)):new Promise(n=>{const i=this.workers.find(s=>s.idle)||this.workers[Math.floor(Math.random()*this.size)];i.idle=!1;const a=this.messageId++,o=s=>{s.data.id===a&&(i.idle=!0,n(s.data.decoded),i.worker.removeEventListener("message",o))};i.worker.addEventListener("message",o),i.worker.postMessage({fileDirectory:e,buffer:t,id:a},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const Hd=Vd,Oo=`\r
\r
`;function zh(r){if(typeof Object.fromEntries<"u")return Object.fromEntries(r);const e={};for(const[t,n]of r)e[t.toLowerCase()]=n;return e}function Zd(r){const e=r.split(`\r
`).map(t=>{const n=t.split(":").map(i=>i.trim());return n[0]=n[0].toLowerCase(),n});return zh(e)}function Yd(r){const[e,...t]=r.split(";").map(i=>i.trim()),n=t.map(i=>i.split("="));return{type:e,params:zh(n)}}function Ni(r){let e,t,n;return r&&([,e,t,n]=r.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10)),{start:e,end:t,total:n}}function Wd(r,e){let t=null;const n=new TextDecoder("ascii"),i=[],a=`--${e}`,o=`${a}--`;for(let s=0;s<10;++s)n.decode(new Uint8Array(r,s,a.length))===a&&(t=s);if(t===null)throw new Error("Could not find initial boundary");for(;t<r.byteLength;){const s=n.decode(new Uint8Array(r,t,Math.min(a.length+1024,r.byteLength-t)));if(s.length===0||s.startsWith(o))break;if(!s.startsWith(a))throw new Error("Part does not start with boundary");const h=s.substr(a.length+2);if(h.length===0)break;const l=h.indexOf(Oo),u=Zd(h.substr(0,l)),{start:c,end:f,total:v}=Ni(u["content-range"]),d=t+a.length+l+Oo.length,p=parseInt(f,10)+1-parseInt(c,10);i.push({headers:u,data:r.slice(d,d+p),offset:c,length:p,fileSize:v}),t=d+p+4}return i}class wa{async fetch(e,t=void 0){return Promise.all(e.map(n=>this.fetchSlice(n,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}var di,So;function Qd(){return So||(So=1,di=function(r){r.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),di}var Jd=X;X.Node=be;X.create=X;function X(r){var e=this;if(e instanceof X||(e=new X),e.tail=null,e.head=null,e.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)e.push(arguments[t]);return e}X.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var e=r.next,t=r.prev;return e&&(e.prev=t),t&&(t.next=e),r===this.head&&(this.head=e),r===this.tail&&(this.tail=t),r.list.length--,r.next=null,r.prev=null,r.list=null,e};X.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var e=this.head;r.list=this,r.next=e,e&&(e.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};X.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var e=this.tail;r.list=this,r.prev=e,e&&(e.next=r),this.tail=r,this.head||(this.head=r),this.length++}};X.prototype.push=function(){for(var r=0,e=arguments.length;r<e;r++)ep(this,arguments[r]);return this.length};X.prototype.unshift=function(){for(var r=0,e=arguments.length;r<e;r++)rp(this,arguments[r]);return this.length};X.prototype.pop=function(){if(!!this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};X.prototype.shift=function(){if(!!this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};X.prototype.forEach=function(r,e){e=e||this;for(var t=this.head,n=0;t!==null;n++)r.call(e,t.value,n,this),t=t.next};X.prototype.forEachReverse=function(r,e){e=e||this;for(var t=this.tail,n=this.length-1;t!==null;n--)r.call(e,t.value,n,this),t=t.prev};X.prototype.get=function(r){for(var e=0,t=this.head;t!==null&&e<r;e++)t=t.next;if(e===r&&t!==null)return t.value};X.prototype.getReverse=function(r){for(var e=0,t=this.tail;t!==null&&e<r;e++)t=t.prev;if(e===r&&t!==null)return t.value};X.prototype.map=function(r,e){e=e||this;for(var t=new X,n=this.head;n!==null;)t.push(r.call(e,n.value,this)),n=n.next;return t};X.prototype.mapReverse=function(r,e){e=e||this;for(var t=new X,n=this.tail;n!==null;)t.push(r.call(e,n.value,this)),n=n.prev;return t};X.prototype.reduce=function(r,e){var t,n=this.head;if(arguments.length>1)t=e;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)t=r(t,n.value,i),n=n.next;return t};X.prototype.reduceReverse=function(r,e){var t,n=this.tail;if(arguments.length>1)t=e;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)t=r(t,n.value,i),n=n.prev;return t};X.prototype.toArray=function(){for(var r=new Array(this.length),e=0,t=this.head;t!==null;e++)r[e]=t.value,t=t.next;return r};X.prototype.toArrayReverse=function(){for(var r=new Array(this.length),e=0,t=this.tail;t!==null;e++)r[e]=t.value,t=t.prev;return r};X.prototype.slice=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new X;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<e;n++,i=i.next)t.push(i.value);return t};X.prototype.sliceReverse=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new X;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=this.length,i=this.tail;i!==null&&n>e;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)t.push(i.value);return t};X.prototype.splice=function(r,e,...t){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var a=[],n=0;i&&n<e;n++)a.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<t.length;n++)i=tp(this,i,t[n]);return a};X.prototype.reverse=function(){for(var r=this.head,e=this.tail,t=r;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=e,this.tail=r,this};function tp(r,e,t){var n=e===r.head?new be(t,null,e,r):new be(t,e,e.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function ep(r,e){r.tail=new be(e,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function rp(r,e){r.head=new be(e,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function be(r,e,t,n){if(!(this instanceof be))return new be(r,e,t,n);this.list=n,this.value=r,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Qd()(X)}catch{}const np=Jd,Oe=Symbol("max"),he=Symbol("length"),Ue=Symbol("lengthCalculator"),Or=Symbol("allowStale"),Pe=Symbol("maxAge"),se=Symbol("dispose"),Po=Symbol("noDisposeOnSet"),vt=Symbol("lruList"),Xt=Symbol("cache"),kh=Symbol("updateAgeOnGet"),pi=()=>1;class ip{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[Oe]=e.max||1/0;const t=e.length||pi;if(this[Ue]=typeof t!="function"?pi:t,this[Or]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Pe]=e.maxAge||0,this[se]=e.dispose,this[Po]=e.noDisposeOnSet||!1,this[kh]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Oe]=e||1/0,yr(this)}get max(){return this[Oe]}set allowStale(e){this[Or]=!!e}get allowStale(){return this[Or]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Pe]=e,yr(this)}get maxAge(){return this[Pe]}set lengthCalculator(e){typeof e!="function"&&(e=pi),e!==this[Ue]&&(this[Ue]=e,this[he]=0,this[vt].forEach(t=>{t.length=this[Ue](t.value,t.key),this[he]+=t.length})),yr(this)}get lengthCalculator(){return this[Ue]}get length(){return this[he]}get itemCount(){return this[vt].length}rforEach(e,t){t=t||this;for(let n=this[vt].tail;n!==null;){const i=n.prev;Io(this,e,n,t),n=i}}forEach(e,t){t=t||this;for(let n=this[vt].head;n!==null;){const i=n.next;Io(this,e,n,t),n=i}}keys(){return this[vt].toArray().map(e=>e.key)}values(){return this[vt].toArray().map(e=>e.value)}reset(){this[se]&&this[vt]&&this[vt].length&&this[vt].forEach(e=>this[se](e.key,e.value)),this[Xt]=new Map,this[vt]=new np,this[he]=0}dump(){return this[vt].map(e=>In(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[vt]}set(e,t,n){if(n=n||this[Pe],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,a=this[Ue](t,e);if(this[Xt].has(e)){if(a>this[Oe])return er(this,this[Xt].get(e)),!1;const h=this[Xt].get(e).value;return this[se]&&(this[Po]||this[se](e,h.value)),h.now=i,h.maxAge=n,h.value=t,this[he]+=a-h.length,h.length=a,this.get(e),yr(this),!0}const o=new ap(e,t,a,i,n);return o.length>this[Oe]?(this[se]&&this[se](e,t),!1):(this[he]+=o.length,this[vt].unshift(o),this[Xt].set(e,this[vt].head),yr(this),!0)}has(e){if(!this[Xt].has(e))return!1;const t=this[Xt].get(e).value;return!In(this,t)}get(e){return gi(this,e,!0)}peek(e){return gi(this,e,!1)}pop(){const e=this[vt].tail;return e?(er(this,e),e.value):null}del(e){er(this,this[Xt].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const i=e[n],a=i.e||0;if(a===0)this.set(i.k,i.v);else{const o=a-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[Xt].forEach((e,t)=>gi(this,t,!1))}}const gi=(r,e,t)=>{const n=r[Xt].get(e);if(n){const i=n.value;if(In(r,i)){if(er(r,n),!r[Or])return}else t&&(r[kh]&&(n.value.now=Date.now()),r[vt].unshiftNode(n));return i.value}},In=(r,e)=>{if(!e||!e.maxAge&&!r[Pe])return!1;const t=Date.now()-e.now;return e.maxAge?t>e.maxAge:r[Pe]&&t>r[Pe]},yr=r=>{if(r[he]>r[Oe])for(let e=r[vt].tail;r[he]>r[Oe]&&e!==null;){const t=e.prev;er(r,e),e=t}},er=(r,e)=>{if(e){const t=e.value;r[se]&&r[se](t.key,t.value),r[he]-=t.length,r[Xt].delete(t.key),r[vt].removeNode(e)}};class ap{constructor(e,t,n,i,a){this.key=e,this.value=t,this.length=n,this.now=i,this.maxAge=a||0}}const Io=(r,e,t,n)=>{let i=t.value;In(r,i)&&(er(r,t),r[Or]||(i=void 0)),i&&e.call(n,i.value,i.key,r)};var op=ip;async function sp(r){return new Promise(e=>setTimeout(e,r))}function bo(r,e){const t=Array.isArray(r)?r:Array.from(r),n=Array.isArray(e)?e:Array.from(e);return t.map((i,a)=>[i,n[a]])}class or extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,or),this.name="AbortError"}}class hp extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const lp=hp;class up{constructor(e,t,n=null){this.offset=e,this.length=t,this.data=n}get top(){return this.offset+this.length}}class Lo{constructor(e,t,n){this.offset=e,this.length=t,this.blockIds=n}}class cp extends wa{constructor(e,{blockSize:t=65536,cacheSize:n=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new op({max:n}),this.blockRequests=new Map,this.blockIdsToFetch=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const n=new Map,i=new Map,a=new Set;for(const{offset:l,length:u}of e){let c=l+u;const{fileSize:f}=this;f!==null&&(c=Math.min(c,f));const v=Math.floor(l/this.blockSize)*this.blockSize;for(let d=v;d<c;d+=this.blockSize){const p=Math.floor(d/this.blockSize);this.blockCache.has(p)?n.set(p,this.blockCache.get(p)):this.blockRequests.has(p)?i.set(p,this.blockRequests.get(p)):(this.blockIdsToFetch.has(p)||this.blockIdsToFetch.add(p),a.add(p))}}await sp(),this.fetchBlocks(t);for(const l of a){const u=this.blockRequests.get(l),c=this.blockCache.get(l);if(u)i.set(l,u);else if(c)n.set(l,c);else throw new Error(`Block ${l} is not in the block requests`)}let o=await Promise.allSettled(Array.from(i.values()));if(o.some(l=>l.status==="rejected")){const l=new Set;for(const[u,c]of bo(i.keys(),o)){const{rejected:f,reason:v}=c;f&&v.name==="AbortError"&&v.signal!==t&&(this.blockIdsToFetch.add(u),l.add(u))}if(this.blockIdsToFetch.length>0){this.fetchBlocks(t);for(const u of l){const c=this.blockRequests.get(u);if(!c)throw new Error(`Block ${u} is not in the block requests`);i.set(u,c)}o=await Promise.allSettled(Array.from(i.values()))}}if(o.some(l=>l.status==="rejected"))throw t&&t.aborted?new or("Request was aborted"):new lp(o.filter(l=>l.status==="rejected").map(l=>l.reason),"Request failed");const s=o.map(l=>l.value),h=new Map(bo(Array.from(i.keys()),s));for(const[l,u]of n)h.set(l,u);return this.readSliceData(e,h)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(t,e);for(let i=0;i<t.length;++i){const a=t[i];for(const o of a.blockIds){const s=(async()=>{try{const h=(await n)[i],l=o*this.blockSize,u=l-h.offset,c=Math.min(u+this.blockSize,h.data.byteLength),f=h.data.slice(u,c),v=new up(l,f.byteLength,f);return this.blockCache.set(o,v),v}catch(h){throw h.name==="AbortError"&&(h.signal=e),h}finally{this.blockRequests.delete(o)}})();this.blockRequests.set(o,s)}}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((o,s)=>o-s);if(t.length===0)return[];let n=[],i=null;const a=[];for(const o of t)i===null||i+1===o?(n.push(o),i=o):(a.push(new Lo(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[o],i=o);return a.push(new Lo(n[0]*this.blockSize,n.length*this.blockSize,n)),a}readSliceData(e,t){return e.map(n=>{const i=n.offset+n.length,a=Math.floor(n.offset/this.blockSize),o=Math.floor((n.offset+n.length)/this.blockSize),s=new ArrayBuffer(n.length),h=new Uint8Array(s);for(let l=a;l<=o;++l){const u=t.get(l),c=u.offset-n.offset,f=u.top-i;let v=0,d=0,p;c<0?v=-c:c>0&&(d=c),f<0?p=u.length-v:p=i-u.offset-v;const g=new Uint8Array(u.data,v,p);h.set(g,d)}return s})}}class Ca{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Aa{constructor(e){this.url=e}async request({headers:e,credentials:t,signal:n}={}){throw new Error("request is not implemented")}}class fp extends Ca{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class vp extends Aa{constructor(e,t){super(e),this.credentials=t}async request({headers:e,credentials:t,signal:n}={}){const i=await fetch(this.url,{headers:e,credentials:t,signal:n});return new fp(i)}}class dp extends Ca{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class pp extends Aa{constructRequest(e,t){return new Promise((n,i)=>{const a=new XMLHttpRequest;a.open("GET",this.url),a.responseType="arraybuffer";for(const[o,s]of Object.entries(e))a.setRequestHeader(o,s);a.onload=()=>{const o=a.response;n(new dp(a,o))},a.onerror=i,a.onabort=()=>i(new or("Request aborted")),a.send(),t&&(t.aborted&&a.abort(),t.addEventListener("abort",()=>a.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}const _i={};class gp extends Ca{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class _p extends Aa{constructor(e){super(e),this.parsedUrl=_i.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",_i)}constructRequest(e,t){return new Promise((n,i)=>{const a=this.httpApi.get({...this.parsedUrl,headers:e},o=>{const s=new Promise(h=>{const l=[];o.on("data",u=>{l.push(u)}),o.on("end",()=>{const u=Buffer.concat(l).buffer;h(u)}),o.on("error",i)});n(new gp(o,s))});a.on("error",i),t&&(t.aborted&&a.destroy(new or("Request aborted")),t.addEventListener("abort",()=>a.destroy(new or("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class Oa extends wa{constructor(e,t,n,i){super(),this.client=e,this.headers=t,this.maxRanges=n,this.allowFullFile=i,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(n=>this.fetchSlice(n,t))))}async fetchSlices(e,t){const n=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:i,length:a})=>`${i}-${i+a}`).join(",")}`},signal:t});if(n.ok)if(n.status===206){const{type:i,params:a}=Yd(n.getHeader("content-type"));if(i==="multipart/byteranges"){const c=Wd(await n.getData(),a.boundary);return this._fileSize=c[0].fileSize||null,c}const o=await n.getData(),{start:s,end:h,total:l}=Ni(n.getHeader("content-range"));this._fileSize=l||null;const u=[{data:o,offset:s,length:h-s}];if(e.length>1){const c=await Promise.all(e.slice(1).map(f=>this.fetchSlice(f,t)));return u.concat(c)}return u}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const i=await n.getData();return this._fileSize=i.byteLength,[{data:i,offset:0,length:i.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:n,length:i}=e,a=await this.client.request({headers:{...this.headers,Range:`bytes=${n}-${n+i}`},signal:t});if(a.ok)if(a.status===206){const o=await a.getData(),{total:s}=Ni(a.getHeader("content-range"));return this._fileSize=s||null,{data:o,offset:n,length:i}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await a.getData();return this._fileSize=o.byteLength,{data:o,offset:0,length:o.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function Sa(r,{blockSize:e,cacheSize:t}){return e===null?r:new cp(r,e,t)}function yp(r,{headers:e={},credentials:t,maxRanges:n=0,allowFullFile:i=!1,...a}={}){const o=new vp(r,t),s=new Oa(o,e,n,i);return Sa(s,a)}function mp(r,{headers:e={},maxRanges:t=0,allowFullFile:n=!1,...i}={}){const a=new pp(r),o=new Oa(a,e,t,n);return Sa(o,i)}function Ep(r,{headers:e={},maxRanges:t=0,allowFullFile:n=!1,...i}={}){const a=new _p(r),o=new Oa(a,e,t,n);return Sa(o,i)}function Di(r,{forceXHR:e=!1,...t}={}){return typeof fetch=="function"&&!e?yp(r,t):typeof XMLHttpRequest<"u"?mp(r,t):Ep(r,t)}class Tp extends wa{constructor(e){super(),this.file=e}async fetchSlice(e,t){return new Promise((n,i)=>{const a=this.file.slice(e.offset,e.offset+e.length),o=new FileReader;o.onload=s=>n(s.target.result),o.onerror=i,o.onabort=i,o.readAsArrayBuffer(a),t&&t.addEventListener("abort",()=>o.abort())})}}function Mp(r){return new Tp(r)}function Gi(r){switch(r){case F.BYTE:case F.ASCII:case F.SBYTE:case F.UNDEFINED:return 1;case F.SHORT:case F.SSHORT:return 2;case F.LONG:case F.SLONG:case F.FLOAT:case F.IFD:return 4;case F.RATIONAL:case F.SRATIONAL:case F.DOUBLE:case F.LONG8:case F.SLONG8:case F.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${r}`)}}function xp(r){const e=r.GeoKeyDirectory;if(!e)return null;const t={};for(let n=4;n<=e[3]*4;n+=4){const i=Md[e[n]],a=e[n+1]?Ar[e[n+1]]:null,o=e[n+2],s=e[n+3];let h=null;if(!a)h=s;else{if(h=r[a],typeof h>"u"||h===null)throw new Error(`Could not get value of geoKey '${i}'.`);typeof h=="string"?h=h.substring(s,s+o-1):h.subarray&&(h=h.subarray(s,s+o),o===1&&(h=h[0]))}t[i]=h}return t}function Be(r,e,t,n){let i=null,a=null;const o=Gi(e);switch(e){case F.BYTE:case F.ASCII:case F.UNDEFINED:i=new Uint8Array(t),a=r.readUint8;break;case F.SBYTE:i=new Int8Array(t),a=r.readInt8;break;case F.SHORT:i=new Uint16Array(t),a=r.readUint16;break;case F.SSHORT:i=new Int16Array(t),a=r.readInt16;break;case F.LONG:case F.IFD:i=new Uint32Array(t),a=r.readUint32;break;case F.SLONG:i=new Int32Array(t),a=r.readInt32;break;case F.LONG8:case F.IFD8:i=new Array(t),a=r.readUint64;break;case F.SLONG8:i=new Array(t),a=r.readInt64;break;case F.RATIONAL:i=new Uint32Array(t*2),a=r.readUint32;break;case F.SRATIONAL:i=new Int32Array(t*2),a=r.readInt32;break;case F.FLOAT:i=new Float32Array(t),a=r.readFloat32;break;case F.DOUBLE:i=new Float64Array(t),a=r.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===F.RATIONAL||e===F.SRATIONAL)for(let s=0;s<t;s+=2)i[s]=a.call(r,n+s*o),i[s+1]=a.call(r,n+(s*o+4));else for(let s=0;s<t;++s)i[s]=a.call(r,n+s*o);return e===F.ASCII?new TextDecoder("utf-8").decode(i):i}class Rp{constructor(e,t,n){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=n}}class ln extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class $h{async readRasters(e={}){const{window:t,width:n,height:i}=e;let{resX:a,resY:o,bbox:s}=e;const h=await this.getImage();let l=h;const u=await this.getImageCount(),c=h.getBoundingBox();if(t&&s)throw new Error('Both "bbox" and "window" passed.');if(n||i){if(t){const[d,p]=h.getOrigin(),[g,y]=h.getResolution();s=[d+t[0]*g,p+t[1]*y,d+t[2]*g,p+t[3]*y]}const v=s||c;if(n){if(a)throw new Error("Both width and resX passed");a=(v[2]-v[0])/n}if(i){if(o)throw new Error("Both width and resY passed");o=(v[3]-v[1])/i}}if(a||o){const v=[];for(let d=0;d<u;++d){const p=await this.getImage(d),{SubfileType:g,NewSubfileType:y}=p.fileDirectory;(d===0||g===2||y&1)&&v.push(p)}v.sort((d,p)=>d.getWidth()-p.getWidth());for(let d=0;d<v.length;++d){const p=v[d],g=(c[2]-c[0])/p.getWidth(),y=(c[3]-c[1])/p.getHeight();if(l=p,a&&a>g||o&&o>y)break}}let f=t;if(s){const[v,d]=h.getOrigin(),[p,g]=l.getResolution(h);f=[Math.round((s[0]-v)/p),Math.round((s[1]-d)/g),Math.round((s[2]-v)/p),Math.round((s[3]-d)/g)],f=[Math.min(f[0],f[2]),Math.min(f[1],f[3]),Math.max(f[0],f[2]),Math.max(f[1],f[3])]}return l.readRasters({...e,window:f})}}class sr extends $h{constructor(e,t,n,i,a={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=n,this.firstIFDOffset=i,this.cache=a.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const n=this.bigTiff?4048:1024;return new Kd((await this.source.fetch([{offset:e,length:typeof t<"u"?t:n}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,n=this.bigTiff?8:2;let i=await this.getSlice(e);const a=this.bigTiff?i.readUint64(e):i.readUint16(e),o=a*t+(this.bigTiff?16:6);i.covers(e,o)||(i=await this.getSlice(e,o));const s={};let h=e+(this.bigTiff?8:2);for(let c=0;c<a;h+=t,++c){const f=i.readUint16(h),v=i.readUint16(h+2),d=this.bigTiff?i.readUint64(h+4):i.readUint32(h+4);let p,g;const y=Gi(v),_=h+(this.bigTiff?12:8);if(y*d<=(this.bigTiff?8:4))p=Be(i,v,d,_);else{const m=i.readOffset(_),E=Gi(v)*d;if(i.covers(m,E))p=Be(i,v,d,m);else{const T=await this.getSlice(m,E);p=Be(T,v,d,m)}}d===1&&Ed.indexOf(f)===-1&&!(v===F.RATIONAL||v===F.SRATIONAL)?g=p[0]:g=p,s[Ar[f]]=g}const l=xp(s),u=i.readOffset(e+n+t*a);return new Rp(s,l,u)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof ln?new ln(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new ln(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new Xh(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(n){if(n instanceof ln)t=!1;else throw n}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",n=t.length+100;let i=await this.getSlice(e,n);if(t===Be(i,F.ASCII,t.length,e)){const o=Be(i,F.ASCII,n,e).split(`
`)[0],s=Number(o.split("=")[1].split(" ")[0])+o.length;s>n&&(i=await this.getSlice(e,s));const h=Be(i,F.ASCII,s,e);this.ghostValues={},h.split(`
`).filter(l=>l.length>0).map(l=>l.split("=")).forEach(([l,u])=>{this.ghostValues[l]=u})}return this.ghostValues}static async fromSource(e,t,n){const i=(await e.fetch([{offset:0,length:1024}],n))[0],a=new $d(i),o=a.getUint16(0,0);let s;if(o===18761)s=!0;else if(o===19789)s=!1;else throw new TypeError("Invalid byte order value.");const h=a.getUint16(2,s);let l;if(h===42)l=!1;else if(h===43){if(l=!0,a.getUint16(4,s)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const u=l?a.getUint64(8,s):a.getUint32(4,s);return new sr(e,s,l,u,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class wp extends $h{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,n=0;for(let i=0;i<this.imageFiles.length;i++){const a=this.imageFiles[i];for(let o=0;o<this.imageCounts[i];o++){if(e===t){const s=await a.requestIFD(n);return new Xh(s.fileDirectory,s.geoKeyDirectory,a.dataView,a.littleEndian,a.cache,a.source)}t++,n++}n=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,n)=>t+n,0),this.imageCount}}async function Cp(r,e={},t){return sr.fromSource(Di(r,e),t)}async function Ap(r,e){return sr.fromSource(Mp(r),e)}async function Op(r,e=[],t={},n){const i=await sr.fromSource(Di(r,t),n),a=await Promise.all(e.map(o=>sr.fromSource(Di(o,t))));return new wp(i,a)}var Sp=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),No="STATISTICS_MAXIMUM",Do="STATISTICS_MINIMUM",yi;function Pp(){return yi||(yi=new Hd),yi}function Ip(r){try{return r.getBoundingBox()}catch{var e=r.fileDirectory;return[0,0,e.ImageWidth,e.ImageLength]}}function bp(r){try{return r.getOrigin().slice(0,2)}catch{return[0,r.fileDirectory.ImageLength]}}function Lp(r,e){try{return r.getResolution(e)}catch{return[e.fileDirectory.ImageWidth/r.fileDirectory.ImageWidth,e.fileDirectory.ImageHeight/r.fileDirectory.ImageHeight]}}function Np(r){var e=r.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey){var t="EPSG:"+e.ProjectedCSTypeGeoKey,n=ct(t);if(!n){var i=Xa(e.ProjLinearUnitsGeoKey);i&&(n=new Nr({code:t,units:i}))}return n}if(e.GeographicTypeGeoKey){var t="EPSG:"+e.GeographicTypeGeoKey,n=ct(t);if(!n){var i=Xa(e.GeogAngularUnitsGeoKey);i&&(n=new Nr({code:t,units:i}))}return n}return null}function Dp(r){return r.getImageCount().then(function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r.getImage(n);return Promise.all(t)})}function Gp(r,e){var t;return r.blob?t=Ap(r.blob):r.overviews?t=Op(r.url,r.overviews,e):t=Cp(r.url,e),t.then(Dp)}function Tr(r,e,t,n,i){if(Array.isArray(r)){var a=r.length;if(!Array.isArray(e)||a!=e.length){var o=new Error(n);throw i(o),o}for(var s=0;s<a;++s)Tr(r[s],e[s],t,n,i);return}if(e=e,Math.abs(r-e)>t*r)throw new Error(n)}function Fp(r){return r instanceof Int8Array?-128:r instanceof Int16Array?-32768:r instanceof Int32Array?-2147483648:r instanceof Float32Array?12e-39:0}function Up(r){return r instanceof Int8Array?127:r instanceof Uint8Array||r instanceof Uint8ClampedArray?255:r instanceof Int16Array?32767:r instanceof Uint16Array?65535:r instanceof Int32Array?2147483647:r instanceof Uint32Array?4294967295:r instanceof Float32Array?34e37:255}var Kh=function(r){Sp(e,r);function e(t){var n=r.call(this,{state:"loading",tileGrid:null,projection:null,opaque:t.opaque,transition:t.transition,interpolate:t.interpolate!==!1,wrapX:t.wrapX})||this;n.sourceInfo_=t.sources;var i=n.sourceInfo_.length;n.sourceOptions_=t.sourceOptions,n.sourceImagery_=new Array(i),n.resolutionFactors_=new Array(i),n.samplesPerPixel_,n.nodataValues_,n.metadata_,n.normalize_=t.normalize!==!1,n.addAlpha_=!1,n.error_=null,n.readMethod_=t.convertToRGB?"readRGB":"readRasters",n.setKey(n.sourceInfo_.map(function(h){return h.url}).join(","));for(var a=n,o=new Array(i),s=0;s<i;++s)o[s]=Gp(n.sourceInfo_[s],n.sourceOptions_);return Promise.all(o).then(function(h){a.configure_(h)}).catch(function(h){console.error(h),a.error_=h,a.setState("error")}),n}return e.prototype.getError=function(){return this.error_},e.prototype.configure_=function(t){for(var n,i,a,o,s,h=new Array(t.length),l=new Array(t.length),u=new Array(t.length),c=0,f=t.length,v=function(I){var j=t[I],q=j.length,Y=void 0,B=void 0,tt=new Array(q),et=new Array(q),V=new Array(q);l[I]=new Array(q),u[I]=new Array(q);for(var W=0;W<q;++W){var Z=j[W],ht=Z.getGDALNoData();u[I][W]=Z.getGDALMetadata(0),l[I][W]=ht;var Pt=d.sourceInfo_[I].bands;h[I]=Pt?Pt.length:Z.getSamplesPerPixel();var It=q-(W+1);Y||(Y=Ip(Z)),B||(B=bp(Z));var Tt=Lp(Z,j[0]);V[It]=Tt[0];var ft=[Z.getTileWidth(),Z.getTileHeight()];tt[It]=ft;var Nt=Tt[0]/Math.abs(Tt[1]);et[It]=[ft[0],ft[1]/Nt]}if(n?_e(n,Y,n):n=Y,!i)i=B;else{var Vt="Origin mismatch for source ".concat(I,", got [").concat(B,"] but expected [").concat(i,"]");Tr(i,B,0,Vt,d.viewRejector)}if(!s)s=V,d.resolutionFactors_[I]=1;else{s.length-c>V.length&&(c=s.length-V.length);var yt=s[s.length-1]/V[V.length-1];d.resolutionFactors_[I]=yt;var re=V.map(function(Wr){return Wr*=yt}),Vt="Resolution mismatch for source ".concat(I,", got [").concat(re,"] but expected [").concat(s,"]");Tr(s.slice(c,s.length),re,.02,Vt,d.viewRejector)}a?Tr(a.slice(c,a.length),et,.01,"Tile size mismatch for source ".concat(I),d.viewRejector):a=et,o?Tr(o.slice(c,o.length),tt,0,"Tile size mismatch for source ".concat(I),d.viewRejector):o=tt,d.sourceImagery_[I]=j.reverse()},d=this,p=0;p<f;++p)v(p);for(var g=0,y=this.sourceImagery_.length;g<y;++g)for(var _=this.sourceImagery_[g];_.length<s.length;)_.unshift(void 0);if(!this.getProjection())for(var m=t[0],g=m.length-1;g>=0;--g){var E=m[g],T=Np(E);if(T){this.projection=T;break}}this.samplesPerPixel_=h,this.nodataValues_=l,this.metadata_=u;t:for(var p=0;p<f;++p){if(this.sourceInfo_[p].nodata!==void 0){this.addAlpha_=!0;break}var M=l[p],R=this.sourceInfo_[p].bands;if(R){for(var g=0;g<R.length;++g)if(M[R[g]-1]!==null){this.addAlpha_=!0;break t}continue}for(var w=0;w<M.length;++w)if(M[w]!==null){this.addAlpha_=!0;break t}}var S=this.addAlpha_?1:0;this.bandCount=h.reduce(function(I,j){return I+=j,I},0)+S;var L=new Hn({extent:n,minZoom:c,origin:i,resolutions:s,tileSizes:a});this.tileGrid=L,this.setTileSizes(o),this.setLoader(this.loadTile_.bind(this)),this.setState("ready"),this.viewResolver({projection:this.projection,resolutions:s,center:wn(ir(n),this.projection),extent:Es(n,this.projection),zoom:0})},e.prototype.loadTile_=function(t,n,i){for(var a=this.getTileSize(t),o=this.sourceImagery_.length,s=new Array(o),h=this.addAlpha_,l=this.bandCount,u=this.samplesPerPixel_,c=this.nodataValues_,f=this.sourceInfo_,v=function(E){var T=f[E],M=d.resolutionFactors_[E],R=[Math.round(n*(a[0]*M)),Math.round(i*(a[1]*M)),Math.round((n+1)*(a[0]*M)),Math.round((i+1)*(a[1]*M))],w=d.sourceImagery_[E][t],S=void 0;T.bands&&(S=T.bands.map(function(I){return I-1}));var L=void 0;"nodata"in T&&T.nodata!==null?L=T.nodata:S?L=S.map(function(I){return c[E][I]}):L=c[E],s[E]=w[d.readMethod_]({window:R,width:a[0],height:a[1],samples:S,fillValue:L,pool:Pp(),interleave:!1})},d=this,p=0;p<o;++p)v(p);var g=a[0]*a[1],y=g*l,_=this.normalize_,m=this.metadata_;return Promise.all(s).then(function(E){var T;_?T=new Uint8Array(y):T=new Float32Array(y);for(var M=0,R=0;R<g;++R){for(var w=h,S=0;S<o;++S){var L=f[S],I=L.min,j=L.max,q=void 0,Y=void 0;if(_){var B=m[S][0];I===void 0&&(B&&Do in B?I=parseFloat(B[Do]):I=Fp(E[S][0])),j===void 0&&(B&&No in B?j=parseFloat(B[No]):j=Up(E[S][0])),q=255/(j-I),Y=-I*q}for(var tt=0;tt<u[S];++tt){var et=E[S][tt][R],V=void 0;if(_?V=ot(q*et+Y,0,255):V=et,!h)T[M]=V;else{var W=L.nodata;if(W===void 0){var Z=void 0;L.bands?Z=L.bands[tt]-1:Z=tt,W=c[S][Z]}var ht=isNaN(W);(!ht&&et!==W||ht&&!isNaN(et))&&(w=!1,T[M]=V)}M++}}h&&(w||(T[M]=255),M++)}return T}).catch(function(E){throw console.error(E),E})},e}(H0);Kh.prototype.getView;const Bp=Kh;function jp(r){r("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),r("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),r("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),r.WGS84=r["EPSG:4326"],r["EPSG:3785"]=r["EPSG:3857"],r.GOOGLE=r["EPSG:3857"],r["EPSG:900913"]=r["EPSG:3857"],r["EPSG:102113"]=r["EPSG:3857"]}var Le=1,Ne=2,yn=3,Xp=4,Fi=5,Go=6378137,zp=6356752314e-3,Fo=.0066943799901413165,Sr=484813681109536e-20,x=Math.PI/2,kp=.16666666666666666,$p=.04722222222222222,Kp=.022156084656084655,C=1e-10,pt=.017453292519943295,Wt=57.29577951308232,k=Math.PI/4,Gr=Math.PI*2,it=3.14159265359,St={};St.greenwich=0;St.lisbon=-9.131906111111;St.paris=2.337229166667;St.bogota=-74.080916666667;St.madrid=-3.687938888889;St.rome=12.452333333333;St.bern=7.439583333333;St.jakarta=106.807719444444;St.ferro=-17.666666666667;St.brussels=4.367975;St.stockholm=18.058277777778;St.athens=23.7163375;St.oslo=10.722916666667;const qp={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Uo=/[\s_\-\/\(\)]/g;function Ee(r,e){if(r[e])return r[e];for(var t=Object.keys(r),n=e.toLowerCase().replace(Uo,""),i=-1,a,o;++i<t.length;)if(a=t[i],o=a.toLowerCase().replace(Uo,""),o===n)return r[a]}function Ui(r){var e={},t=r.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,h){var l=h.split("=");return l.push(!0),s[l[0].toLowerCase()]=l[1],s},{}),n,i,a,o={proj:"projName",datum:"datumCode",rf:function(s){e.rf=parseFloat(s)},lat_0:function(s){e.lat0=s*pt},lat_1:function(s){e.lat1=s*pt},lat_2:function(s){e.lat2=s*pt},lat_ts:function(s){e.lat_ts=s*pt},lon_0:function(s){e.long0=s*pt},lon_1:function(s){e.long1=s*pt},lon_2:function(s){e.long2=s*pt},alpha:function(s){e.alpha=parseFloat(s)*pt},gamma:function(s){e.rectified_grid_angle=parseFloat(s)},lonc:function(s){e.longc=s*pt},x_0:function(s){e.x0=parseFloat(s)},y_0:function(s){e.y0=parseFloat(s)},k_0:function(s){e.k0=parseFloat(s)},k:function(s){e.k0=parseFloat(s)},a:function(s){e.a=parseFloat(s)},b:function(s){e.b=parseFloat(s)},r_a:function(){e.R_A=!0},zone:function(s){e.zone=parseInt(s,10)},south:function(){e.utmSouth=!0},towgs84:function(s){e.datum_params=s.split(",").map(function(h){return parseFloat(h)})},to_meter:function(s){e.to_meter=parseFloat(s)},units:function(s){e.units=s;var h=Ee(qp,s);h&&(e.to_meter=h.to_meter)},from_greenwich:function(s){e.from_greenwich=s*pt},pm:function(s){var h=Ee(St,s);e.from_greenwich=(h||parseFloat(s))*pt},nadgrids:function(s){s==="@null"?e.datumCode="none":e.nadgrids=s},axis:function(s){var h="ewnsud";s.length===3&&h.indexOf(s.substr(0,1))!==-1&&h.indexOf(s.substr(1,1))!==-1&&h.indexOf(s.substr(2,1))!==-1&&(e.axis=s)},approx:function(){e.approx=!0}};for(n in t)i=t[n],n in o?(a=o[n],typeof a=="function"?a(i):e[a]=i):e[n]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var Fr=1,qh=2,Vh=3,bn=4,Hh=5,Pa=-1,Vp=/\s/,Hp=/[A-Za-z]/,Zp=/[A-Za-z84_]/,Wn=/[,\]]/,Zh=/[\d\.E\-\+]/;function ce(r){if(typeof r!="string")throw new Error("not a string");this.text=r.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Fr}ce.prototype.readCharicter=function(){var r=this.text[this.place++];if(this.state!==bn)for(;Vp.test(r);){if(this.place>=this.text.length)return;r=this.text[this.place++]}switch(this.state){case Fr:return this.neutral(r);case qh:return this.keyword(r);case bn:return this.quoted(r);case Hh:return this.afterquote(r);case Vh:return this.number(r);case Pa:return}};ce.prototype.afterquote=function(r){if(r==='"'){this.word+='"',this.state=bn;return}if(Wn.test(r)){this.word=this.word.trim(),this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in afterquote yet, index '+this.place)};ce.prototype.afterItem=function(r){if(r===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Fr;return}if(r==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Fr,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Pa);return}};ce.prototype.number=function(r){if(Zh.test(r)){this.word+=r;return}if(Wn.test(r)){this.word=parseFloat(this.word),this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in number yet, index '+this.place)};ce.prototype.quoted=function(r){if(r==='"'){this.state=Hh;return}this.word+=r};ce.prototype.keyword=function(r){if(Zp.test(r)){this.word+=r;return}if(r==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Fr;return}if(Wn.test(r)){this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in keyword yet, index '+this.place)};ce.prototype.neutral=function(r){if(Hp.test(r)){this.word=r,this.state=qh;return}if(r==='"'){this.word="",this.state=bn;return}if(Zh.test(r)){this.word=r,this.state=Vh;return}if(Wn.test(r)){this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in neutral yet, index '+this.place)};ce.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Pa)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Yp(r){var e=new ce(r);return e.output()}function Bo(r,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var n=e?{}:r,i=t.reduce(function(a,o){return qe(o,a),a},n);e&&(r[e]=i)}function qe(r,e){if(!Array.isArray(r)){e[r]=!0;return}var t=r.shift();if(t==="PARAMETER"&&(t=r.shift()),r.length===1){if(Array.isArray(r[0])){e[t]={},qe(r[0],e[t]);return}e[t]=r[0];return}if(!r.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=r;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(r);return}Array.isArray(t)||(e[t]={});var n;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:r[0].toLowerCase(),convert:r[1]},r.length===3&&qe(r[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:r[0],a:r[1],rf:r[2]},r.length===4&&qe(r[3],e[t]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":r[0]=["name",r[0]],Bo(e,t,r);return;default:for(n=-1;++n<r.length;)if(!Array.isArray(r[n]))return qe(r,e[t]);return Bo(e,t,r)}}var Wp=.017453292519943295;function Qp(r,e){var t=e[0],n=e[1];!(t in r)&&n in r&&(r[t]=r[n],e.length===3&&(r[t]=e[2](r[t])))}function ae(r){return r*Wp}function Jp(r){if(r.type==="GEOGCS"?r.projName="longlat":r.type==="LOCAL_CS"?(r.projName="identity",r.local=!0):typeof r.PROJECTION=="object"?r.projName=Object.keys(r.PROJECTION)[0]:r.projName=r.PROJECTION,r.AXIS){for(var e="",t=0,n=r.AXIS.length;t<n;++t){var i=[r.AXIS[t][0].toLowerCase(),r.AXIS[t][1].toLowerCase()];i[0].indexOf("north")!==-1||(i[0]==="y"||i[0]==="lat")&&i[1]==="north"?e+="n":i[0].indexOf("south")!==-1||(i[0]==="y"||i[0]==="lat")&&i[1]==="south"?e+="s":i[0].indexOf("east")!==-1||(i[0]==="x"||i[0]==="lon")&&i[1]==="east"?e+="e":(i[0].indexOf("west")!==-1||(i[0]==="x"||i[0]==="lon")&&i[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(r.axis=e)}r.UNIT&&(r.units=r.UNIT.name.toLowerCase(),r.units==="metre"&&(r.units="meter"),r.UNIT.convert&&(r.type==="GEOGCS"?r.DATUM&&r.DATUM.SPHEROID&&(r.to_meter=r.UNIT.convert*r.DATUM.SPHEROID.a):r.to_meter=r.UNIT.convert));var a=r.GEOGCS;r.type==="GEOGCS"&&(a=r),a&&(a.DATUM?r.datumCode=a.DATUM.name.toLowerCase():r.datumCode=a.name.toLowerCase(),r.datumCode.slice(0,2)==="d_"&&(r.datumCode=r.datumCode.slice(2)),(r.datumCode==="new_zealand_geodetic_datum_1949"||r.datumCode==="new_zealand_1949")&&(r.datumCode="nzgd49"),(r.datumCode==="wgs_1984"||r.datumCode==="world_geodetic_system_1984")&&(r.PROJECTION==="Mercator_Auxiliary_Sphere"&&(r.sphere=!0),r.datumCode="wgs84"),r.datumCode.slice(-6)==="_ferro"&&(r.datumCode=r.datumCode.slice(0,-6)),r.datumCode.slice(-8)==="_jakarta"&&(r.datumCode=r.datumCode.slice(0,-8)),~r.datumCode.indexOf("belge")&&(r.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(r.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),r.ellps.toLowerCase().slice(0,13)==="international"&&(r.ellps="intl"),r.a=a.DATUM.SPHEROID.a,r.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(r.datum_params=a.DATUM.TOWGS84),~r.datumCode.indexOf("osgb_1936")&&(r.datumCode="osgb36"),~r.datumCode.indexOf("osni_1952")&&(r.datumCode="osni52"),(~r.datumCode.indexOf("tm65")||~r.datumCode.indexOf("geodetic_datum_of_1965"))&&(r.datumCode="ire65"),r.datumCode==="ch1903+"&&(r.datumCode="ch1903"),~r.datumCode.indexOf("israel")&&(r.datumCode="isr93")),r.b&&!isFinite(r.b)&&(r.b=r.a);function o(l){var u=r.to_meter||1;return l*u}var s=function(l){return Qp(r,l)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",ae],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",ae],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",ae],["lat0","latitude_of_origin",ae],["lat0","standard_parallel_1",ae],["lat1","standard_parallel_1",ae],["lat2","standard_parallel_2",ae],["azimuth","Azimuth"],["alpha","azimuth",ae],["srsCode","name"]];h.forEach(s),!r.long0&&r.longc&&(r.projName==="Albers_Conic_Equal_Area"||r.projName==="Lambert_Azimuthal_Equal_Area")&&(r.long0=r.longc),!r.lat_ts&&r.lat1&&(r.projName==="Stereographic_South_Pole"||r.projName==="Polar Stereographic (variant B)")&&(r.lat0=ae(r.lat1>0?90:-90),r.lat_ts=r.lat1)}function Yh(r){var e=Yp(r),t=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",t]);var i={};return qe(e,i),Jp(i),i}function Mt(r){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Mt[r]=Ui(arguments[1]):Mt[r]=Yh(arguments[1]):Mt[r]=t}else if(arguments.length===1){if(Array.isArray(r))return r.map(function(n){Array.isArray(n)?Mt.apply(e,n):Mt(n)});if(typeof r=="string"){if(r in Mt)return Mt[r]}else"EPSG"in r?Mt["EPSG:"+r.EPSG]=r:"ESRI"in r?Mt["ESRI:"+r.ESRI]=r:"IAU2000"in r?Mt["IAU2000:"+r.IAU2000]=r:console.log(r);return}}jp(Mt);function tg(r){return typeof r=="string"}function eg(r){return r in Mt}var rg=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function ng(r){return rg.some(function(e){return r.indexOf(e)>-1})}var ig=["3857","900913","3785","102113"];function ag(r){var e=Ee(r,"authority");if(!!e){var t=Ee(e,"epsg");return t&&ig.indexOf(t)>-1}}function og(r){var e=Ee(r,"extension");if(!!e)return Ee(e,"proj4")}function sg(r){return r[0]==="+"}function hg(r){if(tg(r)){if(eg(r))return Mt[r];if(ng(r)){var e=Yh(r);if(ag(e))return Mt["EPSG:3857"];var t=og(e);return t?Ui(t):e}if(sg(r))return Ui(r)}else return r}function jo(r,e){r=r||{};var t,n;if(!e)return r;for(n in e)t=e[n],t!==void 0&&(r[n]=t);return r}function ee(r,e,t){var n=r*e;return t/Math.sqrt(1-n*n)}function qr(r){return r<0?-1:1}function O(r){return Math.abs(r)<=it?r:r-qr(r)*Gr}function Kt(r,e,t){var n=r*t,i=.5*r;return n=Math.pow((1-n)/(1+n),i),Math.tan(.5*(x-e))/n}function Ur(r,e){for(var t=.5*r,n,i,a=x-2*Math.atan(e),o=0;o<=15;o++)if(n=r*Math.sin(a),i=x-2*Math.atan(e*Math.pow((1-n)/(1+n),t))-a,a+=i,Math.abs(i)<=1e-10)return a;return-9999}function lg(){var r=this.b/this.a;this.es=1-r*r,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ee(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function ug(r){var e=r.x,t=r.y;if(t*Wt>90&&t*Wt<-90&&e*Wt>180&&e*Wt<-180)return null;var n,i;if(Math.abs(Math.abs(t)-x)<=C)return null;if(this.sphere)n=this.x0+this.a*this.k0*O(e-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(k+.5*t));else{var a=Math.sin(t),o=Kt(this.e,t,a);n=this.x0+this.a*this.k0*O(e-this.long0),i=this.y0-this.a*this.k0*Math.log(o)}return r.x=n,r.y=i,r}function cg(r){var e=r.x-this.x0,t=r.y-this.y0,n,i;if(this.sphere)i=x-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var a=Math.exp(-t/(this.a*this.k0));if(i=Ur(this.e,a),i===-9999)return null}return n=O(this.long0+e/(this.a*this.k0)),r.x=n,r.y=i,r}var fg=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const vg={init:lg,forward:ug,inverse:cg,names:fg};function dg(){}function Xo(r){return r}var pg=["longlat","identity"];const gg={init:dg,forward:Xo,inverse:Xo,names:pg};var _g=[vg,gg],mn={},Ln=[];function Wh(r,e){var t=Ln.length;return r.names?(Ln[t]=r,r.names.forEach(function(n){mn[n.toLowerCase()]=t}),this):(console.log(e),!0)}function yg(r){if(!r)return!1;var e=r.toLowerCase();if(typeof mn[e]<"u"&&Ln[mn[e]])return Ln[mn[e]]}function mg(){_g.forEach(Wh)}const Eg={start:mg,add:Wh,get:yg};var N={};N.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};N.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};N.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};N.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};N.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};N.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};N.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};N.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};N.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};N.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};N.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};N.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};N.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};N.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};N.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};N.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};N.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};N.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};N.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};N.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};N.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};N.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};N.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};N.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};N.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};N.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};N.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};N.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};N.hough={a:6378270,rf:297,ellipseName:"Hough"};N.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};N.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};N.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};N.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};N.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};N.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};N.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};N.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};N.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};N.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};N.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};N.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Tg=N.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};N.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Mg(r,e,t,n){var i=r*r,a=e*e,o=(i-a)/i,s=0;n?(r*=1-o*(kp+o*($p+o*Kp)),i=r*r,o=0):s=Math.sqrt(o);var h=(i-a)/a;return{es:o,e:s,ep2:h}}function xg(r,e,t,n,i){if(!r){var a=Ee(N,n);a||(a=Tg),r=a.a,e=a.b,t=a.rf}return t&&!e&&(e=(1-1/t)*r),(t===0||Math.abs(r-e)<C)&&(i=!0,e=r),{a:r,b:e,rf:t,sphere:i}}var dt={};dt.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};dt.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};dt.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};dt.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};dt.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};dt.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};dt.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};dt.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};dt.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};dt.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};dt.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};dt.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};dt.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};dt.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};dt.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};dt.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};dt.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function Rg(r,e,t,n,i,a,o){var s={};return r===void 0||r==="none"?s.datum_type=Fi:s.datum_type=Xp,e&&(s.datum_params=e.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=Le),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=Ne,s.datum_params[3]*=Sr,s.datum_params[4]*=Sr,s.datum_params[5]*=Sr,s.datum_params[6]=s.datum_params[6]/1e6+1)),o&&(s.datum_type=yn,s.grids=o),s.a=t,s.b=n,s.es=i,s.ep2=a,s}var Qh={};function wg(r,e){var t=new DataView(e),n=Og(t),i=Sg(t,n);i.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var a=Pg(t,i,n),o={header:i,subgrids:a};return Qh[r]=o,o}function Cg(r){if(r===void 0)return null;var e=r.split(",");return e.map(Ag)}function Ag(r){if(r.length===0)return null;var e=r[0]==="@";return e&&(r=r.slice(1)),r==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:r,mandatory:!e,grid:Qh[r]||null,isNull:!1}}function Ve(r){return r/3600*Math.PI/180}function Og(r){var e=r.getInt32(8,!1);return e===11?!1:(e=r.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Sg(r,e){return{nFields:r.getInt32(8,e),nSubgridFields:r.getInt32(24,e),nSubgrids:r.getInt32(40,e),shiftType:Bi(r,56,56+8).trim(),fromSemiMajorAxis:r.getFloat64(120,e),fromSemiMinorAxis:r.getFloat64(136,e),toSemiMajorAxis:r.getFloat64(152,e),toSemiMinorAxis:r.getFloat64(168,e)}}function Bi(r,e,t){return String.fromCharCode.apply(null,new Uint8Array(r.buffer.slice(e,t)))}function Pg(r,e,t){for(var n=176,i=[],a=0;a<e.nSubgrids;a++){var o=bg(r,n,t),s=Lg(r,n,o,t),h=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),l=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);i.push({ll:[Ve(o.lowerLongitude),Ve(o.lowerLatitude)],del:[Ve(o.longitudeInterval),Ve(o.latitudeInterval)],lim:[h,l],count:o.gridNodeCount,cvs:Ig(s)})}return i}function Ig(r){return r.map(function(e){return[Ve(e.longitudeShift),Ve(e.latitudeShift)]})}function bg(r,e,t){return{name:Bi(r,e+8,e+16).trim(),parent:Bi(r,e+24,e+24+8).trim(),lowerLatitude:r.getFloat64(e+72,t),upperLatitude:r.getFloat64(e+88,t),lowerLongitude:r.getFloat64(e+104,t),upperLongitude:r.getFloat64(e+120,t),latitudeInterval:r.getFloat64(e+136,t),longitudeInterval:r.getFloat64(e+152,t),gridNodeCount:r.getInt32(e+168,t)}}function Lg(r,e,t,n){for(var i=e+176,a=16,o=[],s=0;s<t.gridNodeCount;s++){var h={latitudeShift:r.getFloat32(i+s*a,n),longitudeShift:r.getFloat32(i+s*a+4,n),latitudeAccuracy:r.getFloat32(i+s*a+8,n),longitudeAccuracy:r.getFloat32(i+s*a+12,n)};o.push(h)}return o}function Qt(r,e){if(!(this instanceof Qt))return new Qt(r);e=e||function(l){if(l)throw l};var t=hg(r);if(typeof t!="object"){e(r);return}var n=Qt.projections.get(t.projName);if(!n){e(r);return}if(t.datumCode&&t.datumCode!=="none"){var i=Ee(dt,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var a=xg(t.a,t.b,t.rf,t.ellps,t.sphere),o=Mg(a.a,a.b,a.rf,t.R_A),s=Cg(t.nadgrids),h=t.datum||Rg(t.datumCode,t.datum_params,a.a,a.b,o.es,o.ep2,s);jo(this,t),jo(this,n),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=h,this.init(),e(null,this)}Qt.projections=Eg;Qt.projections.start();function Ng(r,e){return r.datum_type!==e.datum_type||r.a!==e.a||Math.abs(r.es-e.es)>5e-11?!1:r.datum_type===Le?r.datum_params[0]===e.datum_params[0]&&r.datum_params[1]===e.datum_params[1]&&r.datum_params[2]===e.datum_params[2]:r.datum_type===Ne?r.datum_params[0]===e.datum_params[0]&&r.datum_params[1]===e.datum_params[1]&&r.datum_params[2]===e.datum_params[2]&&r.datum_params[3]===e.datum_params[3]&&r.datum_params[4]===e.datum_params[4]&&r.datum_params[5]===e.datum_params[5]&&r.datum_params[6]===e.datum_params[6]:!0}function Jh(r,e,t){var n=r.x,i=r.y,a=r.z?r.z:0,o,s,h,l;if(i<-x&&i>-1.001*x)i=-x;else if(i>x&&i<1.001*x)i=x;else{if(i<-x)return{x:-1/0,y:-1/0,z:r.z};if(i>x)return{x:1/0,y:1/0,z:r.z}}return n>Math.PI&&(n-=2*Math.PI),s=Math.sin(i),l=Math.cos(i),h=s*s,o=t/Math.sqrt(1-e*h),{x:(o+a)*l*Math.cos(n),y:(o+a)*l*Math.sin(n),z:(o*(1-e)+a)*s}}function tl(r,e,t,n){var i=1e-12,a=i*i,o=30,s,h,l,u,c,f,v,d,p,g,y,_,m,E=r.x,T=r.y,M=r.z?r.z:0,R,w,S;if(s=Math.sqrt(E*E+T*T),h=Math.sqrt(E*E+T*T+M*M),s/t<i){if(R=0,h/t<i)return w=x,S=-n,{x:r.x,y:r.y,z:r.z}}else R=Math.atan2(T,E);l=M/h,u=s/h,c=1/Math.sqrt(1-e*(2-e)*u*u),d=u*(1-e)*c,p=l*c,m=0;do m++,v=t/Math.sqrt(1-e*p*p),S=s*d+M*p-v*(1-e*p*p),f=e*v/(v+S),c=1/Math.sqrt(1-f*(2-f)*u*u),g=u*(1-f)*c,y=l*c,_=y*d-g*p,d=g,p=y;while(_*_>a&&m<o);return w=Math.atan(y/Math.abs(g)),{x:R,y:w,z:S}}function Dg(r,e,t){if(e===Le)return{x:r.x+t[0],y:r.y+t[1],z:r.z+t[2]};if(e===Ne){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],h=t[5],l=t[6];return{x:l*(r.x-h*r.y+s*r.z)+n,y:l*(h*r.x+r.y-o*r.z)+i,z:l*(-s*r.x+o*r.y+r.z)+a}}}function Gg(r,e,t){if(e===Le)return{x:r.x-t[0],y:r.y-t[1],z:r.z-t[2]};if(e===Ne){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],h=t[5],l=t[6],u=(r.x-n)/l,c=(r.y-i)/l,f=(r.z-a)/l;return{x:u+h*c-s*f,y:-h*u+c+o*f,z:s*u-o*c+f}}}function un(r){return r===Le||r===Ne}function Fg(r,e,t){if(Ng(r,e)||r.datum_type===Fi||e.datum_type===Fi)return t;var n=r.a,i=r.es;if(r.datum_type===yn){var a=zo(r,!1,t);if(a!==0)return;n=Go,i=Fo}var o=e.a,s=e.b,h=e.es;if(e.datum_type===yn&&(o=Go,s=zp,h=Fo),i===h&&n===o&&!un(r.datum_type)&&!un(e.datum_type))return t;if(t=Jh(t,i,n),un(r.datum_type)&&(t=Dg(t,r.datum_type,r.datum_params)),un(e.datum_type)&&(t=Gg(t,e.datum_type,e.datum_params)),t=tl(t,h,o,s),e.datum_type===yn){var l=zo(e,!0,t);if(l!==0)return}return t}function zo(r,e,t){if(r.grids===null||r.grids.length===0)return console.log("Grid shift grids not found"),-1;for(var n={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},a=[],o=0;o<r.grids.length;o++){var s=r.grids[o];if(a.push(s.name),s.isNull){i=n;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}var h=s.grid.subgrids[0],l=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,u=h.ll[0]-l,c=h.ll[1]-l,f=h.ll[0]+(h.lim[0]-1)*h.del[0]+l,v=h.ll[1]+(h.lim[1]-1)*h.del[1]+l;if(!(c>n.y||u>n.x||v<n.y||f<n.x)&&(i=Ug(n,e,h),!isNaN(i.x)))break}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*Wt+" "+n.y*Wt+" tried: '"+a+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function Ug(r,e,t){var n={x:Number.NaN,y:Number.NaN};if(isNaN(r.x))return n;var i={x:r.x,y:r.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=O(i.x-Math.PI)+Math.PI;var a=ko(i,t);if(e){if(isNaN(a.x))return n;a.x=i.x-a.x,a.y=i.y-a.y;var o=9,s=1e-12,h,l;do{if(l=ko(a,t),isNaN(l.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}h={x:i.x-(l.x+a.x),y:i.y-(l.y+a.y)},a.x+=h.x,a.y+=h.y}while(o--&&Math.abs(h.x)>s&&Math.abs(h.y)>s);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=O(a.x+t.ll[0]),n.y=a.y+t.ll[1]}else isNaN(a.x)||(n.x=r.x+a.x,n.y=r.y+a.y);return n}function ko(r,e){var t={x:r.x/e.del[0],y:r.y/e.del[1]},n={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*n.x,y:t.y-1*n.y},a={x:Number.NaN,y:Number.NaN},o;if(n.x<0||n.x>=e.lim[0]||n.y<0||n.y>=e.lim[1])return a;o=n.y*e.lim[0]+n.x;var s={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var h={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var l={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var u={x:e.cvs[o][0],y:e.cvs[o][1]},c=i.x*i.y,f=i.x*(1-i.y),v=(1-i.x)*(1-i.y),d=(1-i.x)*i.y;return a.x=v*s.x+f*h.x+d*u.x+c*l.x,a.y=v*s.y+f*h.y+d*u.y+c*l.y,a}function $o(r,e,t){var n=t.x,i=t.y,a=t.z||0,o,s,h,l={};for(h=0;h<3;h++)if(!(e&&h===2&&t.z===void 0))switch(h===0?(o=n,"ew".indexOf(r.axis[h])!==-1?s="x":s="y"):h===1?(o=i,"ns".indexOf(r.axis[h])!==-1?s="y":s="x"):(o=a,s="z"),r.axis[h]){case"e":l[s]=o;break;case"w":l[s]=-o;break;case"n":l[s]=o;break;case"s":l[s]=-o;break;case"u":t[s]!==void 0&&(l.z=o);break;case"d":t[s]!==void 0&&(l.z=-o);break;default:return null}return l}function el(r){var e={x:r[0],y:r[1]};return r.length>2&&(e.z=r[2]),r.length>3&&(e.m=r[3]),e}function Bg(r){Ko(r.x),Ko(r.y)}function Ko(r){if(typeof Number.isFinite=="function"){if(Number.isFinite(r))return;throw new TypeError("coordinates must be finite numbers")}if(typeof r!="number"||r!==r||!isFinite(r))throw new TypeError("coordinates must be finite numbers")}function jg(r,e){return(r.datum.datum_type===Le||r.datum.datum_type===Ne)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Le||e.datum.datum_type===Ne)&&r.datumCode!=="WGS84"}function Nn(r,e,t,n){var i;if(Array.isArray(t)&&(t=el(t)),Bg(t),r.datum&&e.datum&&jg(r,e)&&(i=new Qt("WGS84"),t=Nn(r,i,t,n),r=i),n&&r.axis!=="enu"&&(t=$o(r,!1,t)),r.projName==="longlat")t={x:t.x*pt,y:t.y*pt,z:t.z||0};else if(r.to_meter&&(t={x:t.x*r.to_meter,y:t.y*r.to_meter,z:t.z||0}),t=r.inverse(t),!t)return;if(r.from_greenwich&&(t.x+=r.from_greenwich),t=Fg(r.datum,e.datum,t),!!t)return e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Wt,y:t.y*Wt,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),n&&e.axis!=="enu"?$o(e,!0,t):t}var qo=Qt("WGS84");function mi(r,e,t,n){var i,a,o;return Array.isArray(t)?(i=Nn(r,e,t,n)||{x:NaN,y:NaN},t.length>2?typeof r.name<"u"&&r.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.splice(3)):[i.x,i.y,t[2]].concat(t.splice(3)):[i.x,i.y].concat(t.splice(2)):[i.x,i.y]):(a=Nn(r,e,t,n),o=Object.keys(t),o.length===2||o.forEach(function(s){if(typeof r.name<"u"&&r.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;a[s]=t[s]}),a)}function Vo(r){return r instanceof Qt?r:r.oProj?r.oProj:Qt(r)}function Ot(r,e,t){r=Vo(r);var n=!1,i;return typeof e>"u"?(e=r,r=qo,n=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,e=r,r=qo,n=!0),e=Vo(e),t?mi(r,e,t):(i={forward:function(a,o){return mi(r,e,a,o)},inverse:function(a,o){return mi(e,r,a,o)}},n&&(i.oProj=e),i)}var Ho=6,rl="AJSAJS",nl="AFAFAF",He=65,wt=73,Dt=79,Mr=86,xr=90;const Xg={forward:il,inverse:zg,toPoint:al};function il(r,e){return e=e||5,Kg(kg({lat:r[1],lon:r[0]}),e)}function zg(r){var e=Ia(sl(r.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function al(r){var e=Ia(sl(r.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Ei(r){return r*(Math.PI/180)}function Zo(r){return 180*(r/Math.PI)}function kg(r){var e=r.lat,t=r.lon,n=6378137,i=.00669438,a=.9996,o,s,h,l,u,c,f,v=Ei(e),d=Ei(t),p,g;g=Math.floor((t+180)/6)+1,t===180&&(g=60),e>=56&&e<64&&t>=3&&t<12&&(g=32),e>=72&&e<84&&(t>=0&&t<9?g=31:t>=9&&t<21?g=33:t>=21&&t<33?g=35:t>=33&&t<42&&(g=37)),o=(g-1)*6-180+3,p=Ei(o),s=i/(1-i),h=n/Math.sqrt(1-i*Math.sin(v)*Math.sin(v)),l=Math.tan(v)*Math.tan(v),u=s*Math.cos(v)*Math.cos(v),c=Math.cos(v)*(d-p),f=n*((1-i/4-3*i*i/64-5*i*i*i/256)*v-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*v)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*v)-35*i*i*i/3072*Math.sin(6*v));var y=a*h*(c+(1-l+u)*c*c*c/6+(5-18*l+l*l+72*u-58*s)*c*c*c*c*c/120)+5e5,_=a*(f+h*Math.tan(v)*(c*c/2+(5-l+9*u+4*u*u)*c*c*c*c/24+(61-58*l+l*l+600*u-330*s)*c*c*c*c*c*c/720));return e<0&&(_+=1e7),{northing:Math.round(_),easting:Math.round(y),zoneNumber:g,zoneLetter:$g(e)}}function Ia(r){var e=r.northing,t=r.easting,n=r.zoneLetter,i=r.zoneNumber;if(i<0||i>60)return null;var a=.9996,o=6378137,s=.00669438,h,l=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),u,c,f,v,d,p,g,y,_,m=t-5e5,E=e;n<"N"&&(E-=1e7),g=(i-1)*6-180+3,h=s/(1-s),p=E/a,y=p/(o*(1-s/4-3*s*s/64-5*s*s*s/256)),_=y+(3*l/2-27*l*l*l/32)*Math.sin(2*y)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*y)+151*l*l*l/96*Math.sin(6*y),u=o/Math.sqrt(1-s*Math.sin(_)*Math.sin(_)),c=Math.tan(_)*Math.tan(_),f=h*Math.cos(_)*Math.cos(_),v=o*(1-s)/Math.pow(1-s*Math.sin(_)*Math.sin(_),1.5),d=m/(u*a);var T=_-u*Math.tan(_)/v*(d*d/2-(5+3*c+10*f-4*f*f-9*h)*d*d*d*d/24+(61+90*c+298*f+45*c*c-252*h-3*f*f)*d*d*d*d*d*d/720);T=Zo(T);var M=(d-(1+2*c+f)*d*d*d/6+(5-2*f+28*c-3*f*f+8*h+24*c*c)*d*d*d*d*d/120)/Math.cos(_);M=g+Zo(M);var R;if(r.accuracy){var w=Ia({northing:r.northing+r.accuracy,easting:r.easting+r.accuracy,zoneLetter:r.zoneLetter,zoneNumber:r.zoneNumber});R={top:w.lat,right:w.lon,bottom:T,left:M}}else R={lat:T,lon:M};return R}function $g(r){var e="Z";return 84>=r&&r>=72?e="X":72>r&&r>=64?e="W":64>r&&r>=56?e="V":56>r&&r>=48?e="U":48>r&&r>=40?e="T":40>r&&r>=32?e="S":32>r&&r>=24?e="R":24>r&&r>=16?e="Q":16>r&&r>=8?e="P":8>r&&r>=0?e="N":0>r&&r>=-8?e="M":-8>r&&r>=-16?e="L":-16>r&&r>=-24?e="K":-24>r&&r>=-32?e="J":-32>r&&r>=-40?e="H":-40>r&&r>=-48?e="G":-48>r&&r>=-56?e="F":-56>r&&r>=-64?e="E":-64>r&&r>=-72?e="D":-72>r&&r>=-80&&(e="C"),e}function Kg(r,e){var t="00000"+r.easting,n="00000"+r.northing;return r.zoneNumber+r.zoneLetter+qg(r.easting,r.northing,r.zoneNumber)+t.substr(t.length-5,e)+n.substr(n.length-5,e)}function qg(r,e,t){var n=ol(t),i=Math.floor(r/1e5),a=Math.floor(e/1e5)%20;return Vg(i,a,n)}function ol(r){var e=r%Ho;return e===0&&(e=Ho),e}function Vg(r,e,t){var n=t-1,i=rl.charCodeAt(n),a=nl.charCodeAt(n),o=i+r-1,s=a+e,h=!1;o>xr&&(o=o-xr+He-1,h=!0),(o===wt||i<wt&&o>wt||(o>wt||i<wt)&&h)&&o++,(o===Dt||i<Dt&&o>Dt||(o>Dt||i<Dt)&&h)&&(o++,o===wt&&o++),o>xr&&(o=o-xr+He-1),s>Mr?(s=s-Mr+He-1,h=!0):h=!1,(s===wt||a<wt&&s>wt||(s>wt||a<wt)&&h)&&s++,(s===Dt||a<Dt&&s>Dt||(s>Dt||a<Dt)&&h)&&(s++,s===wt&&s++),s>Mr&&(s=s-Mr+He-1);var l=String.fromCharCode(o)+String.fromCharCode(s);return l}function sl(r){if(r&&r.length===0)throw"MGRSPoint coverting from nothing";for(var e=r.length,t=null,n="",i,a=0;!/[A-Z]/.test(i=r.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+r;n+=i,a++}var o=parseInt(n,10);if(a===0||a+3>e)throw"MGRSPoint bad conversion from: "+r;var s=r.charAt(a++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+r;t=r.substring(a,a+=2);for(var h=ol(o),l=Hg(t.charAt(0),h),u=Zg(t.charAt(1),h);u<Yg(s);)u+=2e6;var c=e-a;if(c%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+r;var f=c/2,v=0,d=0,p,g,y,_,m;return f>0&&(p=1e5/Math.pow(10,f),g=r.substring(a,a+f),v=parseFloat(g)*p,y=r.substring(a+f),d=parseFloat(y)*p),_=v+l,m=d+u,{easting:_,northing:m,zoneLetter:s,zoneNumber:o,accuracy:p}}function Hg(r,e){for(var t=rl.charCodeAt(e-1),n=1e5,i=!1;t!==r.charCodeAt(0);){if(t++,t===wt&&t++,t===Dt&&t++,t>xr){if(i)throw"Bad character: "+r;t=He,i=!0}n+=1e5}return n}function Zg(r,e){if(r>"V")throw"MGRSPoint given invalid Northing "+r;for(var t=nl.charCodeAt(e-1),n=0,i=!1;t!==r.charCodeAt(0);){if(t++,t===wt&&t++,t===Dt&&t++,t>Mr){if(i)throw"Bad character: "+r;t=He,i=!0}n+=1e5}return n}function Yg(r){var e;switch(r){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+r}function hr(r,e,t){if(!(this instanceof hr))return new hr(r,e,t);if(Array.isArray(r))this.x=r[0],this.y=r[1],this.z=r[2]||0;else if(typeof r=="object")this.x=r.x,this.y=r.y,this.z=r.z||0;else if(typeof r=="string"&&typeof e>"u"){var n=r.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=r,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}hr.fromMGRS=function(r){return new hr(al(r))};hr.prototype.toMGRS=function(r){return il([this.x,this.y],r)};var Wg=1,Qg=.25,Yo=.046875,Wo=.01953125,Qo=.01068115234375,Jg=.75,t_=.46875,e_=.013020833333333334,r_=.007120768229166667,n_=.3645833333333333,i_=.005696614583333333,a_=.3076171875;function hl(r){var e=[];e[0]=Wg-r*(Qg+r*(Yo+r*(Wo+r*Qo))),e[1]=r*(Jg-r*(Yo+r*(Wo+r*Qo)));var t=r*r;return e[2]=t*(t_-r*(e_+r*r_)),t*=r,e[3]=t*(n_-r*i_),e[4]=t*r*a_,e}function Qn(r,e,t,n){return t*=e,e*=e,n[0]*r-t*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}var o_=20;function ll(r,e,t){for(var n=1/(1-e),i=r,a=o_;a;--a){var o=Math.sin(i),s=1-e*o*o;if(s=(Qn(i,o,Math.cos(i),t)-r)*(s*Math.sqrt(s))*n,i-=s,Math.abs(s)<C)return i}return i}function s_(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=hl(this.es),this.ml0=Qn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function h_(r){var e=r.x,t=r.y,n=O(e-this.long0),i,a,o,s=Math.sin(t),h=Math.cos(t);if(this.es){var u=h*n,c=Math.pow(u,2),f=this.ep2*Math.pow(h,2),v=Math.pow(f,2),d=Math.abs(h)>C?Math.tan(t):0,p=Math.pow(d,2),g=Math.pow(p,2);i=1-this.es*Math.pow(s,2),u=u/Math.sqrt(i);var y=Qn(t,s,h,this.en);a=this.a*(this.k0*u*(1+c/6*(1-p+f+c/20*(5-18*p+g+14*f-58*p*f+c/42*(61+179*g-g*p-479*p)))))+this.x0,o=this.a*(this.k0*(y-this.ml0+s*n*u/2*(1+c/12*(5-p+9*f+4*v+c/30*(61+g-58*p+270*f-330*p*f+c/56*(1385+543*g-g*p-3111*p))))))+this.y0}else{var l=h*Math.sin(n);if(Math.abs(Math.abs(l)-1)<C)return 93;if(a=.5*this.a*this.k0*Math.log((1+l)/(1-l))+this.x0,o=h*Math.cos(n)/Math.sqrt(1-Math.pow(l,2)),l=Math.abs(o),l>=1){if(l-1>C)return 93;o=0}else o=Math.acos(o);t<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return r.x=a,r.y=o,r}function l_(r){var e,t,n,i,a=(r.x-this.x0)*(1/this.a),o=(r.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,t=ll(e,this.es,this.en),Math.abs(t)<x){var c=Math.sin(t),f=Math.cos(t),v=Math.abs(f)>C?Math.tan(t):0,d=this.ep2*Math.pow(f,2),p=Math.pow(d,2),g=Math.pow(v,2),y=Math.pow(g,2);e=1-this.es*Math.pow(c,2);var _=a*Math.sqrt(e)/this.k0,m=Math.pow(_,2);e=e*v,n=t-e*m/(1-this.es)*.5*(1-m/12*(5+3*g-9*d*g+d-4*p-m/30*(61+90*g-252*d*g+45*y+46*d-m/56*(1385+3633*g+4095*y+1574*y*g)))),i=O(this.long0+_*(1-m/6*(1+2*g+d-m/20*(5+28*g+24*y+8*d*g+6*d-m/42*(61+662*g+1320*y+720*y*g))))/f)}else n=x*qr(o),i=0;else{var s=Math.exp(a/this.k0),h=.5*(s-1/s),l=this.lat0+o/this.k0,u=Math.cos(l);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(h,2))),n=Math.asin(e),o<0&&(n=-n),h===0&&u===0?i=0:i=O(Math.atan2(h,u)+this.long0)}return r.x=i,r.y=n,r}var u_=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const En={init:s_,forward:h_,inverse:l_,names:u_};function ul(r){var e=Math.exp(r);return e=(e-1/e)/2,e}function kt(r,e){r=Math.abs(r),e=Math.abs(e);var t=Math.max(r,e),n=Math.min(r,e)/(t||1);return t*Math.sqrt(1+Math.pow(n,2))}function c_(r){var e=1+r,t=e-1;return t===0?r:r*Math.log(e)/t}function f_(r){var e=Math.abs(r);return e=c_(e*(1+e/(kt(1,e)+1))),r<0?-e:e}function ba(r,e){for(var t=2*Math.cos(2*e),n=r.length-1,i=r[n],a=0,o;--n>=0;)o=-a+t*i+r[n],a=i,i=o;return e+o*Math.sin(2*e)}function v_(r,e){for(var t=2*Math.cos(e),n=r.length-1,i=r[n],a=0,o;--n>=0;)o=-a+t*i+r[n],a=i,i=o;return Math.sin(e)*o}function d_(r){var e=Math.exp(r);return e=(e+1/e)/2,e}function cl(r,e,t){for(var n=Math.sin(e),i=Math.cos(e),a=ul(t),o=d_(t),s=2*i*o,h=-2*n*a,l=r.length-1,u=r[l],c=0,f=0,v=0,d,p;--l>=0;)d=f,p=c,f=u,c=v,u=-d+s*f-h*c+r[l],v=-p+h*f+s*c;return s=n*o,h=i*a,[s*u-h*v,s*v+h*u]}function p_(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(En.init.apply(this),this.forward=En.forward,this.inverse=En.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var r=this.es/(1+Math.sqrt(1-this.es)),e=r/(2-r),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var n=ba(this.cbg,this.lat0);this.Zb=-this.Qn*(n+v_(this.gtu,2*n))}function g_(r){var e=O(r.x-this.long0),t=r.y;t=ba(this.cbg,t);var n=Math.sin(t),i=Math.cos(t),a=Math.sin(e),o=Math.cos(e);t=Math.atan2(n,o*i),e=Math.atan2(a*i,kt(n,i*o)),e=f_(Math.tan(e));var s=cl(this.gtu,2*t,2*e);t=t+s[0],e=e+s[1];var h,l;return Math.abs(e)<=2.623395162778?(h=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*t+this.Zb)+this.y0):(h=1/0,l=1/0),r.x=h,r.y=l,r}function __(r){var e=(r.x-this.x0)*(1/this.a),t=(r.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var n,i;if(Math.abs(e)<=2.623395162778){var a=cl(this.utg,2*t,2*e);t=t+a[0],e=e+a[1],e=Math.atan(ul(e));var o=Math.sin(t),s=Math.cos(t),h=Math.sin(e),l=Math.cos(e);t=Math.atan2(o*l,kt(h,l*s)),e=Math.atan2(h,l*s),n=O(e+this.long0),i=ba(this.cgb,t)}else n=1/0,i=1/0;return r.x=n,r.y=i,r}var y_=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"];const Tn={init:p_,forward:g_,inverse:__,names:y_};function m_(r,e){if(r===void 0){if(r=Math.floor((O(e)+Math.PI)*30/Math.PI)+1,r<0)return 0;if(r>60)return 60}return r}var E_="etmerc";function T_(){var r=m_(this.zone,this.long0);if(r===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(r)-183)*pt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Tn.init.apply(this),this.forward=Tn.forward,this.inverse=Tn.inverse}var M_=["Universal Transverse Mercator System","utm"];const x_={init:T_,names:M_,dependsOn:E_};function La(r,e){return Math.pow((1-r)/(1+r),e)}var R_=20;function w_(){var r=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*r*r),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(r/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+k)/(Math.pow(Math.tan(.5*this.lat0+k),this.C)*La(this.e*r,this.ratexp))}function C_(r){var e=r.x,t=r.y;return r.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+k),this.C)*La(this.e*Math.sin(t),this.ratexp))-x,r.x=this.C*e,r}function A_(r){for(var e=1e-14,t=r.x/this.C,n=r.y,i=Math.pow(Math.tan(.5*n+k)/this.K,1/this.C),a=R_;a>0&&(n=2*Math.atan(i*La(this.e*Math.sin(r.y),-.5*this.e))-x,!(Math.abs(n-r.y)<e));--a)r.y=n;return a?(r.x=t,r.y=n,r):null}var O_=["gauss"];const Na={init:w_,forward:C_,inverse:A_,names:O_};function S_(){Na.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function P_(r){var e,t,n,i;return r.x=O(r.x-this.long0),Na.forward.apply(this,[r]),e=Math.sin(r.y),t=Math.cos(r.y),n=Math.cos(r.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*n),r.x=i*t*Math.sin(r.x),r.y=i*(this.cosc0*e-this.sinc0*t*n),r.x=this.a*r.x+this.x0,r.y=this.a*r.y+this.y0,r}function I_(r){var e,t,n,i,a;if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,a=Math.sqrt(r.x*r.x+r.y*r.y)){var o=2*Math.atan2(a,this.R2);e=Math.sin(o),t=Math.cos(o),i=Math.asin(t*this.sinc0+r.y*e*this.cosc0/a),n=Math.atan2(r.x*e,a*this.cosc0*t-r.y*this.sinc0*e)}else i=this.phic0,n=0;return r.x=n,r.y=i,Na.inverse.apply(this,[r]),r.x=O(r.x+this.long0),r}var b_=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const L_={init:S_,forward:P_,inverse:I_,names:b_};function N_(r,e,t){return e*=t,Math.tan(.5*(x+r))*Math.pow((1-e)/(1+e),.5*t)}function D_(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=C&&(this.k0=.5*(1+qr(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=C&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=C&&(this.k0=.5*this.cons*ee(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Kt(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ee(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-x,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function G_(r){var e=r.x,t=r.y,n=Math.sin(t),i=Math.cos(t),a,o,s,h,l,u,c=O(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=C&&Math.abs(t+this.lat0)<=C?(r.x=NaN,r.y=NaN,r):this.sphere?(a=2*this.k0/(1+this.sinlat0*n+this.coslat0*i*Math.cos(c)),r.x=this.a*a*i*Math.sin(c)+this.x0,r.y=this.a*a*(this.coslat0*n-this.sinlat0*i*Math.cos(c))+this.y0,r):(o=2*Math.atan(this.ssfn_(t,n,this.e))-x,h=Math.cos(o),s=Math.sin(o),Math.abs(this.coslat0)<=C?(l=Kt(this.e,t*this.con,this.con*n),u=2*this.a*this.k0*l/this.cons,r.x=this.x0+u*Math.sin(e-this.long0),r.y=this.y0-this.con*u*Math.cos(e-this.long0),r):(Math.abs(this.sinlat0)<C?(a=2*this.a*this.k0/(1+h*Math.cos(c)),r.y=a*s):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*h*Math.cos(c))),r.y=a*(this.cosX0*s-this.sinX0*h*Math.cos(c))+this.y0),r.x=a*h*Math.sin(c)+this.x0,r))}function F_(r){r.x-=this.x0,r.y-=this.y0;var e,t,n,i,a,o=Math.sqrt(r.x*r.x+r.y*r.y);if(this.sphere){var s=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,t=this.lat0,o<=C?(r.x=e,r.y=t,r):(t=Math.asin(Math.cos(s)*this.sinlat0+r.y*Math.sin(s)*this.coslat0/o),Math.abs(this.coslat0)<C?this.lat0>0?e=O(this.long0+Math.atan2(r.x,-1*r.y)):e=O(this.long0+Math.atan2(r.x,r.y)):e=O(this.long0+Math.atan2(r.x*Math.sin(s),o*this.coslat0*Math.cos(s)-r.y*this.sinlat0*Math.sin(s))),r.x=e,r.y=t,r)}else if(Math.abs(this.coslat0)<=C){if(o<=C)return t=this.lat0,e=this.long0,r.x=e,r.y=t,r;r.x*=this.con,r.y*=this.con,n=o*this.cons/(2*this.a*this.k0),t=this.con*Ur(this.e,n),e=this.con*O(this.con*this.long0+Math.atan2(r.x,-1*r.y))}else i=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=C?a=this.X0:(a=Math.asin(Math.cos(i)*this.sinX0+r.y*Math.sin(i)*this.cosX0/o),e=O(this.long0+Math.atan2(r.x*Math.sin(i),o*this.cosX0*Math.cos(i)-r.y*this.sinX0*Math.sin(i)))),t=-1*Ur(this.e,Math.tan(.5*(x+a)));return r.x=e,r.y=t,r}var U_=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"];const B_={init:D_,forward:G_,inverse:F_,names:U_,ssfn_:N_};function j_(){var r=this.lat0;this.lambda0=this.long0;var e=Math.sin(r),t=this.a,n=this.rf,i=1/n,a=2*i-Math.pow(i,2),o=this.e=Math.sqrt(a);this.R=this.k0*t*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(r),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),h=Math.log(Math.tan(Math.PI/4+r/2)),l=Math.log((1+o*e)/(1-o*e));this.K=s-this.alpha*h+this.alpha*o/2*l}function X_(r){var e=Math.log(Math.tan(Math.PI/4-r.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(r.y))/(1-this.e*Math.sin(r.y))),n=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(n))-Math.PI/4),a=this.alpha*(r.x-this.lambda0),o=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(a))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(a));return r.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,r.x=this.R*o+this.x0,r}function z_(r){for(var e=r.x-this.x0,t=r.y-this.y0,n=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(n)),o=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+o/this.alpha,h=0,l=a,u=-1e3,c=0;Math.abs(l-u)>1e-7;){if(++c>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(h))-Math.PI/2}return r.x=s,r.y=l,r}var k_=["somerc"];const $_={init:j_,forward:X_,inverse:z_,names:k_};var ke=1e-7;function K_(r){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof r.PROJECTION=="object"?Object.keys(r.PROJECTION)[0]:r.PROJECTION;return"no_uoff"in r||"no_off"in r||e.indexOf(t)!==-1}function q_(){var r,e,t,n,i,a,o,s,h,l,u=0,c,f=0,v=0,d=0,p=0,g=0,y=0;this.no_off=K_(this),this.no_rot="no_rot"in this;var _=!1;"alpha"in this&&(_=!0);var m=!1;if("rectified_grid_angle"in this&&(m=!0),_&&(y=this.alpha),m&&(u=this.rectified_grid_angle*pt),_||m)f=this.longc;else if(v=this.long1,p=this.lat1,d=this.long2,g=this.lat2,Math.abs(p-g)<=ke||(r=Math.abs(p))<=ke||Math.abs(r-x)<=ke||Math.abs(Math.abs(this.lat0)-x)<=ke||Math.abs(Math.abs(g)-x)<=ke)throw new Error;var E=1-this.es;e=Math.sqrt(E),Math.abs(this.lat0)>C?(s=Math.sin(this.lat0),t=Math.cos(this.lat0),r=1-this.es*s*s,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/E),this.A=this.B*this.k0*e/r,n=this.B*e/(t*Math.sqrt(r)),i=n*n-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=n,this.E*=Math.pow(Kt(this.e,this.lat0,s),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=i=1),_||m?(_?(c=Math.asin(Math.sin(y)/n),m||(u=y)):(c=u,y=Math.asin(n*Math.sin(c))),this.lam0=f-Math.asin(.5*(i-1/i)*Math.tan(c))/this.B):(a=Math.pow(Kt(this.e,p,Math.sin(p)),this.B),o=Math.pow(Kt(this.e,g,Math.sin(g)),this.B),i=this.E/a,h=(o-a)/(o+a),l=this.E*this.E,l=(l-o*a)/(l+o*a),r=v-d,r<-Math.pi?d-=Gr:r>Math.pi&&(d+=Gr),this.lam0=O(.5*(v+d)-Math.atan(l*Math.tan(.5*this.B*(v-d))/h)/this.B),c=Math.atan(2*Math.sin(this.B*O(v-this.lam0))/(i-1/i)),u=y=Math.asin(n*Math.sin(c))),this.singam=Math.sin(c),this.cosgam=Math.cos(c),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(y))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*c,this.v_pole_n=this.ArB*Math.log(Math.tan(k-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(k+i))}function V_(r){var e={},t,n,i,a,o,s,h,l;if(r.x=r.x-this.lam0,Math.abs(Math.abs(r.y)-x)>C){if(o=this.E/Math.pow(Kt(this.e,r.y,Math.sin(r.y)),this.B),s=1/o,t=.5*(o-s),n=.5*(o+s),a=Math.sin(this.B*r.x),i=(t*this.singam-a*this.cosgam)/n,Math.abs(Math.abs(i)-1)<C)throw new Error;l=.5*this.ArB*Math.log((1-i)/(1+i)),s=Math.cos(this.B*r.x),Math.abs(s)<ke?h=this.A*r.x:h=this.ArB*Math.atan2(t*this.cosgam+a*this.singam,s)}else l=r.y>0?this.v_pole_n:this.v_pole_s,h=this.ArB*r.y;return this.no_rot?(e.x=h,e.y=l):(h-=this.u_0,e.x=l*this.cosrot+h*this.sinrot,e.y=h*this.cosrot-l*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function H_(r){var e,t,n,i,a,o,s,h={};if(r.x=(r.x-this.x0)*(1/this.a),r.y=(r.y-this.y0)*(1/this.a),this.no_rot?(t=r.y,e=r.x):(t=r.x*this.cosrot-r.y*this.sinrot,e=r.y*this.cosrot+r.x*this.sinrot+this.u_0),n=Math.exp(-this.BrA*t),i=.5*(n-1/n),a=.5*(n+1/n),o=Math.sin(this.BrA*e),s=(o*this.cosgam+i*this.singam)/a,Math.abs(Math.abs(s)-1)<C)h.x=0,h.y=s<0?-x:x;else{if(h.y=this.E/Math.sqrt((1+s)/(1-s)),h.y=Ur(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(i*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h}var Z_=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Y_={init:q_,forward:V_,inverse:H_,names:Z_};function W_(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<C)){var r=this.b/this.a;this.e=Math.sqrt(1-r*r);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),n=ee(this.e,e,t),i=Kt(this.e,this.lat1,e),a=Math.sin(this.lat2),o=Math.cos(this.lat2),s=ee(this.e,a,o),h=Kt(this.e,this.lat2,a),l=Kt(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>C?this.ns=Math.log(n/s)/Math.log(i/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Q_(r){var e=r.x,t=r.y;Math.abs(2*Math.abs(t)-Math.PI)<=C&&(t=qr(t)*(x-2*C));var n=Math.abs(Math.abs(t)-x),i,a;if(n>C)i=Kt(this.e,t,Math.sin(t)),a=this.a*this.f0*Math.pow(i,this.ns);else{if(n=t*this.ns,n<=0)return null;a=0}var o=this.ns*O(e-this.long0);return r.x=this.k0*(a*Math.sin(o))+this.x0,r.y=this.k0*(this.rh-a*Math.cos(o))+this.y0,r}function J_(r){var e,t,n,i,a,o=(r.x-this.x0)/this.k0,s=this.rh-(r.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+s*s),t=1):(e=-Math.sqrt(o*o+s*s),t=-1);var h=0;if(e!==0&&(h=Math.atan2(t*o,t*s)),e!==0||this.ns>0){if(t=1/this.ns,n=Math.pow(e/(this.a*this.f0),t),i=Ur(this.e,n),i===-9999)return null}else i=-x;return a=O(h/this.ns+this.long0),r.x=a,r.y=i,r}var ty=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ey={init:W_,forward:Q_,inverse:J_,names:ty};function ry(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function ny(r){var e,t,n,i,a,o,s,h=r.x,l=r.y,u=O(h-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),n=-u*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(n)),a=Math.asin(Math.cos(t)*Math.sin(n)/Math.cos(i)),o=this.n*a,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),r.y=s*Math.cos(o)/1,r.x=s*Math.sin(o)/1,this.czech||(r.y*=-1,r.x*=-1),r}function iy(r){var e,t,n,i,a,o,s,h,l=r.x;r.x=r.y,r.y=l,this.czech||(r.y*=-1,r.x*=-1),o=Math.sqrt(r.x*r.x+r.y*r.y),a=Math.atan2(r.y,r.x),i=a/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),t=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(e)),r.x=this.long0-t/this.alfa,s=e,h=0;var u=0;do r.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-r.y)<1e-10&&(h=1),s=r.y,u+=1;while(h===0&&u<15);return u>=15?null:r}var ay=["Krovak","krovak"];const oy={init:ry,forward:ny,inverse:iy,names:ay};function xt(r,e,t,n,i){return r*i-e*Math.sin(2*i)+t*Math.sin(4*i)-n*Math.sin(6*i)}function Vr(r){return 1-.25*r*(1+r/16*(3+1.25*r))}function Hr(r){return .375*r*(1+.25*r*(1+.46875*r))}function Zr(r){return .05859375*r*r*(1+.75*r)}function Yr(r){return r*r*r*(35/3072)}function lr(r,e,t){var n=e*t;return r/Math.sqrt(1-n*n)}function gr(r){return Math.abs(r)<x?r:r-qr(r)*Math.PI}function Dn(r,e,t,n,i){var a,o;a=r/e;for(var s=0;s<15;s++)if(o=(r-(e*a-t*Math.sin(2*a)+n*Math.sin(4*a)-i*Math.sin(6*a)))/(e-2*t*Math.cos(2*a)+4*n*Math.cos(4*a)-6*i*Math.cos(6*a)),a+=o,Math.abs(o)<=1e-10)return a;return NaN}function sy(){this.sphere||(this.e0=Vr(this.es),this.e1=Hr(this.es),this.e2=Zr(this.es),this.e3=Yr(this.es),this.ml0=this.a*xt(this.e0,this.e1,this.e2,this.e3,this.lat0))}function hy(r){var e,t,n=r.x,i=r.y;if(n=O(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(n)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(n))-this.lat0);else{var a=Math.sin(i),o=Math.cos(i),s=lr(this.a,this.e,a),h=Math.tan(i)*Math.tan(i),l=n*Math.cos(i),u=l*l,c=this.es*o*o/(1-this.es),f=this.a*xt(this.e0,this.e1,this.e2,this.e3,i);e=s*l*(1-u*h*(1/6-(8-h+8*c)*u/120)),t=f-this.ml0+s*a/o*u*(.5+(5-h+6*c)*u/24)}return r.x=e+this.x0,r.y=t+this.y0,r}function ly(r){r.x-=this.x0,r.y-=this.y0;var e=r.x/this.a,t=r.y/this.a,n,i;if(this.sphere){var a=t+this.lat0;n=Math.asin(Math.sin(a)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(a))}else{var o=this.ml0/this.a+t,s=Dn(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-x)<=C)return r.x=this.long0,r.y=x,t<0&&(r.y*=-1),r;var h=lr(this.a,this.e,Math.sin(s)),l=h*h*h/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(s),2),c=e*this.a/h,f=c*c;n=s-h*Math.tan(s)/l*c*c*(.5-(1+3*u)*c*c/24),i=c*(1-f*(u/3+(1+3*u)*u*f/15))/Math.cos(s)}return r.x=O(i+this.long0),r.y=gr(n),r}var uy=["Cassini","Cassini_Soldner","cass"];const cy={init:sy,forward:hy,inverse:ly,names:uy};function ye(r,e){var t;return r>1e-7?(t=r*e,(1-r*r)*(e/(1-t*t)-.5/r*Math.log((1-t)/(1+t)))):2*e}var fy=1,vy=2,dy=3,py=4;function gy(){var r=Math.abs(this.lat0);if(Math.abs(r-x)<C?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(r)<C?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=ye(this.e,1),this.mmf=.5/(1-this.es),this.apa=wy(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=ye(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function _y(r){var e,t,n,i,a,o,s,h,l,u,c=r.x,f=r.y;if(c=O(c-this.long0),this.sphere){if(a=Math.sin(f),u=Math.cos(f),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+u*n:1+this.sinph0*a+this.cosph0*u*n,t<=C)return null;t=Math.sqrt(2/t),e=t*u*Math.sin(c),t*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*u*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(f+this.lat0)<C)return null;t=k-f*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(c),t*=n}}else{switch(s=0,h=0,l=0,n=Math.cos(c),i=Math.sin(c),a=Math.sin(f),o=ye(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=o/this.qp,h=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:l=1+this.sinb1*s+this.cosb1*h*n;break;case this.EQUIT:l=1+h*n;break;case this.N_POLE:l=x+f,o=this.qp-o;break;case this.S_POLE:l=f-x,o=this.qp+o;break}if(Math.abs(l)<C)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),this.mode===this.OBLIQ?t=this.ymf*l*(this.cosb1*s-this.sinb1*h*n):t=(l=Math.sqrt(2/(1+h*n)))*s*this.ymf,e=this.xmf*l*h*i;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(l=Math.sqrt(o))*i,t=n*(this.mode===this.S_POLE?l:-l)):e=t=0;break}}return r.x=this.a*e+this.x0,r.y=this.a*t+this.y0,r}function yy(r){r.x-=this.x0,r.y-=this.y0;var e=r.x/this.a,t=r.y/this.a,n,i,a,o,s,h,l;if(this.sphere){var u=0,c,f=0;if(c=Math.sqrt(e*e+t*t),i=c*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(i),u=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(c)<=C?0:Math.asin(t*f/c),e*=f,t=u*c;break;case this.OBLIQ:i=Math.abs(c)<=C?this.lat0:Math.asin(u*this.sinph0+t*f*this.cosph0/c),e*=f*this.cosph0,t=(u-Math.sin(i)*this.sinph0)*c;break;case this.N_POLE:t=-t,i=x-i;break;case this.S_POLE:i-=x;break}n=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,h=Math.sqrt(e*e+t*t),h<C)return r.x=this.long0,r.y=this.lat0,r;o=2*Math.asin(.5*h/this.rq),a=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(l=a*this.sinb1+t*o*this.cosb1/h,s=this.qp*l,t=h*this.cosb1*a-t*this.sinb1*o):(l=t*o/h,s=this.qp*l,t=h*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),s=e*e+t*t,!s)return r.x=this.long0,r.y=this.lat0,r;l=1-s/this.qp,this.mode===this.S_POLE&&(l=-l)}n=Math.atan2(e,t),i=Cy(Math.asin(l),this.apa)}return r.x=O(this.long0+n),r.y=i,r}var my=.3333333333333333,Ey=.17222222222222222,Ty=.10257936507936508,My=.06388888888888888,xy=.0664021164021164,Ry=.016415012942191543;function wy(r){var e,t=[];return t[0]=r*my,e=r*r,t[0]+=e*Ey,t[1]=e*My,e*=r,t[0]+=e*Ty,t[1]+=e*xy,t[2]=e*Ry,t}function Cy(r,e){var t=r+r;return r+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Ay=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Oy={init:gy,forward:_y,inverse:yy,names:Ay,S_POLE:fy,N_POLE:vy,EQUIT:dy,OBLIQ:py};function Te(r){return Math.abs(r)>1&&(r=r>1?1:-1),Math.asin(r)}function Sy(){Math.abs(this.lat1+this.lat2)<C||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ee(this.e3,this.sin_po,this.cos_po),this.qs1=ye(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ee(this.e3,this.sin_po,this.cos_po),this.qs2=ye(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ye(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>C?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Py(r){var e=r.x,t=r.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var n=ye(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,a=this.ns0*O(e-this.long0),o=i*Math.sin(a)+this.x0,s=this.rh-i*Math.cos(a)+this.y0;return r.x=o,r.y=s,r}function Iy(r){var e,t,n,i,a,o;return r.x-=this.x0,r.y=this.rh-r.y+this.y0,this.ns0>=0?(e=Math.sqrt(r.x*r.x+r.y*r.y),n=1):(e=-Math.sqrt(r.x*r.x+r.y*r.y),n=-1),i=0,e!==0&&(i=Math.atan2(n*r.x,n*r.y)),n=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-n*n)/(2*this.ns0)):(t=(this.c-n*n)/this.ns0,o=this.phi1z(this.e3,t)),a=O(i/this.ns0+this.long0),r.x=a,r.y=o,r}function by(r,e){var t,n,i,a,o,s=Te(.5*e);if(r<C)return s;for(var h=r*r,l=1;l<=25;l++)if(t=Math.sin(s),n=Math.cos(s),i=r*t,a=1-i*i,o=.5*a*a/n*(e/(1-h)-t/a+.5/r*Math.log((1-i)/(1+i))),s=s+o,Math.abs(o)<=1e-7)return s;return null}var Ly=["Albers_Conic_Equal_Area","Albers","aea"];const Ny={init:Sy,forward:Py,inverse:Iy,names:Ly,phi1z:by};function Dy(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Gy(r){var e,t,n,i,a,o,s,h,l=r.x,u=r.y;return n=O(l-this.long0),e=Math.sin(u),t=Math.cos(u),i=Math.cos(n),o=this.sin_p14*e+this.cos_p14*t*i,a=1,o>0||Math.abs(o)<=C?(s=this.x0+this.a*a*t*Math.sin(n)/o,h=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*i)/o):(s=this.x0+this.infinity_dist*t*Math.sin(n),h=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),r.x=s,r.y=h,r}function Fy(r){var e,t,n,i,a,o;return r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,(e=Math.sqrt(r.x*r.x+r.y*r.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),n=Math.cos(i),o=Te(n*this.sin_p14+r.y*t*this.cos_p14/e),a=Math.atan2(r.x*t,e*this.cos_p14*n-r.y*this.sin_p14*t),a=O(this.long0+a)):(o=this.phic0,a=0),r.x=a,r.y=o,r}var Uy=["gnom"];const By={init:Dy,forward:Gy,inverse:Fy,names:Uy};function jy(r,e){var t=1-(1-r*r)/(2*r)*Math.log((1-r)/(1+r));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*x:x;for(var n=Math.asin(.5*e),i,a,o,s,h=0;h<30;h++)if(a=Math.sin(n),o=Math.cos(n),s=r*a,i=Math.pow(1-s*s,2)/(2*o)*(e/(1-r*r)-a/(1-s*s)+.5/r*Math.log((1-s)/(1+s))),n+=i,Math.abs(i)<=1e-10)return n;return NaN}function Xy(){this.sphere||(this.k0=ee(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function zy(r){var e=r.x,t=r.y,n,i,a=O(e-this.long0);if(this.sphere)n=this.x0+this.a*a*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var o=ye(this.e,Math.sin(t));n=this.x0+this.a*this.k0*a,i=this.y0+this.a*o*.5/this.k0}return r.x=n,r.y=i,r}function ky(r){r.x-=this.x0,r.y-=this.y0;var e,t;return this.sphere?(e=O(this.long0+r.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(r.y/this.a*Math.cos(this.lat_ts))):(t=jy(this.e,2*r.y*this.k0/this.a),e=O(this.long0+r.x/(this.a*this.k0))),r.x=e,r.y=t,r}var $y=["cea"];const Ky={init:Xy,forward:zy,inverse:ky,names:$y};function qy(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Vy(r){var e=r.x,t=r.y,n=O(e-this.long0),i=gr(t-this.lat0);return r.x=this.x0+this.a*n*this.rc,r.y=this.y0+this.a*i,r}function Hy(r){var e=r.x,t=r.y;return r.x=O(this.long0+(e-this.x0)/(this.a*this.rc)),r.y=gr(this.lat0+(t-this.y0)/this.a),r}var Zy=["Equirectangular","Equidistant_Cylindrical","eqc"];const Yy={init:qy,forward:Vy,inverse:Hy,names:Zy};var Jo=20;function Wy(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Vr(this.es),this.e1=Hr(this.es),this.e2=Zr(this.es),this.e3=Yr(this.es),this.ml0=this.a*xt(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Qy(r){var e=r.x,t=r.y,n,i,a,o=O(e-this.long0);if(a=o*Math.sin(t),this.sphere)Math.abs(t)<=C?(n=this.a*o,i=-1*this.a*this.lat0):(n=this.a*Math.sin(a)/Math.tan(t),i=this.a*(gr(t-this.lat0)+(1-Math.cos(a))/Math.tan(t)));else if(Math.abs(t)<=C)n=this.a*o,i=-1*this.ml0;else{var s=lr(this.a,this.e,Math.sin(t))/Math.tan(t);n=s*Math.sin(a),i=this.a*xt(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+s*(1-Math.cos(a))}return r.x=n+this.x0,r.y=i+this.y0,r}function Jy(r){var e,t,n,i,a,o,s,h,l;if(n=r.x-this.x0,i=r.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=C)e=O(n/this.a+this.long0),t=0;else{o=this.lat0+i/this.a,s=n*n/this.a/this.a+o*o,h=o;var u;for(a=Jo;a;--a)if(u=Math.tan(h),l=-1*(o*(h*u+1)-h-.5*(h*h+s)*u)/((h-o)/u-1),h+=l,Math.abs(l)<=C){t=h;break}e=O(this.long0+Math.asin(n*Math.tan(h)/this.a)/Math.sin(t))}else if(Math.abs(i+this.ml0)<=C)t=0,e=O(this.long0+n/this.a);else{o=(this.ml0+i)/this.a,s=n*n/this.a/this.a+o*o,h=o;var c,f,v,d,p;for(a=Jo;a;--a)if(p=this.e*Math.sin(h),c=Math.sqrt(1-p*p)*Math.tan(h),f=this.a*xt(this.e0,this.e1,this.e2,this.e3,h),v=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),d=f/this.a,l=(o*(c*d+1)-d-.5*c*(d*d+s))/(this.es*Math.sin(2*h)*(d*d+s-2*o*d)/(4*c)+(o-d)*(c*v-2/Math.sin(2*h))-v),h-=l,Math.abs(l)<=C){t=h;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=O(this.long0+Math.asin(n*c/this.a)/Math.sin(t))}return r.x=e,r.y=t,r}var tm=["Polyconic","poly"];const em={init:Wy,forward:Qy,inverse:Jy,names:tm};function rm(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function nm(r){var e,t=r.x,n=r.y,i=n-this.lat0,a=t-this.long0,o=i/Sr*1e-5,s=a,h=1,l=0;for(e=1;e<=10;e++)h=h*o,l=l+this.A[e]*h;var u=l,c=s,f=1,v=0,d,p,g=0,y=0;for(e=1;e<=6;e++)d=f*u-v*c,p=v*u+f*c,f=d,v=p,g=g+this.B_re[e]*f-this.B_im[e]*v,y=y+this.B_im[e]*f+this.B_re[e]*v;return r.x=y*this.a+this.x0,r.y=g*this.a+this.y0,r}function im(r){var e,t=r.x,n=r.y,i=t-this.x0,a=n-this.y0,o=a/this.a,s=i/this.a,h=1,l=0,u,c,f=0,v=0;for(e=1;e<=6;e++)u=h*o-l*s,c=l*o+h*s,h=u,l=c,f=f+this.C_re[e]*h-this.C_im[e]*l,v=v+this.C_im[e]*h+this.C_re[e]*l;for(var d=0;d<this.iterations;d++){var p=f,g=v,y,_,m=o,E=s;for(e=2;e<=6;e++)y=p*f-g*v,_=g*f+p*v,p=y,g=_,m=m+(e-1)*(this.B_re[e]*p-this.B_im[e]*g),E=E+(e-1)*(this.B_im[e]*p+this.B_re[e]*g);p=1,g=0;var T=this.B_re[1],M=this.B_im[1];for(e=2;e<=6;e++)y=p*f-g*v,_=g*f+p*v,p=y,g=_,T=T+e*(this.B_re[e]*p-this.B_im[e]*g),M=M+e*(this.B_im[e]*p+this.B_re[e]*g);var R=T*T+M*M;f=(m*T+E*M)/R,v=(E*T-m*M)/R}var w=f,S=v,L=1,I=0;for(e=1;e<=9;e++)L=L*w,I=I+this.D[e]*L;var j=this.lat0+I*Sr*1e5,q=this.long0+S;return r.x=q,r.y=j,r}var am=["New_Zealand_Map_Grid","nzmg"];const om={init:rm,forward:nm,inverse:im,names:am};function sm(){}function hm(r){var e=r.x,t=r.y,n=O(e-this.long0),i=this.x0+this.a*n,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return r.x=i,r.y=a,r}function lm(r){r.x-=this.x0,r.y-=this.y0;var e=O(this.long0+r.x/this.a),t=2.5*(Math.atan(Math.exp(.8*r.y/this.a))-Math.PI/4);return r.x=e,r.y=t,r}var um=["Miller_Cylindrical","mill"];const cm={init:sm,forward:hm,inverse:lm,names:um};var fm=20;function vm(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=hl(this.es)}function dm(r){var e,t,n=r.x,i=r.y;if(n=O(n-this.long0),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var a=this.n*Math.sin(i),o=fm;o;--o){var s=(this.m*i+Math.sin(i)-a)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<C)break}e=this.a*this.C_x*n*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var h=Math.sin(i),l=Math.cos(i);t=this.a*Qn(i,h,l,this.en),e=this.a*n*l/Math.sqrt(1-this.es*h*h)}return r.x=e,r.y=t,r}function pm(r){var e,t,n,i;return r.x-=this.x0,n=r.x/this.a,r.y-=this.y0,e=r.y/this.a,this.sphere?(e/=this.C_y,n=n/(this.C_x*(this.m+Math.cos(e))),this.m?e=Te((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Te(Math.sin(e)/this.n)),n=O(n+this.long0),e=gr(e)):(e=ll(r.y/this.a,this.es,this.en),i=Math.abs(e),i<x?(i=Math.sin(e),t=this.long0+r.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),n=O(t)):i-C<x&&(n=this.long0)),r.x=n,r.y=e,r}var gm=["Sinusoidal","sinu"];const _m={init:vm,forward:dm,inverse:pm,names:gm};function ym(){}function mm(r){for(var e=r.x,t=r.y,n=O(e-this.long0),i=t,a=Math.PI*Math.sin(t);;){var o=-(i+Math.sin(i)-a)/(1+Math.cos(i));if(i+=o,Math.abs(o)<C)break}i/=2,Math.PI/2-Math.abs(t)<C&&(n=0);var s=.900316316158*this.a*n*Math.cos(i)+this.x0,h=1.4142135623731*this.a*Math.sin(i)+this.y0;return r.x=s,r.y=h,r}function Em(r){var e,t;r.x-=this.x0,r.y-=this.y0,t=r.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var n=O(this.long0+r.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return r.x=n,r.y=i,r}var Tm=["Mollweide","moll"];const Mm={init:ym,forward:mm,inverse:Em,names:Tm};function xm(){Math.abs(this.lat1+this.lat2)<C||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Vr(this.es),this.e1=Hr(this.es),this.e2=Zr(this.es),this.e3=Yr(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=ee(this.e,this.sinphi,this.cosphi),this.ml1=xt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<C?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=ee(this.e,this.sinphi,this.cosphi),this.ml2=xt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=xt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Rm(r){var e=r.x,t=r.y,n;if(this.sphere)n=this.a*(this.g-t);else{var i=xt(this.e0,this.e1,this.e2,this.e3,t);n=this.a*(this.g-i)}var a=this.ns*O(e-this.long0),o=this.x0+n*Math.sin(a),s=this.y0+this.rh-n*Math.cos(a);return r.x=o,r.y=s,r}function wm(r){r.x-=this.x0,r.y=this.rh-r.y+this.y0;var e,t,n,i;this.ns>=0?(t=Math.sqrt(r.x*r.x+r.y*r.y),e=1):(t=-Math.sqrt(r.x*r.x+r.y*r.y),e=-1);var a=0;if(t!==0&&(a=Math.atan2(e*r.x,e*r.y)),this.sphere)return i=O(this.long0+a/this.ns),n=gr(this.g-t/this.a),r.x=i,r.y=n,r;var o=this.g-t/this.a;return n=Dn(o,this.e0,this.e1,this.e2,this.e3),i=O(this.long0+a/this.ns),r.x=i,r.y=n,r}var Cm=["Equidistant_Conic","eqdc"];const Am={init:xm,forward:Rm,inverse:wm,names:Cm};function Om(){this.R=this.a}function Sm(r){var e=r.x,t=r.y,n=O(e-this.long0),i,a;Math.abs(t)<=C&&(i=this.x0+this.R*n,a=this.y0);var o=Te(2*Math.abs(t/Math.PI));(Math.abs(n)<=C||Math.abs(Math.abs(t)-x)<=C)&&(i=this.x0,t>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*o):a=this.y0+Math.PI*this.R*-Math.tan(.5*o));var s=.5*Math.abs(Math.PI/n-n/Math.PI),h=s*s,l=Math.sin(o),u=Math.cos(o),c=u/(l+u-1),f=c*c,v=c*(2/l-1),d=v*v,p=Math.PI*this.R*(s*(c-d)+Math.sqrt(h*(c-d)*(c-d)-(d+h)*(f-d)))/(d+h);n<0&&(p=-p),i=this.x0+p;var g=h+c;return p=Math.PI*this.R*(v*g-s*Math.sqrt((d+h)*(h+1)-g*g))/(d+h),t>=0?a=this.y0+p:a=this.y0-p,r.x=i,r.y=a,r}function Pm(r){var e,t,n,i,a,o,s,h,l,u,c,f,v;return r.x-=this.x0,r.y-=this.y0,c=Math.PI*this.R,n=r.x/c,i=r.y/c,a=n*n+i*i,o=-Math.abs(i)*(1+a),s=o-2*i*i+n*n,h=-2*o+1+2*i*i+a*a,v=i*i/h+(2*s*s*s/h/h/h-9*o*s/h/h)/27,l=(o-s*s/3/h)/h,u=2*Math.sqrt(-l/3),c=3*v/l/u,Math.abs(c)>1&&(c>=0?c=1:c=-1),f=Math.acos(c)/3,r.y>=0?t=(-u*Math.cos(f+Math.PI/3)-s/3/h)*Math.PI:t=-(-u*Math.cos(f+Math.PI/3)-s/3/h)*Math.PI,Math.abs(n)<C?e=this.long0:e=O(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(n*n-i*i)+a*a))/2/n),r.x=e,r.y=t,r}var Im=["Van_der_Grinten_I","VanDerGrinten","vandg"];const bm={init:Om,forward:Sm,inverse:Pm,names:Im};function Lm(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Nm(r){var e=r.x,t=r.y,n=Math.sin(r.y),i=Math.cos(r.y),a=O(e-this.long0),o,s,h,l,u,c,f,v,d,p,g,y,_,m,E,T,M,R,w,S,L,I,j;return this.sphere?Math.abs(this.sin_p12-1)<=C?(r.x=this.x0+this.a*(x-t)*Math.sin(a),r.y=this.y0-this.a*(x-t)*Math.cos(a),r):Math.abs(this.sin_p12+1)<=C?(r.x=this.x0+this.a*(x+t)*Math.sin(a),r.y=this.y0+this.a*(x+t)*Math.cos(a),r):(R=this.sin_p12*n+this.cos_p12*i*Math.cos(a),T=Math.acos(R),M=T?T/Math.sin(T):1,r.x=this.x0+this.a*M*i*Math.sin(a),r.y=this.y0+this.a*M*(this.cos_p12*n-this.sin_p12*i*Math.cos(a)),r):(o=Vr(this.es),s=Hr(this.es),h=Zr(this.es),l=Yr(this.es),Math.abs(this.sin_p12-1)<=C?(u=this.a*xt(o,s,h,l,x),c=this.a*xt(o,s,h,l,t),r.x=this.x0+(u-c)*Math.sin(a),r.y=this.y0-(u-c)*Math.cos(a),r):Math.abs(this.sin_p12+1)<=C?(u=this.a*xt(o,s,h,l,x),c=this.a*xt(o,s,h,l,t),r.x=this.x0+(u+c)*Math.sin(a),r.y=this.y0+(u+c)*Math.cos(a),r):(f=n/i,v=lr(this.a,this.e,this.sin_p12),d=lr(this.a,this.e,n),p=Math.atan((1-this.es)*f+this.es*v*this.sin_p12/(d*i)),g=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(p)-this.sin_p12*Math.cos(a)),g===0?w=Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.abs(Math.abs(g)-Math.PI)<=C?w=-Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):w=Math.asin(Math.sin(a)*Math.cos(p)/Math.sin(g)),y=this.e*this.sin_p12/Math.sqrt(1-this.es),_=this.e*this.cos_p12*Math.cos(g)/Math.sqrt(1-this.es),m=y*_,E=_*_,S=w*w,L=S*w,I=L*w,j=I*w,T=v*w*(1-S*E*(1-E)/6+L/8*m*(1-2*E)+I/120*(E*(4-7*E)-3*y*y*(1-7*E))-j/48*m),r.x=this.x0+T*Math.sin(g),r.y=this.y0+T*Math.cos(g),r))}function Dm(r){r.x-=this.x0,r.y-=this.y0;var e,t,n,i,a,o,s,h,l,u,c,f,v,d,p,g,y,_,m,E,T,M,R,w;return this.sphere?(e=Math.sqrt(r.x*r.x+r.y*r.y),e>2*x*this.a?void 0:(t=e/this.a,n=Math.sin(t),i=Math.cos(t),a=this.long0,Math.abs(e)<=C?o=this.lat0:(o=Te(i*this.sin_p12+r.y*n*this.cos_p12/e),s=Math.abs(this.lat0)-x,Math.abs(s)<=C?this.lat0>=0?a=O(this.long0+Math.atan2(r.x,-r.y)):a=O(this.long0-Math.atan2(-r.x,r.y)):a=O(this.long0+Math.atan2(r.x*n,e*this.cos_p12*i-r.y*this.sin_p12*n))),r.x=a,r.y=o,r)):(h=Vr(this.es),l=Hr(this.es),u=Zr(this.es),c=Yr(this.es),Math.abs(this.sin_p12-1)<=C?(f=this.a*xt(h,l,u,c,x),e=Math.sqrt(r.x*r.x+r.y*r.y),v=f-e,o=Dn(v/this.a,h,l,u,c),a=O(this.long0+Math.atan2(r.x,-1*r.y)),r.x=a,r.y=o,r):Math.abs(this.sin_p12+1)<=C?(f=this.a*xt(h,l,u,c,x),e=Math.sqrt(r.x*r.x+r.y*r.y),v=e-f,o=Dn(v/this.a,h,l,u,c),a=O(this.long0+Math.atan2(r.x,r.y)),r.x=a,r.y=o,r):(e=Math.sqrt(r.x*r.x+r.y*r.y),g=Math.atan2(r.x,r.y),d=lr(this.a,this.e,this.sin_p12),y=Math.cos(g),_=this.e*this.cos_p12*y,m=-_*_/(1-this.es),E=3*this.es*(1-m)*this.sin_p12*this.cos_p12*y/(1-this.es),T=e/d,M=T-m*(1+m)*Math.pow(T,3)/6-E*(1+3*m)*Math.pow(T,4)/24,R=1-m*M*M/2-T*M*M*M/6,p=Math.asin(this.sin_p12*Math.cos(M)+this.cos_p12*Math.sin(M)*y),a=O(this.long0+Math.asin(Math.sin(g)*Math.sin(M)/Math.cos(p))),w=Math.sin(p),o=Math.atan2((w-this.es*R*this.sin_p12)*Math.tan(p),w*(1-this.es)),r.x=a,r.y=o,r))}var Gm=["Azimuthal_Equidistant","aeqd"];const Fm={init:Lm,forward:Nm,inverse:Dm,names:Gm};function Um(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Bm(r){var e,t,n,i,a,o,s,h,l=r.x,u=r.y;return n=O(l-this.long0),e=Math.sin(u),t=Math.cos(u),i=Math.cos(n),o=this.sin_p14*e+this.cos_p14*t*i,a=1,(o>0||Math.abs(o)<=C)&&(s=this.a*a*t*Math.sin(n),h=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*i)),r.x=s,r.y=h,r}function jm(r){var e,t,n,i,a,o,s;return r.x-=this.x0,r.y-=this.y0,e=Math.sqrt(r.x*r.x+r.y*r.y),t=Te(e/this.a),n=Math.sin(t),i=Math.cos(t),o=this.long0,Math.abs(e)<=C?(s=this.lat0,r.x=o,r.y=s,r):(s=Te(i*this.sin_p14+r.y*n*this.cos_p14/e),a=Math.abs(this.lat0)-x,Math.abs(a)<=C?(this.lat0>=0?o=O(this.long0+Math.atan2(r.x,-r.y)):o=O(this.long0-Math.atan2(-r.x,r.y)),r.x=o,r.y=s,r):(o=O(this.long0+Math.atan2(r.x*n,e*this.cos_p14*i-r.y*this.sin_p14*n)),r.x=o,r.y=s,r))}var Xm=["ortho"];const zm={init:Um,forward:Bm,inverse:jm,names:Xm};var rt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},$={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function km(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=x-k/2?this.face=rt.TOP:this.lat0<=-(x-k/2)?this.face=rt.BOTTOM:Math.abs(this.long0)<=k?this.face=rt.FRONT:Math.abs(this.long0)<=x+k?this.face=this.long0>0?rt.RIGHT:rt.LEFT:this.face=rt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function $m(r){var e={x:0,y:0},t,n,i,a,o,s,h={value:0};if(r.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(r.y)):t=r.y,n=r.x,this.face===rt.TOP)a=x-t,n>=k&&n<=x+k?(h.value=$.AREA_0,i=n-x):n>x+k||n<=-(x+k)?(h.value=$.AREA_1,i=n>0?n-it:n+it):n>-(x+k)&&n<=-k?(h.value=$.AREA_2,i=n+x):(h.value=$.AREA_3,i=n);else if(this.face===rt.BOTTOM)a=x+t,n>=k&&n<=x+k?(h.value=$.AREA_0,i=-n+x):n<k&&n>=-k?(h.value=$.AREA_1,i=-n):n<-k&&n>=-(x+k)?(h.value=$.AREA_2,i=-n-x):(h.value=$.AREA_3,i=n>0?-n+it:-n-it);else{var l,u,c,f,v,d,p;this.face===rt.RIGHT?n=rr(n,+x):this.face===rt.BACK?n=rr(n,+it):this.face===rt.LEFT&&(n=rr(n,-x)),f=Math.sin(t),v=Math.cos(t),d=Math.sin(n),p=Math.cos(n),l=v*p,u=v*d,c=f,this.face===rt.FRONT?(a=Math.acos(l),i=cn(a,c,u,h)):this.face===rt.RIGHT?(a=Math.acos(u),i=cn(a,c,-l,h)):this.face===rt.BACK?(a=Math.acos(-l),i=cn(a,c,-u,h)):this.face===rt.LEFT?(a=Math.acos(-u),i=cn(a,c,l,h)):(a=i=0,h.value=$.AREA_0)}return s=Math.atan(12/it*(i+Math.acos(Math.sin(i)*Math.cos(k))-x)),o=Math.sqrt((1-Math.cos(a))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(i))))),h.value===$.AREA_1?s+=x:h.value===$.AREA_2?s+=it:h.value===$.AREA_3&&(s+=1.5*it),e.x=o*Math.cos(s),e.y=o*Math.sin(s),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,r.x=e.x,r.y=e.y,r}function Km(r){var e={lam:0,phi:0},t,n,i,a,o,s,h,l,u,c={value:0};if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,n=Math.atan(Math.sqrt(r.x*r.x+r.y*r.y)),t=Math.atan2(r.y,r.x),r.x>=0&&r.x>=Math.abs(r.y)?c.value=$.AREA_0:r.y>=0&&r.y>=Math.abs(r.x)?(c.value=$.AREA_1,t-=x):r.x<0&&-r.x>=Math.abs(r.y)?(c.value=$.AREA_2,t=t<0?t+it:t-it):(c.value=$.AREA_3,t+=x),u=it/12*Math.tan(t),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),s=Math.atan(o),i=Math.cos(t),a=Math.tan(n),h=1-i*i*a*a*(1-Math.cos(Math.atan(1/Math.cos(s)))),h<-1?h=-1:h>1&&(h=1),this.face===rt.TOP)l=Math.acos(h),e.phi=x-l,c.value===$.AREA_0?e.lam=s+x:c.value===$.AREA_1?e.lam=s<0?s+it:s-it:c.value===$.AREA_2?e.lam=s-x:e.lam=s;else if(this.face===rt.BOTTOM)l=Math.acos(h),e.phi=l-x,c.value===$.AREA_0?e.lam=-s+x:c.value===$.AREA_1?e.lam=-s:c.value===$.AREA_2?e.lam=-s-x:e.lam=s<0?-s-it:-s+it;else{var f,v,d;f=h,u=f*f,u>=1?d=0:d=Math.sqrt(1-u)*Math.sin(s),u+=d*d,u>=1?v=0:v=Math.sqrt(1-u),c.value===$.AREA_1?(u=v,v=-d,d=u):c.value===$.AREA_2?(v=-v,d=-d):c.value===$.AREA_3&&(u=v,v=d,d=-u),this.face===rt.RIGHT?(u=f,f=-v,v=u):this.face===rt.BACK?(f=-f,v=-v):this.face===rt.LEFT&&(u=f,f=v,v=-u),e.phi=Math.acos(-d)-x,e.lam=Math.atan2(v,f),this.face===rt.RIGHT?e.lam=rr(e.lam,-x):this.face===rt.BACK?e.lam=rr(e.lam,-it):this.face===rt.LEFT&&(e.lam=rr(e.lam,+x))}if(this.es!==0){var p,g,y;p=e.phi<0?1:0,g=Math.tan(e.phi),y=this.b/Math.sqrt(g*g+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-y*y)/(this.one_minus_f*y)),p&&(e.phi=-e.phi)}return e.lam+=this.long0,r.x=e.lam,r.y=e.phi,r}function cn(r,e,t,n){var i;return r<C?(n.value=$.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=k?n.value=$.AREA_0:i>k&&i<=x+k?(n.value=$.AREA_1,i-=x):i>x+k||i<=-(x+k)?(n.value=$.AREA_2,i=i>=0?i-it:i+it):(n.value=$.AREA_3,i+=x)),i}function rr(r,e){var t=r+e;return t<-it?t+=Gr:t>+it&&(t-=Gr),t}var qm=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Vm={init:km,forward:$m,inverse:Km,names:qm};var ji=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Rr=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],fl=.8487,vl=1.3523,dl=Wt/5,Hm=1/dl,Ze=18,Gn=function(r,e){return r[0]+e*(r[1]+e*(r[2]+e*r[3]))},Zm=function(r,e){return r[1]+e*(2*r[2]+e*3*r[3])};function Ym(r,e,t,n){for(var i=e;n;--n){var a=r(i);if(i-=a,Math.abs(a)<t)break}return i}function Wm(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Qm(r){var e=O(r.x-this.long0),t=Math.abs(r.y),n=Math.floor(t*dl);n<0?n=0:n>=Ze&&(n=Ze-1),t=Wt*(t-Hm*n);var i={x:Gn(ji[n],t)*e,y:Gn(Rr[n],t)};return r.y<0&&(i.y=-i.y),i.x=i.x*this.a*fl+this.x0,i.y=i.y*this.a*vl+this.y0,i}function Jm(r){var e={x:(r.x-this.x0)/(this.a*fl),y:Math.abs(r.y-this.y0)/(this.a*vl)};if(e.y>=1)e.x/=ji[Ze][0],e.y=r.y<0?-x:x;else{var t=Math.floor(e.y*Ze);for(t<0?t=0:t>=Ze&&(t=Ze-1);;)if(Rr[t][0]>e.y)--t;else if(Rr[t+1][0]<=e.y)++t;else break;var n=Rr[t],i=5*(e.y-n[0])/(Rr[t+1][0]-n[0]);i=Ym(function(a){return(Gn(n,a)-e.y)/Zm(n,a)},i,C,100),e.x/=Gn(ji[t],i),e.y=(5*t+i)*pt,r.y<0&&(e.y=-e.y)}return e.x=O(e.x+this.long0),e}var t1=["Robinson","robin"];const e1={init:Wm,forward:Qm,inverse:Jm,names:t1};function r1(){this.name="geocent"}function n1(r){var e=Jh(r,this.es,this.a);return e}function i1(r){var e=tl(r,this.es,this.a,this.b);return e}var a1=["Geocentric","geocentric","geocent","Geocent"];const o1={init:r1,forward:n1,inverse:i1,names:a1};var Et={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},mr={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function s1(){if(Object.keys(mr).forEach(function(t){if(typeof this[t]>"u")this[t]=mr[t].def;else{if(mr[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);mr[t].num&&(this[t]=parseFloat(this[t]))}mr[t].degrees&&(this[t]=this[t]*pt)}.bind(this)),Math.abs(Math.abs(this.lat0)-x)<C?this.mode=this.lat0<0?Et.S_POLE:Et.N_POLE:Math.abs(this.lat0)<C?this.mode=Et.EQUIT:(this.mode=Et.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var r=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(r),this.sw=Math.sin(r)}function h1(r){r.x-=this.long0;var e=Math.sin(r.y),t=Math.cos(r.y),n=Math.cos(r.x),i,a;switch(this.mode){case Et.OBLIQ:a=this.sinph0*e+this.cosph0*t*n;break;case Et.EQUIT:a=t*n;break;case Et.S_POLE:a=-e;break;case Et.N_POLE:a=e;break}switch(a=this.pn1/(this.p-a),i=a*t*Math.sin(r.x),this.mode){case Et.OBLIQ:a*=this.cosph0*e-this.sinph0*t*n;break;case Et.EQUIT:a*=e;break;case Et.N_POLE:a*=-(t*n);break;case Et.S_POLE:a*=t*n;break}var o,s;return o=a*this.cg+i*this.sg,s=1/(o*this.sw*this.h1+this.cw),i=(i*this.cg-a*this.sg)*this.cw*s,a=o*s,r.x=i*this.a,r.y=a*this.a,r}function l1(r){r.x/=this.a,r.y/=this.a;var e={x:r.x,y:r.y},t,n,i;i=1/(this.pn1-r.y*this.sw),t=this.pn1*r.x*i,n=this.pn1*r.y*this.cw*i,r.x=t*this.cg+n*this.sg,r.y=n*this.cg-t*this.sg;var a=kt(r.x,r.y);if(Math.abs(a)<C)e.x=0,e.y=r.y;else{var o,s;switch(s=1-a*a*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/a+a/this.pn1),o=Math.sqrt(1-s*s),this.mode){case Et.OBLIQ:e.y=Math.asin(o*this.sinph0+r.y*s*this.cosph0/a),r.y=(o-this.sinph0*Math.sin(e.y))*a,r.x*=s*this.cosph0;break;case Et.EQUIT:e.y=Math.asin(r.y*s/a),r.y=o*a,r.x*=s;break;case Et.N_POLE:e.y=Math.asin(o),r.y=-r.y;break;case Et.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(r.x,r.y)}return r.x=e.x+this.long0,r.y=e.y,r}var u1=["Tilted_Perspective","tpers"];const c1={init:s1,forward:h1,inverse:l1,names:u1};function f1(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var r=1-this.es,e=1/r;this.radius_p=Math.sqrt(r),this.radius_p2=r,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function v1(r){var e=r.x,t=r.y,n,i,a,o;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var s=this.radius_p/kt(this.radius_p*Math.cos(t),Math.sin(t));if(i=s*Math.cos(e)*Math.cos(t),a=s*Math.sin(e)*Math.cos(t),o=s*Math.sin(t),(this.radius_g-i)*i-a*a-o*o*this.radius_p_inv2<0)return r.x=Number.NaN,r.y=Number.NaN,r;n=this.radius_g-i,this.flip_axis?(r.x=this.radius_g_1*Math.atan(a/kt(o,n)),r.y=this.radius_g_1*Math.atan(o/n)):(r.x=this.radius_g_1*Math.atan(a/n),r.y=this.radius_g_1*Math.atan(o/kt(a,n)))}else this.shape==="sphere"&&(n=Math.cos(t),i=Math.cos(e)*n,a=Math.sin(e)*n,o=Math.sin(t),n=this.radius_g-i,this.flip_axis?(r.x=this.radius_g_1*Math.atan(a/kt(o,n)),r.y=this.radius_g_1*Math.atan(o/n)):(r.x=this.radius_g_1*Math.atan(a/n),r.y=this.radius_g_1*Math.atan(o/kt(a,n))));return r.x=r.x*this.a,r.y=r.y*this.a,r}function d1(r){var e=-1,t=0,n=0,i,a,o,s;if(r.x=r.x/this.a,r.y=r.y/this.a,this.shape==="ellipse"){this.flip_axis?(n=Math.tan(r.y/this.radius_g_1),t=Math.tan(r.x/this.radius_g_1)*kt(1,n)):(t=Math.tan(r.x/this.radius_g_1),n=Math.tan(r.y/this.radius_g_1)*kt(1,t));var h=n/this.radius_p;if(i=t*t+h*h+e*e,a=2*this.radius_g*e,o=a*a-4*i*this.C,o<0)return r.x=Number.NaN,r.y=Number.NaN,r;s=(-a-Math.sqrt(o))/(2*i),e=this.radius_g+s*e,t*=s,n*=s,r.x=Math.atan2(t,e),r.y=Math.atan(n*Math.cos(r.x)/e),r.y=Math.atan(this.radius_p_inv2*Math.tan(r.y))}else if(this.shape==="sphere"){if(this.flip_axis?(n=Math.tan(r.y/this.radius_g_1),t=Math.tan(r.x/this.radius_g_1)*Math.sqrt(1+n*n)):(t=Math.tan(r.x/this.radius_g_1),n=Math.tan(r.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+n*n+e*e,a=2*this.radius_g*e,o=a*a-4*i*this.C,o<0)return r.x=Number.NaN,r.y=Number.NaN,r;s=(-a-Math.sqrt(o))/(2*i),e=this.radius_g+s*e,t*=s,n*=s,r.x=Math.atan2(t,e),r.y=Math.atan(n*Math.cos(r.x)/e)}return r.x=r.x+this.long0,r}var p1=["Geostationary Satellite View","Geostationary_Satellite","geos"];const g1={init:f1,forward:v1,inverse:d1,names:p1};function _1(r){r.Proj.projections.add(En),r.Proj.projections.add(Tn),r.Proj.projections.add(x_),r.Proj.projections.add(L_),r.Proj.projections.add(B_),r.Proj.projections.add($_),r.Proj.projections.add(Y_),r.Proj.projections.add(ey),r.Proj.projections.add(oy),r.Proj.projections.add(cy),r.Proj.projections.add(Oy),r.Proj.projections.add(Ny),r.Proj.projections.add(By),r.Proj.projections.add(Ky),r.Proj.projections.add(Yy),r.Proj.projections.add(em),r.Proj.projections.add(om),r.Proj.projections.add(cm),r.Proj.projections.add(_m),r.Proj.projections.add(Mm),r.Proj.projections.add(Am),r.Proj.projections.add(bm),r.Proj.projections.add(Fm),r.Proj.projections.add(zm),r.Proj.projections.add(Vm),r.Proj.projections.add(e1),r.Proj.projections.add(o1),r.Proj.projections.add(c1),r.Proj.projections.add(g1)}Ot.defaultDatum="WGS84";Ot.Proj=Qt;Ot.WGS84=new Ot.Proj("WGS84");Ot.Point=hr;Ot.toPoint=el;Ot.defs=Mt;Ot.nadgrid=wg;Ot.transform=Nn;Ot.mgrs=Xg;Ot.version="__VERSION__";_1(Ot);function y1(r){var e=Object.keys(r.defs),t=e.length,n,i;for(n=0;n<t;++n){var a=e[n];if(!ct(a)){var o=r.defs(a),s=o.units;!s&&o.projName==="longlat"&&(s=le.DEGREES),ys(new Nr({code:a,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:s}))}}for(n=0;n<t;++n){var h=e[n],l=ct(h);for(i=0;i<t;++i){var u=e[i],c=ct(u);if(!ds(h,u))if(r.defs[h]===r.defs[u])Ai([l,c]);else{var f=r(h,u);Pu(l,c,Ya(l,c,f.forward),Ya(c,l,f.inverse))}}}}function m1(r,e){var t=/\{z\}/g,n=/\{x\}/g,i=/\{y\}/g,a=/\{-y\}/g;return function(o,s,h){if(o)return r.replace(t,o[0].toString()).replace(n,o[1].toString()).replace(i,o[2].toString()).replace(a,function(){var l=o[0],u=e.getFullTileRange(l);H(u,55);var c=u.getHeight()-o[2]-1;return c.toString()})}}function E1(r,e){for(var t=r.length,n=new Array(t),i=0;i<t;++i)n[i]=m1(r[i],e);return T1(n)}function T1(r){return r.length===1?r[0]:function(e,t,n){if(e){var i=Bv(e),a=We(i,r.length);return r[a](e,t,n)}else return}}function M1(r){var e=[],t=/\{([a-z])-([a-z])\}/.exec(r);if(t){var n=t[1].charCodeAt(0),i=t[2].charCodeAt(0),a=void 0;for(a=n;a<=i;++a)e.push(r.replace(t[0],String.fromCharCode(a)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(r),t){for(var o=parseInt(t[2],10),s=parseInt(t[1],10);s<=o;s++)e.push(r.replace(t[0],s.toString()));return e}return e.push(r),e}var x1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),R1=function(r){x1(e,r);function e(t){var n=r.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return n.generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction,n.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(n.tileUrlFunction=t.tileUrlFunction),n.urls=null,t.urls?n.setUrls(t.urls):t.url&&n.setUrl(t.url),n.tileLoadingKeys_={},n}return e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var n=t.target,i=At(n),a=n.getState(),o;a==b.LOADING?(this.tileLoadingKeys_[i]=!0,o=Je.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],o=a==b.ERROR?Je.TILELOADERROR:a==b.LOADED?Je.TILELOADEND:void 0),o!=null&&this.dispatchEvent(new Th(o,n))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,n){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof n<"u"?this.setKey(n):this.changed()},e.prototype.setUrl=function(t){var n=M1(t);this.urls=n,this.setUrls(n)},e.prototype.setUrls=function(t){this.urls=t;var n=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(E1(t,this.tileGrid),n):this.setKey(n)},e.prototype.tileUrlFunction=function(t,n,i){},e.prototype.useTile=function(t,n,i){var a=$r(t,n,i);this.tileCache.containsKey(a)&&this.tileCache.get(a)},e}(Mh);const w1=R1;var C1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),A1=function(r){C1(e,r);function e(t){var n=this,i=t.imageSmoothing!==void 0?t.imageSmoothing:!0;return t.interpolate!==void 0&&(i=t.interpolate),n=r.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:O1,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:i,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this,n.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,n.tileClass=t.tileClass!==void 0?t.tileClass:Pi,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,n.renderReprojectionEdges_=!1,n}return e.prototype.canExpireCache=function(){if(!ie)return r.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,n){if(!ie){r.prototype.expireCache.call(this,t,n);return}var i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?n:{});for(var a in this.tileCacheForProjection){var o=this.tileCacheForProjection[a];o.expireCache(o==i?n:{})}},e.prototype.getGutterForProjection=function(t){return ie&&this.getProjection()&&t&&!je(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){var t=r.prototype.getKey.call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t},e.prototype.getOpaque=function(t){return ie&&this.getProjection()&&t&&!je(this.getProjection(),t)?!1:r.prototype.getOpaque.call(this,t)},e.prototype.getTileGridForProjection=function(t){if(!ie)return r.prototype.getTileGridForProjection.call(this,t);var n=this.getProjection();if(this.tileGrid&&(!n||je(n,t)))return this.tileGrid;var i=At(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=_h(t)),this.tileGridForProjection[i]},e.prototype.getTileCacheForProjection=function(t){if(!ie)return r.prototype.getTileCacheForProjection.call(this,t);var n=this.getProjection();if(!n||je(n,t))return this.tileCache;var i=At(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Hs(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,n,i,a,o,s){var h=[t,n,i],l=this.getTileCoordForTileUrlFunction(h,o),u=l?this.tileUrlFunction(l,a,o):void 0,c=new this.tileClass(h,u!==void 0?b.IDLE:b.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=s,c.addEventListener(G.CHANGE,this.handleTileChange.bind(this)),c},e.prototype.getTile=function(t,n,i,a,o){var s=this.getProjection();if(!ie||!s||!o||je(s,o))return this.getTileInternal(t,n,i,a,s||o);var h=this.getTileCacheForProjection(o),l=[t,n,i],u=void 0,c=Dr(l);h.containsKey(c)&&(u=h.get(c));var f=this.getKey();if(u&&u.key==f)return u;var v=this.getTileGridForProjection(s),d=this.getTileGridForProjection(o),p=this.getTileCoordForTileUrlFunction(l,o),g=new Js(s,v,o,d,l,p,this.getTilePixelRatio(a),this.getGutter(),function(y,_,m,E){return this.getTileInternal(y,_,m,E,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return g.key=f,u?(g.interimTile=u,g.refreshInterimChain(),h.replace(c,g)):h.set(c,g),g},e.prototype.getTileInternal=function(t,n,i,a,o){var s=null,h=$r(t,n,i),l=this.getKey();if(!this.tileCache.containsKey(h))s=this.createTile_(t,n,i,a,o,l),this.tileCache.set(h,s);else if(s=this.tileCache.get(h),s.key!=l){var u=s;s=this.createTile_(t,n,i,a,o,l),u.getState()==b.IDLE?s.interimTile=u.interimTile:s.interimTile=u,s.refreshInterimChain(),this.tileCache.replace(h,s)}return s},e.prototype.setRenderReprojectionEdges=function(t){if(!(!ie||this.renderReprojectionEdges_==t)){this.renderReprojectionEdges_=t;for(var n in this.tileCacheForProjection)this.tileCacheForProjection[n].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,n){if(ie){var i=ct(t);if(i){var a=At(i);a in this.tileGridForProjection||(this.tileGridForProjection[a]=n)}}},e}(w1);function O1(r,e){r.getImage().src=e}const S1=A1;var P1=globalThis&&globalThis.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),I1=function(r){P1(e,r);function e(t){var n=this,i=t||{},a=i.imageSmoothing!==void 0?i.imageSmoothing:!0;i.interpolate!==void 0&&(a=i.interpolate);var o=i.projection!==void 0?i.projection:"EPSG:3857",s=i.tileGrid!==void 0?i.tileGrid:yh({extent:Zn(o),maxResolution:i.maxResolution,maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});return n=r.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,interpolate:a,opaque:i.opaque,projection:o,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:s,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:i.wrapX!==void 0?i.wrapX:!0,transition:i.transition,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this,n.gutter_=i.gutter!==void 0?i.gutter:0,n}return e.prototype.getGutter=function(){return this.gutter_},e}(S1);const b1=I1;Ot.defs("EPSG:2193","+proj=tmerc +lat_0=0 +lon_0=173 +k=0.9996 +x_0=1600000 +y_0=10000000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");y1(Ot);const Xi=ct("EPSG:2193"),L1=[-1e6,1e7],pl=[8960,4480,2240,1120,560,280,140,70,28,14,7,2.8,1.4,.7,.28,.14,.07],gl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],N1=["https://tile-service-raster.s3.us-east-1.amazonaws.com/cogs/as-raster-tile/HM_COG.tif","https://tile-service-raster.s3.us-east-1.amazonaws.com/cogs/as-raster-tile/HN_COG.tif"];function D1(r){var e=[];return r.forEach(t=>e.push(new Bp({sources:[{url:t,tileSize:256}],convertToRGB:!0,interpolate:!1}))),e}const G1=new gh({crossOrigin:"anonymous",sources:D1(N1)}),F1="https://tiles.maps.linz.io/nz_topo_basemap/NZTM/{z}/{x}/{y}.png",U1=new gh({crossOrigin:"anonymous",source:new b1({url:F1,projection:Xi,attributions:['<a href="http://data.linz.govt.nz">Data from LINZ. CC BY 4.0</a>'],tileGrid:new Hn({origin:L1,resolutions:pl,matrixIds:gl,extent:[827933.23,372982029e-2,319537359e-2,703994358e-2]})})});new Gv({layers:[U1,G1],target:"map",view:new ge({projection:Xi,center:Iu([176,-38.68],Xi),zoom:6,maxZoom:6,minZoom:10,resolutions:pl,matrixIds:gl,constrainResolution:!0,smoothResolutionConstraint:!0})});export{Y1 as L,W1 as a};
//# sourceMappingURL=index.21ddee10.js.map
